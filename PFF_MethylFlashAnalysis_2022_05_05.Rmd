---
title: "PFF Consent Date Ref - MethylFlash Global DNAm Analysis"
author: "Gillian Goobie"
date: "2022/05/05"
output: 
  bookdown::html_document2:
    toc: yes
    toc_float: yes
    number_sections: yes
    code_folding: hide
  html_document: 
    toc: yes
    toc_float: yes
    number_sections: yes
    code_folding: hide
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, message=FALSE, warning=FALSE, echo=F}
library(tidyverse)
library(readxl)
library(here)
library(writexl)
library(knitr)
library(lintr)
library(tidync)
library(maps)
library(ncmeta)
library(devtools)
library(RNetCDF)
library(ncdf4)
library(survival)
library(survminer)
library(lubridate)
library(cmprsk)
library(riskRegression)
library(prodlim)
library(RColorBrewer)
library(prodlim)
library(lme4)
library(performance)
library(psycho)
library(report)
library(rms)
library(splines)
library(Greg)
library(rstpm2)
library(pspline)
library(usethis)
library(betareg)
```

# Importing Datasets
## Total PM2.5 Files
Here I am importing the file which contains global DNAm estimates by ELISA-based MethylFlash that are linked to the patient ID.
```{r}
outfile1 <- here("PFF_Results/PFF_MethylFlash_ExptID_1-751_Combined_2022_05_05.xlsx")
dnam <- read_excel(outfile1, sheet="CalculatedValues")
```

Match up PM25 data with methylation data
```{r}
outfile2 <- here("PM25_Data/Final_PFF_fILD_PM_BaselineData_2022_02_12.xlsx")
PM <- read_excel(outfile2)
```

## Keep only required columns
```{r}
str(dnam)
dnam <- dnam %>% dplyr::select(SSID, sampID, exptID, run_date, plate, pct_5mC)
```


## Join Columns
```{r}
dnam <- left_join(dnam, PM, by="SSID")
```

# Add Original PM2.5 Matching Files with All Months
```{r}
outfile2b <- here("PM25_Data/PFF_fILD_2000_2018_PM25_2021_10_08.xlsx")
PM <- read_excel(outfile2b)
PM <- PM %>% rename("SSID"="ID")
```

```{r}
dnam <- inner_join(PM, dnam, by="SSID")
```

Reorder so "ID" is the first column
```{r}
dnam <- dnam %>% dplyr::select(ID, everything(.))
dnam <- dnam %>% dplyr::select(!c(PM_date, value))
```

## Pivoting to Long Format
First we need to convert the PM dataframe into the long rather than the wide format, which will allow us to use it more easily in R's tidyverse as this is "tidy" formatting.
```{r}
dnam <- dnam %>% 
  pivot_longer(cols=c(7:234), names_to="PM_date", names_prefix="PM25_")
```

## Convert date PM_date to same format as above
```{r}
dnamx <- dnam 
dnamx$PM_date <- gsub("jan", "01-01-20", dnamx$PM_date)
dnamx$PM_date <- gsub("feb", "01-02-20", dnamx$PM_date)
dnamx$PM_date <- gsub("mar", "01-03-20", dnamx$PM_date)
dnamx$PM_date <- gsub("apr", "01-04-20", dnamx$PM_date)
dnamx$PM_date <- gsub("may", "01-05-20", dnamx$PM_date)
dnamx$PM_date <- gsub("jun", "01-06-20", dnamx$PM_date)
dnamx$PM_date <- gsub("jul", "01-07-20", dnamx$PM_date)
dnamx$PM_date <- gsub("aug", "01-08-20", dnamx$PM_date)
dnamx$PM_date <- gsub("sep", "01-09-20", dnamx$PM_date)
dnamx$PM_date <- gsub("oct", "01-10-20", dnamx$PM_date)
dnamx$PM_date <- gsub("nov", "01-11-20", dnamx$PM_date)
dnamx$PM_date <- gsub("dec", "01-12-20", dnamx$PM_date)

dnamx$PM_date <- format(as.Date(dnamx$PM_date, format="%d-%m-%Y"),"%Y-%m-%d")
dnamx$PM_date <- as.Date(dnamx$PM_date)
dnam <- dnamx
```


## Convert Date Columns to Date Format
Next I need to convert all date columns to proper format
```{r}
dnam <- dnam %>% 
  mutate_at(c("run_date", "dx_date", "consent_date", "death_date", "tx_date", "sample_date", "fvc_date", "dlco_date", "censor_date", "deathORtx_date", "DeathTxCensor_date", "PM_date"), as.Date)
str(dnam)
```

## Remove unnecessary columns
```{r}
dnam <- dnam %>% dplyr::select(!c("nrow.x", "dist.x", "lon", "lat", "lat.x", "lon.x", "nrow.y", "dist.y", "lon.y", "lat.y"))
```


## Creating PM2.5 Exposure Variables
Now I'm creating new variables where I am matching up PM averages per year to years of major events for patients (year of diagnosis, year of death/lung transplant/censoring, etc)

### 5yrs Pre-Sampling
Here I am calculating the average PM value in the 5yrs prior to sampling.
```{r}
dnam <- dnam %>% 
  group_by(ID) %>% 
  mutate(PM_5yrPreSamp = mean(value[ymd(PM_date)>=(ymd(sample_date) - years(5)) & 
                                        ymd(PM_date)<=ymd(sample_date)]))
```

### 1yr Pre-Sampling
Here I am calculating the average PM value in the 1yr prior to sampling.
```{r}
dnam <- dnam %>% 
  group_by(ID) %>% 
  mutate(PM_1yrPreSamp = mean(value[ymd(PM_date)>=(ymd(sample_date) - years(1)) & 
                                        ymd(PM_date)<=ymd(sample_date)]))
```

### 6mo Pre-Sampling
Here I am calculating the average PM value in the 6mo prior to sampling.
```{r}
dnam <- dnam %>% 
  group_by(ID) %>% 
  mutate(PM_6moPreSamp = mean(value[ymd(PM_date)>=(ymd(sample_date) - months(6)) & 
                                        ymd(PM_date)<=ymd(sample_date)]))
```

### 3mo Pre-Sampling
Here I am calculating the average PM value in the 3mo prior to sampling.
```{r}
dnam <- dnam %>% 
  group_by(ID) %>% 
  mutate(PM_3moPreSamp = mean(value[ymd(PM_date)>=(ymd(sample_date) - months(3)) & 
                                        ymd(PM_date)<=ymd(sample_date)]))
```

### 1mo Pre-Sampling
Here I am calculating the average PM value in the 1mo prior to sampling.
```{r}
dnam <- dnam %>% 
  group_by(ID) %>% 
  mutate(PM_1moPreSamp = mean(value[ymd(PM_date)>=(ymd(sample_date) - months(2)) & 
                                        ymd(PM_date)<=ymd(sample_date)]))
```
Of note, the 1mo pre-sampling with this method actually provides the average PM2.5 value for the month of sampling and the 1mo prior to sampling because the sampling could have occurred at the beginning or end of a month.

### Remove Dataframes not in use
```{r}
rm(list=c("dnamx"))
```

### Getting Rid of Duplicated IDs
Now that we have calculated the patient-specific PM exposures, I can get rid of all rows other than the first row for each patient.
```{r}
dnam <-  dnam %>% 
  distinct_at(vars(ID), .keep_all=T)
```
This takes us down to 734 observations.

### Get rid of non-specific "value" column
```{r}
dnam <- dnam %>% dplyr::select(!value)
```


### Remove UPitt patients
```{r}
dnam <- dnam %>% filter(!str_detect(SSID, "^08R"))
```
This takes us down to 733 observations after we remove UPitt patients which may be doubled up in our Simmons analyses.

# Add PM2.5 Constituent Files
## SO4 add Original SO4 Matching Files with All Months
```{r}
outfile3 <- here("PM25_Data/PFF_fILD_2000_2017_SO4_2021_11_05.xlsx")
SO4 <- read_excel(outfile3)
```

```{r}
dnam <- inner_join(SO4, dnam, by="ID")
```

Reorder so "ID" is the first column
```{r}
dnam <- dnam %>% dplyr::select(ID, everything(.))
```

### Pivoting to Long Format
First we need to convert the PM dataframe into the long rather than the wide format, which will allow us to use it more easily in R's tidyverse as this is "tidy" formatting.
```{r}
dnam <- dnam %>% 
  pivot_longer(cols=c(6:221), names_to="SO4_date", names_prefix="SO4_", names_repair = "minimal")
```

### Convert date PM_date to same format as above
```{r}
dnamx <- dnam 
dnamx$SO4_date <- gsub("jan", "01-01-20", dnamx$SO4_date)
dnamx$SO4_date <- gsub("feb", "01-02-20", dnamx$SO4_date)
dnamx$SO4_date <- gsub("mar", "01-03-20", dnamx$SO4_date)
dnamx$SO4_date <- gsub("apr", "01-04-20", dnamx$SO4_date)
dnamx$SO4_date <- gsub("may", "01-05-20", dnamx$SO4_date)
dnamx$SO4_date <- gsub("jun", "01-06-20", dnamx$SO4_date)
dnamx$SO4_date <- gsub("jul", "01-07-20", dnamx$SO4_date)
dnamx$SO4_date <- gsub("aug", "01-08-20", dnamx$SO4_date)
dnamx$SO4_date <- gsub("sep", "01-09-20", dnamx$SO4_date)
dnamx$SO4_date <- gsub("oct", "01-10-20", dnamx$SO4_date)
dnamx$SO4_date <- gsub("nov", "01-11-20", dnamx$SO4_date)
dnamx$SO4_date <- gsub("dec", "01-12-20", dnamx$SO4_date)

dnamx$SO4_date <- format(as.Date(dnamx$SO4_date, format="%d-%m-%Y"),"%Y-%m-%d")
dnamx$SO4_date <- as.Date(dnamx$SO4_date)
dnam <- dnamx
```


# Convert Date Columns to Date Format
Next I need to convert all date columns to proper format
```{r}
dnam <- dnam %>% 
  mutate_at(c("SO4_date"), as.Date)
str(dnam)
```

## Creating SO4 Exposure Variables
Now I'm creating new variables where I am matching up PM averages per year to years of major events for patients (year of diagnosis, year of death/lung transplant/censoring, etc)

### 5yrs Pre-Sampling
Here I am calculating the average SO4 value in the 5yrs prior to sampling.
```{r}
dnam <- dnam %>% 
  group_by(ID) %>% 
  mutate(SO4_5yrPreSamp = mean(value[ymd(SO4_date)>=(ymd(sample_date) - years(5)) & 
                                        ymd(SO4_date)<=ymd(sample_date)]))
```

### 1yr Pre-Sampling
Here I am calculating the average SO4 value in the 1yr prior to sampling.
```{r}
dnam <- dnam %>% 
  group_by(ID) %>% 
  mutate(SO4_1yrPreSamp = mean(value[ymd(SO4_date)>=(ymd(sample_date) - years(1)) & 
                                        ymd(SO4_date)<=ymd(sample_date)]))
```

### 6mo Pre-Sampling
Here I am calculating the average SO4 value in the 6mo prior to sampling.
```{r}
dnam <- dnam %>% 
  group_by(ID) %>% 
  mutate(SO4_6moPreSamp = mean(value[ymd(SO4_date)>=(ymd(sample_date) - months(6)) & 
                                        ymd(SO4_date)<=ymd(sample_date)]))
```

### 3mo Pre-Sampling
Here I am calculating the average SO4 value in the 3mo prior to sampling.
```{r}
dnam <- dnam %>% 
  group_by(ID) %>% 
  mutate(SO4_3moPreSamp = mean(value[ymd(SO4_date)>=(ymd(sample_date) - months(3)) & 
                                        ymd(SO4_date)<=ymd(sample_date)]))
```

### 1mo Pre-Sampling
Here I am calculating the average SO4 value in the 1mo prior to sampling.
```{r}
dnam <- dnam %>% 
  group_by(ID) %>% 
  mutate(SO4_1moPreSamp = mean(value[ymd(SO4_date)>=(ymd(sample_date) - months(2)) & 
                                        ymd(SO4_date)<=ymd(sample_date)]))
```
Of note, the 1mo pre-sampling with this method actually provides the average PM2.5 value for the month of sampling and the 1mo prior to sampling because the sampling could have occurred at the beginning or end of a month.

### Remove Dataframes and variables not in use
```{r}
rm(list=c("dnamx", "PM", "SO4"))
```

### Getting Rid of Duplicated IDs
Now that we have calculated the patient-specific PM exposures, I can get rid of all rows other than the first row for each patient.
```{r}
dnam <-  dnam %>% 
  distinct_at(vars(ID), .keep_all=T)
```
This takes us down to 733 observations.

### Getting rid of unnecessary columns
```{r}
dnam <- dnam %>% dplyr::select(!c(nrow, dist, lon, lat, SO4_date, value))
```


## NO3 add Original NO3 Matching Files with All Months
```{r}
outfile3 <- here("PM25_Data/PFF_fILD_2000_2017_NO3_2021_11_05.xlsx")
NO3 <- read_excel(outfile3)
```

```{r}
dnam <- inner_join(NO3, dnam, by="ID")
```

Reorder so "ID" is the first column
```{r}
dnam <- dnam %>% dplyr::select(ID, everything(.))
```

### Pivoting to Long Format
First we need to convert the PM dataframe into the long rather than the wide format, which will allow us to use it more easily in R's tidyverse as this is "tidy" formatting.
```{r}
dnam <- dnam %>% 
  pivot_longer(cols=c(6:221), names_to="NO3_date", names_prefix="NIT_", names_repair = "minimal")
```

### Convert date PM_date to same format as above
```{r}
dnamx <- dnam 
dnamx$NO3_date <- gsub("jan", "01-01-20", dnamx$NO3_date)
dnamx$NO3_date <- gsub("feb", "01-02-20", dnamx$NO3_date)
dnamx$NO3_date <- gsub("mar", "01-03-20", dnamx$NO3_date)
dnamx$NO3_date <- gsub("apr", "01-04-20", dnamx$NO3_date)
dnamx$NO3_date <- gsub("may", "01-05-20", dnamx$NO3_date)
dnamx$NO3_date <- gsub("jun", "01-06-20", dnamx$NO3_date)
dnamx$NO3_date <- gsub("jul", "01-07-20", dnamx$NO3_date)
dnamx$NO3_date <- gsub("aug", "01-08-20", dnamx$NO3_date)
dnamx$NO3_date <- gsub("sep", "01-09-20", dnamx$NO3_date)
dnamx$NO3_date <- gsub("oct", "01-10-20", dnamx$NO3_date)
dnamx$NO3_date <- gsub("nov", "01-11-20", dnamx$NO3_date)
dnamx$NO3_date <- gsub("dec", "01-12-20", dnamx$NO3_date)

dnamx$NO3_date <- format(as.Date(dnamx$NO3_date, format="%d-%m-%Y"),"%Y-%m-%d")
dnamx$NO3_date <- as.Date(dnamx$NO3_date)
dnam <- dnamx
```


# Convert Date Columns to Date Format
Next I need to convert all date columns to proper format
```{r}
dnam <- dnam %>% 
  mutate_at(c("NO3_date"), as.Date)
str(dnam)
```

## Creating NO3 Exposure Variables
Now I'm creating new variables where I am matching up PM averages per year to years of major events for patients (year of diagnosis, year of death/lung transplant/censoring, etc)

### 5yrs Pre-Sampling
Here I am calculating the average NO3 value in the 5yrs prior to sampling.
```{r}
dnam <- dnam %>% 
  group_by(ID) %>% 
  mutate(NO3_5yrPreSamp = mean(value[ymd(NO3_date)>=(ymd(sample_date) - years(5)) & 
                                        ymd(NO3_date)<=ymd(sample_date)]))
```

### 1yr Pre-Sampling
Here I am calculating the average NO3 value in the 1yr prior to sampling.
```{r}
dnam <- dnam %>% 
  group_by(ID) %>% 
  mutate(NO3_1yrPreSamp = mean(value[ymd(NO3_date)>=(ymd(sample_date) - years(1)) & 
                                        ymd(NO3_date)<=ymd(sample_date)]))
```

### 6mo Pre-Sampling
Here I am calculating the average NO3 value in the 6mo prior to sampling.
```{r}
dnam <- dnam %>% 
  group_by(ID) %>% 
  mutate(NO3_6moPreSamp = mean(value[ymd(NO3_date)>=(ymd(sample_date) - months(6)) & 
                                        ymd(NO3_date)<=ymd(sample_date)]))
```

### 3mo Pre-Sampling
Here I am calculating the average NO3 value in the 3mo prior to sampling.
```{r}
dnam <- dnam %>% 
  group_by(ID) %>% 
  mutate(NO3_3moPreSamp = mean(value[ymd(NO3_date)>=(ymd(sample_date) - months(3)) & 
                                        ymd(NO3_date)<=ymd(sample_date)]))
```

### 1mo Pre-Sampling
Here I am calculating the average NO3 value in the 1mo prior to sampling.
```{r}
dnam <- dnam %>% 
  group_by(ID) %>% 
  mutate(NO3_1moPreSamp = mean(value[ymd(NO3_date)>=(ymd(sample_date) - months(2)) & 
                                        ymd(NO3_date)<=ymd(sample_date)]))
```
Of note, the 1mo pre-sampling with this method actually provides the average PM2.5 value for the month of sampling and the 1mo prior to sampling because the sampling could have occurred at the beginning or end of a month.

### Remove Dataframes and variables not in use
```{r}
rm(list=c("dnamx", "NO3"))
dnam <- dnam %>% dplyr::select(!c(nrow, dist, lon, lat, value, NO3_date))
```

### Getting Rid of Duplicated IDs
Now that we have calculated the patient-specific PM exposures, I can get rid of all rows other than the first row for each patient.
```{r}
dnam <-  dnam %>% 
  distinct_at(vars(ID), .keep_all=T)
```
This takes us down to 733 observations.


## NH4 add Original NH4 Matching Files with All Months
```{r}
outfile3 <- here("PM25_Data/PFF_fILD_2000_2017_NH4_2021_11_05.xlsx")
NH4 <- read_excel(outfile3)
```

```{r}
dnam <- inner_join(NH4, dnam, by="ID")
```

Reorder so "ID" is the first column
```{r}
dnam <- dnam %>% dplyr::select(ID, everything(.))
```

### Pivoting to Long Format
First we need to convert the PM dataframe into the long rather than the wide format, which will allow us to use it more easily in R's tidyverse as this is "tidy" formatting.
```{r}
dnam <- dnam %>% 
  pivot_longer(cols=c(6:221), names_to="NH4_date", names_prefix="NH4_", names_repair = "minimal")
```

### Convert date PM_date to same format as above
```{r}
dnamx <- dnam 
dnamx$NH4_date <- gsub("jan", "01-01-20", dnamx$NH4_date)
dnamx$NH4_date <- gsub("feb", "01-02-20", dnamx$NH4_date)
dnamx$NH4_date <- gsub("mar", "01-03-20", dnamx$NH4_date)
dnamx$NH4_date <- gsub("apr", "01-04-20", dnamx$NH4_date)
dnamx$NH4_date <- gsub("may", "01-05-20", dnamx$NH4_date)
dnamx$NH4_date <- gsub("jun", "01-06-20", dnamx$NH4_date)
dnamx$NH4_date <- gsub("jul", "01-07-20", dnamx$NH4_date)
dnamx$NH4_date <- gsub("aug", "01-08-20", dnamx$NH4_date)
dnamx$NH4_date <- gsub("sep", "01-09-20", dnamx$NH4_date)
dnamx$NH4_date <- gsub("oct", "01-10-20", dnamx$NH4_date)
dnamx$NH4_date <- gsub("nov", "01-11-20", dnamx$NH4_date)
dnamx$NH4_date <- gsub("dec", "01-12-20", dnamx$NH4_date)

dnamx$NH4_date <- format(as.Date(dnamx$NH4_date, format="%d-%m-%Y"),"%Y-%m-%d")
dnamx$NH4_date <- as.Date(dnamx$NH4_date)
dnam <- dnamx
```


# Convert Date Columns to Date Format
Next I need to convert all date columns to proper format
```{r}
dnam <- dnam %>% 
  mutate_at(c("NH4_date"), as.Date)
str(dnam)
```

## Creating NH4 Exposure Variables
Now I'm creating new variables where I am matching up PM averages per year to years of major events for patients (year of diagnosis, year of death/lung transplant/censoring, etc)

### 5yrs Pre-Sampling
Here I am calculating the average NH4 value in the 5yrs prior to sampling.
```{r}
dnam <- dnam %>% 
  group_by(ID) %>% 
  mutate(NH4_5yrPreSamp = mean(value[ymd(NH4_date)>=(ymd(sample_date) - years(5)) & 
                                        ymd(NH4_date)<=ymd(sample_date)]))
```

### 1yr Pre-Sampling
Here I am calculating the average NH4 value in the 1yr prior to sampling.
```{r}
dnam <- dnam %>% 
  group_by(ID) %>% 
  mutate(NH4_1yrPreSamp = mean(value[ymd(NH4_date)>=(ymd(sample_date) - years(1)) & 
                                        ymd(NH4_date)<=ymd(sample_date)]))
```

### 6mo Pre-Sampling
Here I am calculating the average NH4 value in the 6mo prior to sampling.
```{r}
dnam <- dnam %>% 
  group_by(ID) %>% 
  mutate(NH4_6moPreSamp = mean(value[ymd(NH4_date)>=(ymd(sample_date) - months(6)) & 
                                        ymd(NH4_date)<=ymd(sample_date)]))
```

### 3mo Pre-Sampling
Here I am calculating the average NH4 value in the 3mo prior to sampling.
```{r}
dnam <- dnam %>% 
  group_by(ID) %>% 
  mutate(NH4_3moPreSamp = mean(value[ymd(NH4_date)>=(ymd(sample_date) - months(3)) & 
                                        ymd(NH4_date)<=ymd(sample_date)]))
```

### 1mo Pre-Sampling
Here I am calculating the average NH4 value in the 1mo prior to sampling.
```{r}
dnam <- dnam %>% 
  group_by(ID) %>% 
  mutate(NH4_1moPreSamp = mean(value[ymd(NH4_date)>=(ymd(sample_date) - months(2)) & 
                                        ymd(NH4_date)<=ymd(sample_date)]))
```
Of note, the 1mo pre-sampling with this method actually provides the average PM2.5 value for the month of sampling and the 1mo prior to sampling because the sampling could have occurred at the beginning or end of a month.

### Remove Dataframes and variables not in use
```{r}
rm(list=c("dnamx", "NH4"))
dnam <- dnam %>% dplyr::select(!c(nrow, dist, lon, lat, value, NH4_date))
```

### Getting Rid of Duplicated IDs
Now that we have calculated the patient-specific PM exposures, I can get rid of all rows other than the first row for each patient.
```{r}
dnam <-  dnam %>% 
  distinct_at(vars(ID), .keep_all=T)
```
This takes us down to 733 observations.

## BC add Original BC Matching Files with All Months
```{r}
outfile3 <- here("PM25_Data/PFF_fILD_2000_2017_BC_2021_11_05.xlsx")
BC <- read_excel(outfile3)
```

```{r}
dnam <- inner_join(BC, dnam, by="ID")
```

Reorder so "ID" is the first column
```{r}
dnam <- dnam %>% dplyr::select(ID, everything(.))
```

### Pivoting to Long Format
First we need to convert the PM dataframe into the long rather than the wide format, which will allow us to use it more easily in R's tidyverse as this is "tidy" formatting.
```{r}
dnam <- dnam %>% 
  pivot_longer(cols=c(6:221), names_to="BC_date", names_prefix="BC_", names_repair = "minimal")
```

### Convert date PM_date to same format as above
```{r}
dnamx <- dnam 
dnamx$BC_date <- gsub("jan", "01-01-20", dnamx$BC_date)
dnamx$BC_date <- gsub("feb", "01-02-20", dnamx$BC_date)
dnamx$BC_date <- gsub("mar", "01-03-20", dnamx$BC_date)
dnamx$BC_date <- gsub("apr", "01-04-20", dnamx$BC_date)
dnamx$BC_date <- gsub("may", "01-05-20", dnamx$BC_date)
dnamx$BC_date <- gsub("jun", "01-06-20", dnamx$BC_date)
dnamx$BC_date <- gsub("jul", "01-07-20", dnamx$BC_date)
dnamx$BC_date <- gsub("aug", "01-08-20", dnamx$BC_date)
dnamx$BC_date <- gsub("sep", "01-09-20", dnamx$BC_date)
dnamx$BC_date <- gsub("oct", "01-10-20", dnamx$BC_date)
dnamx$BC_date <- gsub("nov", "01-11-20", dnamx$BC_date)
dnamx$BC_date <- gsub("dec", "01-12-20", dnamx$BC_date)

dnamx$BC_date <- format(as.Date(dnamx$BC_date, format="%d-%m-%Y"),"%Y-%m-%d")
dnamx$BC_date <- as.Date(dnamx$BC_date)
dnam <- dnamx
```


# Convert Date Columns to Date Format
Next I need to convert all date columns to proper format
```{r}
dnam <- dnam %>% 
  mutate_at(c("BC_date"), as.Date)
str(dnam)
```

## Creating BC Exposure Variables
Now I'm creating new variables where I am matching up PM averages per year to years of major events for patients (year of diagnosis, year of death/lung transplant/censoring, etc)

### 5yrs Pre-Sampling
Here I am calculating the average BC value in the 5yrs prior to sampling.
```{r}
dnam <- dnam %>% 
  group_by(ID) %>% 
  mutate(BC_5yrPreSamp = mean(value[ymd(BC_date)>=(ymd(sample_date) - years(5)) & 
                                        ymd(BC_date)<=ymd(sample_date)]))
```

### 1yr Pre-Sampling
Here I am calculating the average BC value in the 1yr prior to sampling.
```{r}
dnam <- dnam %>% 
  group_by(ID) %>% 
  mutate(BC_1yrPreSamp = mean(value[ymd(BC_date)>=(ymd(sample_date) - years(1)) & 
                                        ymd(BC_date)<=ymd(sample_date)]))
```

### 6mo Pre-Sampling
Here I am calculating the average BC value in the 6mo prior to sampling.
```{r}
dnam <- dnam %>% 
  group_by(ID) %>% 
  mutate(BC_6moPreSamp = mean(value[ymd(BC_date)>=(ymd(sample_date) - months(6)) & 
                                        ymd(BC_date)<=ymd(sample_date)]))
```

### 3mo Pre-Sampling
Here I am calculating the average BC value in the 3mo prior to sampling.
```{r}
dnam <- dnam %>% 
  group_by(ID) %>% 
  mutate(BC_3moPreSamp = mean(value[ymd(BC_date)>=(ymd(sample_date) - months(3)) & 
                                        ymd(BC_date)<=ymd(sample_date)]))
```

### 1mo Pre-Sampling
Here I am calculating the average BC value in the 1mo prior to sampling.
```{r}
dnam <- dnam %>% 
  group_by(ID) %>% 
  mutate(BC_1moPreSamp = mean(value[ymd(BC_date)>=(ymd(sample_date) - months(2)) & 
                                        ymd(BC_date)<=ymd(sample_date)]))
```
Of note, the 1mo pre-sampling with this method actually provides the average PM2.5 value for the month of sampling and the 1mo prior to sampling because the sampling could have occurred at the beginning or end of a month.

### Remove Dataframes and variables not in use
```{r}
rm(list=c("dnamx", "BC"))
dnam <- dnam %>% dplyr::select(!c(nrow, dist, lon, lat, value, BC_date))
```

### Getting Rid of Duplicated IDs
Now that we have calculated the patient-specific PM exposures, I can get rid of all rows other than the first row for each patient.
```{r}
dnam <-  dnam %>% 
  distinct_at(vars(ID), .keep_all=T)
```
This takes us down to 733 observations.


## OM add Original OM Matching Files with All Months
```{r}
outfile3 <- here("PM25_Data/PFF_fILD_2000_2017_OM_2021_11_05.xlsx")
OM <- read_excel(outfile3)
```

```{r}
dnam <- inner_join(OM, dnam, by="ID")
```

Reorder so "ID" is the first column
```{r}
dnam <- dnam %>% dplyr::select(ID, everything(.))
```

### Pivoting to Long Format
First we need to convert the PM dataframe into the long rather than the wide format, which will allow us to use it more easily in R's tidyverse as this is "tidy" formatting.
```{r}
dnam <- dnam %>% 
  pivot_longer(cols=c(6:221), names_to="OM_date", names_prefix="OM_", names_repair = "minimal")
```

### Convert date PM_date to same format as above
```{r}
dnamx <- dnam 
dnamx$OM_date <- gsub("jan", "01-01-20", dnamx$OM_date)
dnamx$OM_date <- gsub("feb", "01-02-20", dnamx$OM_date)
dnamx$OM_date <- gsub("mar", "01-03-20", dnamx$OM_date)
dnamx$OM_date <- gsub("apr", "01-04-20", dnamx$OM_date)
dnamx$OM_date <- gsub("may", "01-05-20", dnamx$OM_date)
dnamx$OM_date <- gsub("jun", "01-06-20", dnamx$OM_date)
dnamx$OM_date <- gsub("jul", "01-07-20", dnamx$OM_date)
dnamx$OM_date <- gsub("aug", "01-08-20", dnamx$OM_date)
dnamx$OM_date <- gsub("sep", "01-09-20", dnamx$OM_date)
dnamx$OM_date <- gsub("oct", "01-10-20", dnamx$OM_date)
dnamx$OM_date <- gsub("nov", "01-11-20", dnamx$OM_date)
dnamx$OM_date <- gsub("dec", "01-12-20", dnamx$OM_date)

dnamx$OM_date <- format(as.Date(dnamx$OM_date, format="%d-%m-%Y"),"%Y-%m-%d")
dnamx$OM_date <- as.Date(dnamx$OM_date)
dnam <- dnamx
```


# Convert Date Columns to Date Format
Next I need to convert all date columns to proper format
```{r}
dnam <- dnam %>% 
  mutate_at(c("OM_date"), as.Date)
str(dnam)
```

## Creating OM Exposure Variables
Now I'm creating new variables where I am matching up PM averages per year to years of major events for patients (year of diagnosis, year of death/lung transplant/censoring, etc)

### 5yrs Pre-Sampling
Here I am calculating the average OM value in the 5yrs prior to sampling.
```{r}
dnam <- dnam %>% 
  group_by(ID) %>% 
  mutate(OM_5yrPreSamp = mean(value[ymd(OM_date)>=(ymd(sample_date) - years(5)) & 
                                        ymd(OM_date)<=ymd(sample_date)]))
```

### 1yr Pre-Sampling
Here I am calculating the average OM value in the 1yr prior to sampling.
```{r}
dnam <- dnam %>% 
  group_by(ID) %>% 
  mutate(OM_1yrPreSamp = mean(value[ymd(OM_date)>=(ymd(sample_date) - years(1)) & 
                                        ymd(OM_date)<=ymd(sample_date)]))
```

### 6mo Pre-Sampling
Here I am calculating the average OM value in the 6mo prior to sampling.
```{r}
dnam <- dnam %>% 
  group_by(ID) %>% 
  mutate(OM_6moPreSamp = mean(value[ymd(OM_date)>=(ymd(sample_date) - months(6)) & 
                                        ymd(OM_date)<=ymd(sample_date)]))
```

### 3mo Pre-Sampling
Here I am calculating the average OM value in the 3mo prior to sampling.
```{r}
dnam <- dnam %>% 
  group_by(ID) %>% 
  mutate(OM_3moPreSamp = mean(value[ymd(OM_date)>=(ymd(sample_date) - months(3)) & 
                                        ymd(OM_date)<=ymd(sample_date)]))
```

### 1mo Pre-Sampling
Here I am calculating the average OM value in the 1mo prior to sampling.
```{r}
dnam <- dnam %>% 
  group_by(ID) %>% 
  mutate(OM_1moPreSamp = mean(value[ymd(OM_date)>=(ymd(sample_date) - months(2)) & 
                                        ymd(OM_date)<=ymd(sample_date)]))
```
Of note, the 1mo pre-sampling with this method actually provides the average PM2.5 value for the month of sampling and the 1mo prior to sampling because the sampling could have occurred at the beginning or end of a month.

### Remove Dataframes and variables not in use
```{r}
rm(list=c("dnamx", "OM"))
dnam <- dnam %>% dplyr::select(!c(nrow, dist, lon, lat, value, OM_date))
```

### Getting Rid of Duplicated IDs
Now that we have calculated the patient-specific PM exposures, I can get rid of all rows other than the first row for each patient.
```{r}
dnam <-  dnam %>% 
  distinct_at(vars(ID), .keep_all=T)
```
This takes us down to 733 observations.


## SS add Original SS Matching Files with All Months
```{r}
outfile3 <- here("PM25_Data/PFF_fILD_2000_2017_SS_2021_11_05.xlsx")
SS <- read_excel(outfile3)
```

```{r}
dnam <- inner_join(SS, dnam, by="ID")
```

Reorder so "ID" is the first column
```{r}
dnam <- dnam %>% dplyr::select(ID, everything(.))
```

### Pivoting to Long Format
First we need to convert the PM dataframe into the long rather than the wide format, which will allow us to use it more easily in R's tidyverse as this is "tidy" formatting.
```{r}
dnam <- dnam %>% 
  pivot_longer(cols=c(6:221), names_to="SS_date", names_prefix="SS_", names_repair = "minimal")
```

### Convert date PM_date to same format as above
```{r}
dnamx <- dnam 
dnamx$SS_date <- gsub("jan", "01-01-20", dnamx$SS_date)
dnamx$SS_date <- gsub("feb", "01-02-20", dnamx$SS_date)
dnamx$SS_date <- gsub("mar", "01-03-20", dnamx$SS_date)
dnamx$SS_date <- gsub("apr", "01-04-20", dnamx$SS_date)
dnamx$SS_date <- gsub("may", "01-05-20", dnamx$SS_date)
dnamx$SS_date <- gsub("jun", "01-06-20", dnamx$SS_date)
dnamx$SS_date <- gsub("jul", "01-07-20", dnamx$SS_date)
dnamx$SS_date <- gsub("aug", "01-08-20", dnamx$SS_date)
dnamx$SS_date <- gsub("sep", "01-09-20", dnamx$SS_date)
dnamx$SS_date <- gsub("oct", "01-10-20", dnamx$SS_date)
dnamx$SS_date <- gsub("nov", "01-11-20", dnamx$SS_date)
dnamx$SS_date <- gsub("dec", "01-12-20", dnamx$SS_date)

dnamx$SS_date <- format(as.Date(dnamx$SS_date, format="%d-%m-%Y"),"%Y-%m-%d")
dnamx$SS_date <- as.Date(dnamx$SS_date)
dnam <- dnamx
```


# Convert Date Columns to Date Format
Next I need to convert all date columns to proper format
```{r}
dnam <- dnam %>% 
  mutate_at(c("SS_date"), as.Date)
str(dnam)
```

## Creating SS Exposure Variables
Now I'm creating new variables where I am matching up PM averages per year to years of major events for patients (year of diagnosis, year of death/lung transplant/censoring, etc)

### 5yrs Pre-Sampling
Here I am calculating the average SS value in the 5yrs prior to sampling.
```{r}
dnam <- dnam %>% 
  group_by(ID) %>% 
  mutate(SS_5yrPreSamp = mean(value[ymd(SS_date)>=(ymd(sample_date) - years(5)) & 
                                        ymd(SS_date)<=ymd(sample_date)]))
```

### 1yr Pre-Sampling
Here I am calculating the average SS value in the 1yr prior to sampling.
```{r}
dnam <- dnam %>% 
  group_by(ID) %>% 
  mutate(SS_1yrPreSamp = mean(value[ymd(SS_date)>=(ymd(sample_date) - years(1)) & 
                                        ymd(SS_date)<=ymd(sample_date)]))
```

### 6mo Pre-Sampling
Here I am calculating the average SS value in the 6mo prior to sampling.
```{r}
dnam <- dnam %>% 
  group_by(ID) %>% 
  mutate(SS_6moPreSamp = mean(value[ymd(SS_date)>=(ymd(sample_date) - months(6)) & 
                                        ymd(SS_date)<=ymd(sample_date)]))
```

### 3mo Pre-Sampling
Here I am calculating the average SS value in the 3mo prior to sampling.
```{r}
dnam <- dnam %>% 
  group_by(ID) %>% 
  mutate(SS_3moPreSamp = mean(value[ymd(SS_date)>=(ymd(sample_date) - months(3)) & 
                                        ymd(SS_date)<=ymd(sample_date)]))
```

### 1mo Pre-Sampling
Here I am calculating the average SS value in the 1mo prior to sampling.
```{r}
dnam <- dnam %>% 
  group_by(ID) %>% 
  mutate(SS_1moPreSamp = mean(value[ymd(SS_date)>=(ymd(sample_date) - months(2)) & 
                                        ymd(SS_date)<=ymd(sample_date)]))
```
Of note, the 1mo pre-sampling with this method actually provides the average PM2.5 value for the month of sampling and the 1mo prior to sampling because the sampling could have occurred at the beginning or end of a month.

### Remove Dataframes and variables not in use
```{r}
rm(list=c("dnamx", "SS"))
dnam <- dnam %>% dplyr::select(!c(nrow, dist, lon, lat, value, SS_date))
```

### Getting Rid of Duplicated IDs
Now that we have calculated the patient-specific PM exposures, I can get rid of all rows other than the first row for each patient.
```{r}
dnam <-  dnam %>% 
  distinct_at(vars(ID), .keep_all=T)
```
This takes us down to 733 observations.


## Soil add Original Soil Matching Files with All Months
```{r}
outfile3 <- here("PM25_Data/PFF_fILD_2000_2017_soil_2021_11_05.xlsx")
Soil <- read_excel(outfile3)
```

```{r}
dnam <- inner_join(Soil, dnam, by="ID")
```

Reorder so "ID" is the first column
```{r}
dnam <- dnam %>% dplyr::select(ID, everything(.))
```

### Pivoting to Long Format
First we need to convert the PM dataframe into the long rather than the wide format, which will allow us to use it more easily in R's tidyverse as this is "tidy" formatting.
```{r}
dnam <- dnam %>% 
  pivot_longer(cols=c(6:221), names_to="Soil_date", names_prefix="soil_", names_repair = "minimal")
```

### Convert date PM_date to same format as above
```{r}
dnamx <- dnam 
dnamx$Soil_date <- gsub("jan", "01-01-20", dnamx$Soil_date)
dnamx$Soil_date <- gsub("feb", "01-02-20", dnamx$Soil_date)
dnamx$Soil_date <- gsub("mar", "01-03-20", dnamx$Soil_date)
dnamx$Soil_date <- gsub("apr", "01-04-20", dnamx$Soil_date)
dnamx$Soil_date <- gsub("may", "01-05-20", dnamx$Soil_date)
dnamx$Soil_date <- gsub("jun", "01-06-20", dnamx$Soil_date)
dnamx$Soil_date <- gsub("jul", "01-07-20", dnamx$Soil_date)
dnamx$Soil_date <- gsub("aug", "01-08-20", dnamx$Soil_date)
dnamx$Soil_date <- gsub("sep", "01-09-20", dnamx$Soil_date)
dnamx$Soil_date <- gsub("oct", "01-10-20", dnamx$Soil_date)
dnamx$Soil_date <- gsub("nov", "01-11-20", dnamx$Soil_date)
dnamx$Soil_date <- gsub("dec", "01-12-20", dnamx$Soil_date)

dnamx$Soil_date <- format(as.Date(dnamx$Soil_date, format="%d-%m-%Y"),"%Y-%m-%d")
dnamx$Soil_date <- as.Date(dnamx$Soil_date)
dnam <- dnamx
```


# Convert Date Columns to Date Format
Next I need to convert all date columns to proper format
```{r}
dnam <- dnam %>% 
  mutate_at(c("Soil_date"), as.Date)
str(dnam)
```

## Creating Soil Exposure Variables
Now I'm creating new variables where I am matching up PM averages per year to years of major events for patients (year of diagnosis, year of death/lung transplant/censoring, etc)

### 5yrs Pre-Sampling
Here I am calculating the average Soil value in the 5yrs prior to sampling.
```{r}
dnam <- dnam %>% 
  group_by(ID) %>% 
  mutate(Soil_5yrPreSamp = mean(value[ymd(Soil_date)>=(ymd(sample_date) - years(5)) & 
                                        ymd(Soil_date)<=ymd(sample_date)]))
```

### 1yr Pre-Sampling
Here I am calculating the average Soil value in the 1yr prior to sampling.
```{r}
dnam <- dnam %>% 
  group_by(ID) %>% 
  mutate(Soil_1yrPreSamp = mean(value[ymd(Soil_date)>=(ymd(sample_date) - years(1)) & 
                                        ymd(Soil_date)<=ymd(sample_date)]))
```

### 6mo Pre-Sampling
Here I am calculating the average Soil value in the 6mo prior to sampling.
```{r}
dnam <- dnam %>% 
  group_by(ID) %>% 
  mutate(Soil_6moPreSamp = mean(value[ymd(Soil_date)>=(ymd(sample_date) - months(6)) & 
                                        ymd(Soil_date)<=ymd(sample_date)]))
```

### 3mo Pre-Sampling
Here I am calculating the average Soil value in the 3mo prior to sampling.
```{r}
dnam <- dnam %>% 
  group_by(ID) %>% 
  mutate(Soil_3moPreSamp = mean(value[ymd(Soil_date)>=(ymd(sample_date) - months(3)) & 
                                        ymd(Soil_date)<=ymd(sample_date)]))
```

### 1mo Pre-Sampling
Here I am calculating the average Soil value in the 1mo prior to sampling.
```{r}
dnam <- dnam %>% 
  group_by(ID) %>% 
  mutate(Soil_1moPreSamp = mean(value[ymd(Soil_date)>=(ymd(sample_date) - months(2)) & 
                                        ymd(Soil_date)<=ymd(sample_date)]))
```
Of note, the 1mo pre-sampling with this method actually provides the average PM2.5 value for the month of sampling and the 1mo prior to sampling because the sampling could have occurred at the beginning or end of a month.

### Remove Dataframes and variables not in use
```{r}
rm(list=c("dnamx", "Soil"))
dnam <- dnam %>% dplyr::select(!c(nrow, dist, lon, lat, value, Soil_date))
```

### Getting Rid of Duplicated IDs
Now that we have calculated the patient-specific PM exposures, I can get rid of all rows other than the first row for each patient.
```{r}
dnam <-  dnam %>% 
  distinct_at(vars(ID), .keep_all=T)
```
This takes us down to 733 observations.



## Reorder columns
```{r}
dnam <- dnam %>% select(ID, everything(.))
```


# Make Dichotomized PM2.5
## 5yrs Pre-Sampling
Will use ATS-recommended 8ug/m^3 cutpoint to distinguish between low vs high exposures to PM2.5 over each time point
```{r}
dnam$PM5yrSamp_dich <- cut(dnam$PM_5yrPreSamp,
                      breaks=c(0, 8, 100),
                      labels=c("Low", "High"))
summary(dnam$PM5yrSamp_dich)
class(dnam$PM5yrSamp_dich)
```

## 1yr Pre-Sampling
```{r}
dnam$PM1yrSamp_dich <- cut(dnam$PM_1yrPreSamp,
                      breaks=c(0, 8, 100),
                      labels=c("Low", "High"))
summary(dnam$PM1yrSamp_dich)
class(dnam$PM1yrSamp_dich)
```


## 6mo Pre-Sampling
```{r}
dnam$PM6moSamp_dich <- cut(dnam$PM_6moPreSamp,
                      breaks=c(0, 8, 100),
                      labels=c("Low", "High"))
summary(dnam$PM6moSamp_dich)
class(dnam$PM6moSamp_dich)
```


## 3mo Pre-Sampling
```{r}
dnam$PM3moSamp_dich <- cut(dnam$PM_3moPreSamp,
                      breaks=c(0, 8, 100),
                      labels=c("Low", "High"))
summary(dnam$PM3moSamp_dich)
class(dnam$PM3moSamp_dich)
```


## 1mo Pre-Sampling
```{r}
dnam$PM1moSamp_dich <- cut(dnam$PM_1moPreSamp,
                      breaks=c(0, 8, 100),
                      labels=c("Low", "High"))
summary(dnam$PM1moSamp_dich)
class(dnam$PM1moSamp_dich)
```


# Make Dichotomized SO4
## 5yrs Pre-Sampling
Will take the median of SO4_5yrsPreSamp in both PFF and Simmons cohort, and then the average of those two medians to get the dichotomized cutpoint for SO4. Unfortunately for SO4, the Simmons Center exposures are so much higher than PFF that this cutpoint does not enable any overlap, so will set an arbitrary cut point for SO4 of 1.5ug/m^3
```{r}
dnam$SO45yrSamp_dich <- cut(dnam$SO4_5yrPreSamp,
                      breaks=c(0, 1.5, 100),
                      labels=c("Low", "High"))
summary(dnam$SO45yrSamp_dich)
class(dnam$SO45yrSamp_dich)
```

## 1yr Pre-Sampling
```{r}
dnam$SO41yrSamp_dich <- cut(dnam$SO4_1yrPreSamp,
                      breaks=c(0, 1.5, 100),
                      labels=c("Low", "High"))
summary(dnam$SO41yrSamp_dich)
class(dnam$SO41yrSamp_dich)
```


## 6mo Pre-Sampling
```{r}
dnam$SO46moSamp_dich <- cut(dnam$SO4_6moPreSamp,
                      breaks=c(0, 1.5, 100),
                      labels=c("Low", "High"))
summary(dnam$SO46moSamp_dich)
class(dnam$SO46moSamp_dich)
```


## 3mo Pre-Sampling
```{r}
dnam$SO43moSamp_dich <- cut(dnam$SO4_3moPreSamp,
                      breaks=c(0, 1.5, 100),
                      labels=c("Low", "High"))
summary(dnam$SO43moSamp_dich)
class(dnam$SO43moSamp_dich)
```


## 1mo Pre-Sampling
```{r}
dnam$SO41moSamp_dich <- cut(dnam$SO4_1moPreSamp,
                      breaks=c(0, 1.5, 100),
                      labels=c("Low", "High"))
summary(dnam$SO41moSamp_dich)
class(dnam$SO41moSamp_dich)
```


# Make Dichotomized NO3
## 5yrs Pre-Sampling
Will take the median of NO3_5yrsPreSamp in both PFF and Simmons cohort, and then the average of those two medians to get the dichotomized cutpoint for NO3
```{r}
dnam$NO35yrSamp_dich <- cut(dnam$NO3_5yrPreSamp,
                      breaks=c(0, 0.96, 100),
                      labels=c("Low", "High"))
summary(dnam$NO35yrSamp_dich)
class(dnam$NO35yrSamp_dich)
```

## 1yr Pre-Sampling
```{r}
dnam$NO31yrSamp_dich <- cut(dnam$NO3_1yrPreSamp,
                      breaks=c(0, 0.84, 100),
                      labels=c("Low", "High"))
summary(dnam$NO31yrSamp_dich)
class(dnam$NO31yrSamp_dich)
```


## 6mo Pre-Sampling
```{r}
dnam$NO36moSamp_dich <- cut(dnam$NO3_6moPreSamp,
                      breaks=c(0, 0.83, 100),
                      labels=c("Low", "High"))
summary(dnam$NO36moSamp_dich)
class(dnam$NO36moSamp_dich)
```


## 3mo Pre-Sampling
```{r}
dnam$NO33moSamp_dich <- cut(dnam$NO3_3moPreSamp,
                      breaks=c(0, 0.78, 100),
                      labels=c("Low", "High"))
summary(dnam$NO33moSamp_dich)
class(dnam$NO33moSamp_dich)
```


## 1mo Pre-Sampling
```{r}
dnam$NO31moSamp_dich <- cut(dnam$NO3_1moPreSamp,
                      breaks=c(0, 0.7, 100),
                      labels=c("Low", "High"))
summary(dnam$NO31moSamp_dich)
class(dnam$NO31moSamp_dich)
```



# Make Dichotomized NH4
## 5yrs Pre-Sampling
Will take the median of NH4_5yrsPreSamp in both PFF and Simmons cohort, and then the average of those two medians to get the dichotomized cutpoint for NH4. Unfortunately for NH4, the Simmons Center exposures are so much higher than PFF that this cutpoint does not enable any overlap, so will set an arbitrary cut point for NH4 of 1.5ug/m^3
```{r}
dnam$NH45yrSamp_dich <- cut(dnam$NH4_5yrPreSamp,
                      breaks=c(0, 0.5, 100),
                      labels=c("Low", "High"))
summary(dnam$NH45yrSamp_dich)
class(dnam$NH45yrSamp_dich)
```

## 1yr Pre-Sampling
```{r}
dnam$NH41yrSamp_dich <- cut(dnam$NH4_1yrPreSamp,
                      breaks=c(0, 0.5, 100),
                      labels=c("Low", "High"))
summary(dnam$NH41yrSamp_dich)
class(dnam$NH41yrSamp_dich)
```


## 6mo Pre-Sampling
```{r}
dnam$NH46moSamp_dich <- cut(dnam$NH4_6moPreSamp,
                      breaks=c(0, 0.5, 100),
                      labels=c("Low", "High"))
summary(dnam$NH46moSamp_dich)
class(dnam$NH46moSamp_dich)
```


## 3mo Pre-Sampling
```{r}
dnam$NH43moSamp_dich <- cut(dnam$NH4_3moPreSamp,
                      breaks=c(0, 0.5, 100),
                      labels=c("Low", "High"))
summary(dnam$NH43moSamp_dich)
class(dnam$NH43moSamp_dich)
```


## 1mo Pre-Sampling
```{r}
dnam$NH41moSamp_dich <- cut(dnam$NH4_1moPreSamp,
                      breaks=c(0, 0.5, 100),
                      labels=c("Low", "High"))
summary(dnam$NH41moSamp_dich)
class(dnam$NH41moSamp_dich)
```



# Make Dichotomized BC
## 5yrs Pre-Sampling
Will take the median of BC_5yrsPreSamp in both PFF and Simmons cohort, and then the average of those two medians to get the dichotomized cutpoint for BC
```{r}
dnam$BC5yrSamp_dich <- cut(dnam$BC_5yrPreSamp,
                      breaks=c(0, 0.73, 100),
                      labels=c("Low", "High"))
summary(dnam$BC5yrSamp_dich)
class(dnam$BC5yrSamp_dich)
```

## 1yr Pre-Sampling
```{r}
dnam$BC1yrSamp_dich <- cut(dnam$BC_1yrPreSamp,
                      breaks=c(0, 0.73, 100),
                      labels=c("Low", "High"))
summary(dnam$BC1yrSamp_dich)
class(dnam$BC1yrSamp_dich)
```


## 6mo Pre-Sampling
```{r}
dnam$BC6moSamp_dich <- cut(dnam$BC_6moPreSamp,
                      breaks=c(0, 0.73, 100),
                      labels=c("Low", "High"))
summary(dnam$BC6moSamp_dich)
class(dnam$BC6moSamp_dich)
```


## 3mo Pre-Sampling
```{r}
dnam$BC3moSamp_dich <- cut(dnam$BC_3moPreSamp,
                      breaks=c(0, 0.72, 100),
                      labels=c("Low", "High"))
summary(dnam$BC3moSamp_dich)
class(dnam$BC3moSamp_dich)
```


## 1mo Pre-Sampling
```{r}
dnam$BC1moSamp_dich <- cut(dnam$BC_1moPreSamp,
                      breaks=c(0, 0.73, 100),
                      labels=c("Low", "High"))
summary(dnam$BC1moSamp_dich)
class(dnam$BC1moSamp_dich)
```



# Make Dichotomized OM
## 5yrs Pre-Sampling
Will take the median of OM_5yrsPreSamp in both PFF and Simmons cohort, and then the average of those two medians to get the dichotomized cutpoint for OM
```{r}
dnam$OM5yrSamp_dich <- cut(dnam$OM_5yrPreSamp,
                      breaks=c(0, 3.01, 100),
                      labels=c("Low", "High"))
summary(dnam$OM5yrSamp_dich)
class(dnam$OM5yrSamp_dich)
```

## 1yr Pre-Sampling
```{r}
dnam$OM1yrSamp_dich <- cut(dnam$OM_1yrPreSamp,
                      breaks=c(0, 3.13, 100),
                      labels=c("Low", "High"))
summary(dnam$OM1yrSamp_dich)
class(dnam$OM1yrSamp_dich)
```


## 6mo Pre-Sampling
```{r}
dnam$OM6moSamp_dich <- cut(dnam$OM_6moPreSamp,
                      breaks=c(0, 3.12, 100),
                      labels=c("Low", "High"))
summary(dnam$OM6moSamp_dich)
class(dnam$OM6moSamp_dich)
```


## 3mo Pre-Sampling
```{r}
dnam$OM3moSamp_dich <- cut(dnam$OM_3moPreSamp,
                      breaks=c(0, 3.05, 100),
                      labels=c("Low", "High"))
summary(dnam$OM3moSamp_dich)
class(dnam$OM3moSamp_dich)
```


## 1mo Pre-Sampling
```{r}
dnam$OM1moSamp_dich <- cut(dnam$OM_1moPreSamp,
                      breaks=c(0, 3.0, 100),
                      labels=c("Low", "High"))
summary(dnam$OM1moSamp_dich)
class(dnam$OM1moSamp_dich)
```



# Make Dichotomized SS
## 5yrs Pre-Sampling
Will take the median of SS_5yrsPreSamp in both PFF and Simmons cohort, and then the average of those two medians to get the dichotomized cutpoint for SS
```{r}
dnam$SS5yrSamp_dich <- cut(dnam$SS_5yrPreSamp,
                      breaks=c(0, 0.22, 100),
                      labels=c("Low", "High"))
summary(dnam$SS5yrSamp_dich)
class(dnam$SS5yrSamp_dich)
```

## 1yr Pre-Sampling
```{r}
dnam$SS1yrSamp_dich <- cut(dnam$SS_1yrPreSamp,
                      breaks=c(0, 0.21, 100),
                      labels=c("Low", "High"))
summary(dnam$SS1yrSamp_dich)
class(dnam$SS1yrSamp_dich)
```


## 6mo Pre-Sampling
```{r}
dnam$SS6moSamp_dich <- cut(dnam$SS_6moPreSamp,
                      breaks=c(0, 0.2, 100),
                      labels=c("Low", "High"))
summary(dnam$SS6moSamp_dich)
class(dnam$SS6moSamp_dich)
```


## 3mo Pre-Sampling
```{r}
dnam$SS3moSamp_dich <- cut(dnam$SS_3moPreSamp,
                      breaks=c(0, 0.2, 100),
                      labels=c("Low", "High"))
summary(dnam$SS3moSamp_dich)
class(dnam$SS3moSamp_dich)
```


## 1mo Pre-Sampling
```{r}
dnam$SS1moSamp_dich <- cut(dnam$SS_1moPreSamp,
                      breaks=c(0, 0.2, 100),
                      labels=c("Low", "High"))
summary(dnam$SS1moSamp_dich)
class(dnam$SS1moSamp_dich)
```



# Make Dichotomized Soil
## 5yrs Pre-Sampling
Will take the median of Soil_5yrsPreSamp in both PFF and Simmons cohort, and then the average of those two medians to get the dichotomized cutpoint for Soil
```{r}
dnam$Soil5yrSamp_dich <- cut(dnam$Soil_5yrPreSamp,
                      breaks=c(0, 0.5, 100),
                      labels=c("Low", "High"))
summary(dnam$Soil5yrSamp_dich)
class(dnam$Soil5yrSamp_dich)
```

## 1yr Pre-Sampling
```{r}
dnam$Soil1yrSamp_dich <- cut(dnam$Soil_1yrPreSamp,
                      breaks=c(0, 0.5, 100),
                      labels=c("Low", "High"))
summary(dnam$Soil1yrSamp_dich)
class(dnam$Soil1yrSamp_dich)
```


## 6mo Pre-Sampling
```{r}
dnam$Soil6moSamp_dich <- cut(dnam$Soil_6moPreSamp,
                      breaks=c(0, 0.45, 100),
                      labels=c("Low", "High"))
summary(dnam$Soil6moSamp_dich)
class(dnam$Soil6moSamp_dich)
```


## 3mo Pre-Sampling
```{r}
dnam$Soil3moSamp_dich <- cut(dnam$Soil_3moPreSamp,
                      breaks=c(0, 0.45, 100),
                      labels=c("Low", "High"))
summary(dnam$Soil3moSamp_dich)
class(dnam$Soil3moSamp_dich)
```


## 1mo Pre-Sampling
```{r}
dnam$Soil1moSamp_dich <- cut(dnam$Soil_1moPreSamp,
                      breaks=c(0, 0.45, 100),
                      labels=c("Low", "High"))
summary(dnam$Soil1moSamp_dich)
class(dnam$Soil1moSamp_dich)
```



# Export File with All PM2.5 and Constituent Time Frames Matched
```{r}
write_xlsx(dnam, path="PFF_fILD_PM25andConstituentsMatched_forMethylFlash_2022_06_06.xlsx")
```

# Releveling Factors
Here I am releveling factors so that they are in an intuitive order for my later analyses.
```{r}
dnam$sex <- fct_relevel(dnam$sex, c("Male","Female"))
dnam$race <- fct_relevel(dnam$race, c("W","B","A","U"))
dnam$ethnicity <- fct_relevel(dnam$ethnicity, c("N","H","U"))
dnam$dich_Race <- fct_relevel(dnam$dich_Race, c("White","Non-White"))
dnam$smokeHx <- fct_relevel(dnam$smokeHx, c("Never","Ever"))

#For dx and dx_group, I just want IPF to be first and then the rest of the categories are alphabetical
dnam$dx <- fct_relevel(dnam$dx, c("IPF"))
dnam$dx_group <- fct_relevel(dnam$dx_group, c("IPF"))
dnam$dx_IPF <- fct_relevel(dnam$dx_IPF, c("IPF"))
#dnam$PM5yrCensor_dich <- fct_relevel(dnam$PM5yrCensor_dich, c("Low"))
#dnam$PM5yr_dich <- fct_relevel(dnam$PM5yr_dich, c("Low"))
#dnam$SO45yrCensor_dich <- fct_relevel(dnam$SO45yrCensor_dich, c("Low"))
#dnam$SO45yr_dich <- fct_relevel(dnam$SO45yr_dich, c("Low"))
#dnam$NO35yrCensor_dich <- fct_relevel(dnam$NO35yrCensor_dich, c("Low"))
#dnam$NO35yr_dich <- fct_relevel(dnam$NO35yr_dich, c("Low"))
#dnam$NH45yrCensor_dich <- fct_relevel(dnam$NH45yrCensor_dich, c("Low"))
#dnam$NH45yr_dich <- fct_relevel(dnam$NH45yr_dich, c("Low"))
#dnam$BC5yrCensor_dich <- fct_relevel(dnam$BC5yrCensor_dich, c("Low"))
#dnam$BC5yr_dich <- fct_relevel(dnam$BC5yr_dich, c("Low"))
#dnam$OM5yrCensor_dich <- fct_relevel(dnam$OM5yrCensor_dich, c("Low"))
#dnam$OM5yr_dich <- fct_relevel(dnam$OM5yr_dich, c("Low"))
#dnam$SS5yrCensor_dich <- fct_relevel(dnam$SS5yrCensor_dich, c("Low"))
#dnam$SS5yr_dich <- fct_relevel(dnam$SS5yr_dich, c("Low"))
#dnam$Soil5yrCensor_dich <- fct_relevel(dnam$Soil5yrCensor_dich, c("Low"))
#dnam$Soil5yr_dich <- fct_relevel(dnam$Soil5yr_dich, c("Low"))
str(dnam)
```

# Creating New Variables
## Time between Registry Enrollment and Sample Date
Need to know if consent_date is a reasonable time point to be basing our DNAm results from
```{r}
dnam <- dnam %>% mutate(time_sample=(sample_date-consent_date)/365.25)
dnam$time_sample <- as.numeric(dnam$time_sample)
```

## Proportion %5mC
Will need to use the actual proportion of 5mC for beta regression analyses where values must be between 0 and 1
```{r}
dnam <- dnam %>% mutate(prop_5mC=pct_5mC/100)
```

## PFF Site
```{r}
dnam <- dnam %>% mutate(site=stringr::str_extract(SSID, "^.{2}"))
dnam$site <- as.factor(dnam$site)
str(dnam$site)
str(dnam$state)
```

## Region of the U.S.
```{r}
dnam$state <- as.factor(dnam$state)
dnam <- dnam %>% mutate(region=case_when(state %in% c("CA", "CO", "ID", "MT", "OR", "UT", "WA") ~ "West",
                                         state %in% c("TX", "AZ", "NV", "NM") ~ "Southwest",
                                         state %in% c("IL", "IA", "IN", "KS", "MI", "MN", "MO", "ND", "NE", "OH", "SD", "WI") ~ "Midwest",
                                         state %in% c("CN", "CT", "DC", "DE", "MA", "MD", "ME", "NH", "NJ", "NY", "PA", "RI", "VT") ~ "Northeast",
                                         state %in% c("AL", "AR", "FL", "GA", "KY", "LA", "MS", "NC", "SC", "TN", "VA", "WV") ~ "Southeast"))
```



# Exploratory Data Analysis
This is a function that allows me to make tables which summarize the count and percentages of each level of factor variables
```{r}
n_prop_tbl <- function(x) {
  tbl <- table(x)
  res <- cbind(tbl, round(prop.table(tbl)*100,2))
  colnames(res) <-  c('Count', 'Percentage')
  res
}
```


## PM Breakdown 
```{r}
print("PM2.5")
summary(dnam$PM_5yrPreSamp)
summary(dnam$PM_1yrPreSamp)
summary(dnam$PM_6moPreSamp)
summary(dnam$PM_3moPreSamp)
summary(dnam$PM_1moPreSamp)

print("/nSO4")
summary(dnam$SO4_5yrPreSamp)
summary(dnam$SO4_1yrPreSamp)
summary(dnam$SO4_6moPreSamp)
summary(dnam$SO4_3moPreSamp)
summary(dnam$SO4_1moPreSamp)

print("/nNO3")
summary(dnam$NO3_5yrPreSamp)
summary(dnam$NO3_1yrPreSamp)
summary(dnam$NO3_6moPreSamp)
summary(dnam$NO3_3moPreSamp)
summary(dnam$NO3_1moPreSamp)

print("/nNH4")
summary(dnam$NH4_5yrPreSamp)
summary(dnam$NH4_1yrPreSamp)
summary(dnam$NH4_6moPreSamp)
summary(dnam$NH4_3moPreSamp)
summary(dnam$NH4_1moPreSamp)

print("/nBC")
summary(dnam$BC_5yrPreSamp)
summary(dnam$BC_1yrPreSamp)
summary(dnam$BC_6moPreSamp)
summary(dnam$BC_3moPreSamp)
summary(dnam$BC_1moPreSamp)

print("/nOM")
summary(dnam$OM_5yrPreSamp)
summary(dnam$OM_1yrPreSamp)
summary(dnam$OM_6moPreSamp)
summary(dnam$OM_3moPreSamp)
summary(dnam$OM_1moPreSamp)

print("/nSS")
summary(dnam$SS_5yrPreSamp)
summary(dnam$SS_1yrPreSamp)
summary(dnam$SS_6moPreSamp)
summary(dnam$SS_3moPreSamp)
summary(dnam$SS_1moPreSamp)

print("/nSoil")
summary(dnam$Soil_5yrPreSamp)
summary(dnam$Soil_1yrPreSamp)
summary(dnam$Soil_6moPreSamp)
summary(dnam$Soil_3moPreSamp)
summary(dnam$Soil_1moPreSamp)
```

## Sex Breakdown
```{r}
n_prop_tbl(dnam$sex)
```

## Race and Ethnicity Breakdown 
```{r}
n_prop_tbl(dnam$race)

n_prop_tbl(dnam$ethnicity)
```

## Smoking History Breakdown
```{r}
n_prop_tbl(dnam$smokeHx)
```


## Diagnostic Group Breakdown
```{r}
n_prop_tbl(dnam$dx_group)
```


## State Breakdown
```{r}
n_prop_tbl(dnam$state)
```

## Metropolitan Breakdown
```{r}
n_prop_tbl(dnam$metro)
```
Overwhelming majority of the patients are considered "metropolitan".

## Age at Diagnosis Breakdown
```{r}
shapiro.test(dnam$age_dx)
#Shapiro tests tells us that age_dx is not normally distributed, so should report median, IQR
summary(dnam$age_dx)
```
Not normally distributed.

## Vital Status Breakdown
```{r}
n_prop_tbl(dnam$status)
```


## Baseline Lung Function Breakdown
```{r}
shapiro.test(dnam$fvc_pct)
summary(dnam$fvc_pct)
sd(dnam$fvc_pct, na.rm=T)
```

```{r}
shapiro.test(dnam$dlco_pct)
summary(dnam$dlco_pct)
sd(dnam$dlco_pct, na.rm=T)
```

## Time to Censoring Breakdown
```{r}
summary(dnam$time_DeathTxCensor)
sd(dnam$time_DeathTxCensor, na.rm=T)
```

## Time between registry enrollment and sample collection
```{r}
summary(dnam$time_sample)
sd(dnam$time_sample, na.rm=T)
```
This indicates that the majority of samples are taken very close to the time of consent, which is our reference for the _5yrPreDx periods for exposure matching, although there are a few where samples were taken far before or far after the consent_date.

# Visual Exploratory Data Analysis
## Histograms
Histogram of %5mC
```{r}
(dnam %>% ggplot(aes(x=pct_5mC))+
   geom_histogram(fill="blue", color="black")+
   labs(x="% 5mC", y="Number of patients with IPF", title="% 5mC in Patients with IPF")+
   theme(plot.title = element_text(hjust = 0.5)))
```
We have some very high outliers, whreas the rest is generally <0.3%

Histogram of %5mC
```{r}
(dnam %>% ggplot(aes(x=pct_5mC))+
   geom_histogram(fill="blue", color="black")+
   labs(x="% 5mC", y="Number of patients with IPF", title="% 5mC in Patients with IPF")+
   theme(plot.title = element_text(hjust = 0.5))+
   xlim(0,0.5))
```
Slightly right-skewed distribution.

## Scatterplots
### PM2.5 Scatterplots
Scatterplot of continuous PM2.5 5yrs Pre-Sampling vs %5mC
```{r}
(dnam %>% ggplot(aes(x=PM_5yrPreSamp, y=pct_5mC))+
   geom_point()+
   labs(x="PM2.5 in 5yrs Pre-Sampling", y="% 5mC", title="%5mC by PM2.5 5yrs Pre-Sampling")+
   geom_smooth(method="lm", se = FALSE) +
   theme(plot.title = element_text(hjust = 0.5))+
   xlim(0,20)+
   ylim(0, 0.5))
```

Scatterplot of continuous PM2.5 1yr Pre-Sampling vs %5mC
```{r}
(dnam %>% ggplot(aes(x=PM_1yrPreSamp, y=pct_5mC))+
   geom_point()+
   labs(x="PM2.5 in 1yr Pre-Sampling", y="% 5mC", title="%5mC by PM2.5 1yr Pre-Sampling")+
   geom_smooth(method="lm", se = FALSE) +
   theme(plot.title = element_text(hjust = 0.5))+
   xlim(0,20)+
   ylim(0, 0.5))
```

Scatterplot of continuous PM2.5 6mo Pre-Sampling vs %5mC
```{r}
(dnam %>% ggplot(aes(x=PM_6moPreSamp, y=pct_5mC))+
   geom_point()+
   labs(x="PM2.5 in 6mo Pre-Sampling", y="% 5mC", title="%5mC by PM2.5 6mo Pre-Sampling")+
   geom_smooth(method="lm", se = FALSE) +
   theme(plot.title = element_text(hjust = 0.5))+
   xlim(0,20)+
   ylim(0, 0.5))
```

Scatterplot of continuous PM2.5 3mo Pre-Sampling vs %5mC
```{r}
(dnam %>% ggplot(aes(x=PM_3moPreSamp, y=pct_5mC))+
   geom_point()+
   labs(x="PM2.5 in 3mo Pre-Sampling", y="% 5mC", title="%5mC by PM2.5 3mo Pre-Sampling")+
   geom_smooth(method="lm", se = FALSE) +
   theme(plot.title = element_text(hjust = 0.5))+
   xlim(0,20)+
   ylim(0, 0.5))
```

Scatterplot of continuous PM2.5 1mo Pre-Sampling vs %5mC
```{r}
(dnam %>% ggplot(aes(x=PM_1moPreSamp, y=pct_5mC))+
   geom_point()+
   labs(x="PM2.5 in 1mo Pre-Sampling", y="% 5mC", title="%5mC by PM2.5 1mo Pre-Sampling")+
   geom_smooth(method="lm", se = FALSE) +
   theme(plot.title = element_text(hjust = 0.5))+
   xlim(0,20)+
   ylim(0, 0.5))
```


## SO4 Scatterplots
Scatterplot of continuous SO4 5yrs Pre-Sampling vs %5mC
```{r}
(dnam %>% ggplot(aes(x=SO4_5yrPreSamp, y=pct_5mC))+
   geom_point()+
   labs(x="SO4 in 5yrs Pre-Sampling", y="% 5mC", title="%5mC by SO4 5yrs Pre-Sampling")+
   geom_smooth(method="lm", se = FALSE) +
   theme(plot.title = element_text(hjust = 0.5))+
   xlim(0,2.5)+
   ylim(0, 0.5))
```

Scatterplot of continuous SO4 1yr Pre-Sampling vs %5mC
```{r}
(dnam %>% ggplot(aes(x=PM_1yrPreSamp, y=pct_5mC))+
   geom_point()+
   labs(x="SO4 in 1yr Pre-Sampling", y="% 5mC", title="%5mC by SO4 1yr Pre-Sampling")+
   geom_smooth(method="lm", se = FALSE) +
   theme(plot.title = element_text(hjust = 0.5))+
   xlim(0,20)+
   ylim(0, 0.5))
```

Scatterplot of continuous SO4 6mo Pre-Sampling vs %5mC
```{r}
(dnam %>% ggplot(aes(x=SO4_6moPreSamp, y=pct_5mC))+
   geom_point()+
   labs(x="SO4 in 6mo Pre-Sampling", y="% 5mC", title="%5mC by SO4 6mo Pre-Sampling")+
   geom_smooth(method="lm", se = FALSE) +
   theme(plot.title = element_text(hjust = 0.5))+
   xlim(0,2.5)+
   ylim(0, 0.5))
```

Scatterplot of continuous SO4 3mo Pre-Sampling vs %5mC
```{r}
(dnam %>% ggplot(aes(x=SO4_3moPreSamp, y=pct_5mC))+
   geom_point()+
   labs(x="SO4 in 3mo Pre-Sampling", y="% 5mC", title="%5mC by SO4 3mo Pre-Sampling")+
   geom_smooth(method="lm", se = FALSE) +
   theme(plot.title = element_text(hjust = 0.5))+
   xlim(0,2.5)+
   ylim(0, 0.5))
```

Scatterplot of continuous SO4 1mo Pre-Sampling vs %5mC
```{r}
(dnam %>% ggplot(aes(x=SO4_1moPreSamp, y=pct_5mC))+
   geom_point()+
   labs(x="SO4 in 1mo Pre-Sampling", y="% 5mC", title="%5mC by SO4 1mo Pre-Sampling")+
   geom_smooth(method="lm", se = FALSE) +
   theme(plot.title = element_text(hjust = 0.5))+
   xlim(0,2.5)+
   ylim(0, 0.5))
```


### NO3 Scatterplots
Scatterplot of continuous NO3 5yrs Pre-Sampling vs %5mC
```{r}
(dnam %>% ggplot(aes(x=NO3_5yrPreSamp, y=pct_5mC))+
   geom_point()+
   labs(x="NO3 in 5yrs Pre-Sampling", y="% 5mC", title="%5mC by NO3 5yrs Pre-Sampling")+
   geom_smooth(method="lm", se = FALSE) +
   theme(plot.title = element_text(hjust = 0.5))+
   xlim(0,5)+
   ylim(0, 0.5))
```



Scatterplot of continuous NO3 1yr Pre-Sampling vs %5mC
```{r}
(dnam %>% ggplot(aes(x=NO3_1yrPreSamp, y=pct_5mC))+
   geom_point()+
   labs(x="NO3 in 1yrs Pre-Sampling", y="% 5mC", title="%5mC by NO3 1yrs Pre-Sampling")+
   geom_smooth(method="lm", se = FALSE) +
   theme(plot.title = element_text(hjust = 0.5))+
   xlim(0,5)+
   ylim(0, 0.5))
```



Scatterplot of continuous NO3 6mo Pre-Sampling vs %5mC
```{r}
(dnam %>% ggplot(aes(x=NO3_6moPreSamp, y=pct_5mC))+
   geom_point()+
   labs(x="NO3 in 6mo Pre-Sampling", y="% 5mC", title="%5mC by NO3 6mo Pre-Sampling")+
   geom_smooth(method="lm", se = FALSE) +
   theme(plot.title = element_text(hjust = 0.5))+
   xlim(0,5)+
   ylim(0, 0.5))
```

Scatterplot of continuous NO3 3mo Pre-Sampling vs %5mC
```{r}
(dnam %>% ggplot(aes(x=NO3_3moPreSamp, y=pct_5mC))+
   geom_point()+
   labs(x="NO3 in 3mo Pre-Sampling", y="% 5mC", title="%5mC by NO3 3mo Pre-Sampling")+
   geom_smooth(method="lm", se = FALSE) +
   theme(plot.title = element_text(hjust = 0.5))+
   xlim(0,5)+
   ylim(0, 0.5))
```

Scatterplot of continuous NO3 1mo Pre-Sampling vs %5mC
```{r}
(dnam %>% ggplot(aes(x=NO3_1moPreSamp, y=pct_5mC))+
   geom_point()+
   labs(x="NO3 in 1mo Pre-Sampling", y="% 5mC", title="%5mC by NO3 1mo Pre-Sampling")+
   geom_smooth(method="lm", se = FALSE) +
   theme(plot.title = element_text(hjust = 0.5))+
   xlim(0,5)+
   ylim(0, 0.5))
```


### NH4 Scatterplots
Scatterplot of continuous NH4 5yrs Pre-Sampling vs %5mC
```{r}
(dnam %>% ggplot(aes(x=NH4_5yrPreSamp, y=pct_5mC))+
   geom_point()+
   labs(x="NH4 in 5yrs Pre-Sampling", y="% 5mC", title="%5mC by NH4 5yrs Pre-Sampling")+
   geom_smooth(method="lm", se = FALSE) +
   theme(plot.title = element_text(hjust = 0.5))+
   xlim(0, 1.5)+
   ylim(0, 0.5))
```



Scatterplot of continuous NH4 1yr Pre-Sampling vs %5mC
```{r}
(dnam %>% ggplot(aes(x=NH4_1yrPreSamp, y=pct_5mC))+
   geom_point()+
   labs(x="NH4 in 1yr Pre-Sampling", y="% 5mC", title="%5mC by NH4 1yr Pre-Sampling")+
   geom_smooth(method="lm", se = FALSE) +
   theme(plot.title = element_text(hjust = 0.5))+
   xlim(0, 1.5)+
   ylim(0, 0.5))
```


Scatterplot of continuous NH4 6mo Pre-Sampling vs %5mC
```{r}
(dnam %>% ggplot(aes(x=NH4_6moPreSamp, y=pct_5mC))+
   geom_point()+
   labs(x="NH4 in 6mo Pre-Sampling", y="% 5mC", title="%5mC by NH4 6mo Pre-Sampling")+
   geom_smooth(method="lm", se = FALSE) +
   theme(plot.title = element_text(hjust = 0.5))+
   xlim(0,2)+
   ylim(0, 0.5))
```

Scatterplot of continuous NH4 3mo Pre-Sampling vs %5mC
```{r}
(dnam %>% ggplot(aes(x=NH4_3moPreSamp, y=pct_5mC))+
   geom_point()+
   labs(x="NH4 in 3mo Pre-Sampling", y="% 5mC", title="%5mC by NH4 3mo Pre-Sampling")+
   geom_smooth(method="lm", se = FALSE) +
   theme(plot.title = element_text(hjust = 0.5))+
   xlim(0,2)+
   ylim(0, 0.5))
```

Scatterplot of continuous NH4 1mo Pre-Sampling vs %5mC
```{r}
(dnam %>% ggplot(aes(x=NH4_1moPreSamp, y=pct_5mC))+
   geom_point()+
   labs(x="NH4 in 1mo Pre-Sampling", y="% 5mC", title="%5mC by NH4 1mo Pre-Sampling")+
   geom_smooth(method="lm", se = FALSE) +
   theme(plot.title = element_text(hjust = 0.5))+
   xlim(0,2)+
   ylim(0, 0.5))
```


### BC Scatterplots
Scatterplot of continuous BC 5yrs Pre-Sampling vs %5mC
```{r}
(dnam %>% ggplot(aes(x=BC_5yrPreSamp, y=pct_5mC))+
   geom_point()+
   labs(x="BC in 5yrs Pre-Sampling", y="% 5mC", title="%5mC by BC 5yrs Pre-Sampling")+
   geom_smooth(method="lm", se = FALSE) +
   theme(plot.title = element_text(hjust = 0.5))+
   xlim(0, 2)+
   ylim(0, 0.5))
```

Scatterplot of continuous BC 1yr Pre-Sampling vs %5mC
```{r}
(dnam %>% ggplot(aes(x=BC_1yrPreSamp, y=pct_5mC))+
   geom_point()+
   labs(x="BC in 1yr Pre-Sampling", y="% 5mC", title="%5mC by BC 1yr Pre-Sampling")+
   geom_smooth(method="lm", se = FALSE) +
   theme(plot.title = element_text(hjust = 0.5))+
   xlim(0, 2)+
   ylim(0, 0.5))
```


Scatterplot of continuous BC 6mo Pre-Sampling vs %5mC
```{r}
(dnam %>% ggplot(aes(x=BC_6moPreSamp, y=pct_5mC))+
   geom_point()+
   labs(x="BC in 6mo Pre-Sampling", y="% 5mC", title="%5mC by BC 6mo Pre-Sampling")+
   geom_smooth(method="lm", se = FALSE) +
   theme(plot.title = element_text(hjust = 0.5))+
   xlim(0,2)+
   ylim(0, 0.5))
```

Scatterplot of continuous BC 3mo Pre-Sampling vs %5mC
```{r}
(dnam %>% ggplot(aes(x=BC_3moPreSamp, y=pct_5mC))+
   geom_point()+
   labs(x="BC in 3mo Pre-Sampling", y="% 5mC", title="%5mC by BC 3mo Pre-Sampling")+
   geom_smooth(method="lm", se = FALSE) +
   theme(plot.title = element_text(hjust = 0.5))+
   xlim(0,2)+
   ylim(0, 0.5))
```

Scatterplot of continuous BC 1mo Pre-Sampling vs %5mC
```{r}
(dnam %>% ggplot(aes(x=BC_1moPreSamp, y=pct_5mC))+
   geom_point()+
   labs(x="BC in 1mo Pre-Sampling", y="% 5mC", title="%5mC by BC 1mo Pre-Sampling")+
   geom_smooth(method="lm", se = FALSE) +
   theme(plot.title = element_text(hjust = 0.5))+
   xlim(0,2)+
   ylim(0, 0.5))
```


### OM Scatterplots
Scatterplot of continuous OM 5yrs Pre-Sampling vs %5mC
```{r}
(dnam %>% ggplot(aes(x=OM_5yrPreSamp, y=pct_5mC))+
   geom_point()+
   labs(x="OM in 5yrs Pre-Sampling", y="% 5mC", title="%5mC by OM 5yrs Pre-Sampling")+
   geom_smooth(method="lm", se = FALSE) +
   theme(plot.title = element_text(hjust = 0.5))+
   xlim(0, 8)+
   ylim(0, 0.5))
```

Scatterplot of continuous OM 1yr Pre-Sampling vs %5mC
```{r}
(dnam %>% ggplot(aes(x=OM_1yrPreSamp, y=pct_5mC))+
   geom_point()+
   labs(x="OM in 1yr Pre-Sampling", y="% 5mC", title="%5mC by OM 1yr Pre-Sampling")+
   geom_smooth(method="lm", se = FALSE) +
   theme(plot.title = element_text(hjust = 0.5))+
   xlim(0, 8)+
   ylim(0, 0.5))
```


Scatterplot of continuous OM 6mo Pre-Sampling vs %5mC
```{r}
(dnam %>% ggplot(aes(x=OM_6moPreSamp, y=pct_5mC))+
   geom_point()+
   labs(x="OM in 6mo Pre-Sampling", y="% 5mC", title="%5mC by OM 6mo Pre-Sampling")+
   geom_smooth(method="lm", se = FALSE) +
   theme(plot.title = element_text(hjust = 0.5))+
   xlim(0,10)+
   ylim(0, 0.5))
```

Scatterplot of continuous OM 3mo Pre-Sampling vs %5mC
```{r}
(dnam %>% ggplot(aes(x=OM_3moPreSamp, y=pct_5mC))+
   geom_point()+
   labs(x="OM in 3mo Pre-Sampling", y="% 5mC", title="%5mC by OM 3mo Pre-Sampling")+
   geom_smooth(method="lm", se = FALSE) +
   theme(plot.title = element_text(hjust = 0.5))+
   xlim(0,10)+
   ylim(0, 0.5))
```

Scatterplot of continuous OM 1mo Pre-Sampling vs %5mC
```{r}
(dnam %>% ggplot(aes(x=OM_1moPreSamp, y=pct_5mC))+
   geom_point()+
   labs(x="OM in 1mo Pre-Sampling", y="% 5mC", title="%5mC by OM 1mo Pre-Sampling")+
   geom_smooth(method="lm", se = FALSE) +
   theme(plot.title = element_text(hjust = 0.5))+
   xlim(0,10)+
   ylim(0, 0.5))
```


## SS Scatterplots
Scatterplot of continuous SS 5yrs Pre-Sampling vs %5mC
```{r}
(dnam %>% ggplot(aes(x=SS_5yrPreSamp, y=pct_5mC))+
   geom_point()+
   labs(x="SS in 5yrs Pre-Sampling", y="% 5mC", title="%5mC by SS 5yrs Pre-Sampling")+
   geom_smooth(method="lm", se = FALSE) +
   theme(plot.title = element_text(hjust = 0.5))+
   xlim(0, 2.5)+
   ylim(0, 0.5))
```

Scatterplot of continuous SS 1yr Pre-Sampling vs %5mC
```{r}
(dnam %>% ggplot(aes(x=SS_1yrPreSamp, y=pct_5mC))+
   geom_point()+
   labs(x="SS in 1yr Pre-Sampling", y="% 5mC", title="%5mC by SS 1yr Pre-Sampling")+
   geom_smooth(method="lm", se = FALSE) +
   theme(plot.title = element_text(hjust = 0.5))+
   xlim(0, 2.5)+
   ylim(0, 0.5))
```


Scatterplot of continuous SS 6mo Pre-Sampling vs %5mC
```{r}
(dnam %>% ggplot(aes(x=SS_6moPreSamp, y=pct_5mC))+
   geom_point()+
   labs(x="SS in 6mo Pre-Sampling", y="% 5mC", title="%5mC by SS 6mo Pre-Sampling")+
   geom_smooth(method="lm", se = FALSE) +
   theme(plot.title = element_text(hjust = 0.5))+
   xlim(0,5)+
   ylim(0, 0.5))
```

Scatterplot of continuous SS 3mo Pre-Sampling vs %5mC
```{r}
(dnam %>% ggplot(aes(x=SS_3moPreSamp, y=pct_5mC))+
   geom_point()+
   labs(x="SS in 3mo Pre-Sampling", y="% 5mC", title="%5mC by SS 3mo Pre-Sampling")+
   geom_smooth(method="lm", se = FALSE) +
   theme(plot.title = element_text(hjust = 0.5))+
   xlim(0,5)+
   ylim(0, 0.5))
```

Scatterplot of continuous SS 1mo Pre-Sampling vs %5mC
```{r}
(dnam %>% ggplot(aes(x=SS_1moPreSamp, y=pct_5mC))+
   geom_point()+
   labs(x="SS in 1mo Pre-Sampling", y="% 5mC", title="%5mC by SS 1mo Pre-Sampling")+
   geom_smooth(method="lm", se = FALSE) +
   theme(plot.title = element_text(hjust = 0.5))+
   xlim(0,5)+
   ylim(0, 0.5))
```


### Soil Scatterplots
Scatterplot of continuous Soil 5yrs Pre-Sampling vs %5mC
```{r}
(dnam %>% ggplot(aes(x=Soil_5yrPreSamp, y=pct_5mC))+
   geom_point()+
   labs(x="Soil in 5yrs Pre-Sampling", y="% 5mC", title="%5mC by Soil 5yrs Pre-Sampling")+
   geom_smooth(method="lm", se = FALSE) +
   theme(plot.title = element_text(hjust = 0.5))+
   xlim(0, 3)+
   ylim(0, 0.5))
```

Scatterplot of continuous Soil 1yr Pre-Sampling vs %5mC
```{r}
(dnam %>% ggplot(aes(x=Soil_1yrPreSamp, y=pct_5mC))+
   geom_point()+
   labs(x="Soil in 1yr Pre-Sampling", y="% 5mC", title="%5mC by Soil 1yr Pre-Sampling")+
   geom_smooth(method="lm", se = FALSE) +
   theme(plot.title = element_text(hjust = 0.5))+
   xlim(0, 3)+
   ylim(0, 0.5))
```


Scatterplot of continuous Soil 6mo Pre-Sampling vs %5mC
```{r}
(dnam %>% ggplot(aes(x=Soil_6moPreSamp, y=pct_5mC))+
   geom_point()+
   labs(x="Soil in 6mo Pre-Sampling", y="% 5mC", title="%5mC by Soil 6mo Pre-Sampling")+
   geom_smooth(method="lm", se = FALSE) +
   theme(plot.title = element_text(hjust = 0.5))+
   xlim(0,3)+
   ylim(0, 0.5))
```

Scatterplot of continuous Soil 3mo Pre-Sampling vs %5mC
```{r}
(dnam %>% ggplot(aes(x=Soil_3moPreSamp, y=pct_5mC))+
   geom_point()+
   labs(x="Soil in 3mo Pre-Sampling", y="% 5mC", title="%5mC by Soil 3mo Pre-Sampling")+
   geom_smooth(method="lm", se = FALSE) +
   theme(plot.title = element_text(hjust = 0.5))+
   xlim(0,3)+
   ylim(0, 0.5))
```

Scatterplot of continuous Soil 1mo Pre-Sampling vs %5mC
```{r}
(dnam %>% ggplot(aes(x=Soil_1moPreSamp, y=pct_5mC))+
   geom_point()+
   labs(x="Soil in 1mo Pre-Sampling", y="% 5mC", title="%5mC by Soil 1mo Pre-Sampling")+
   geom_smooth(method="lm", se = FALSE) +
   theme(plot.title = element_text(hjust = 0.5))+
   xlim(0,3)+
   ylim(0, 0.5))
```



## Violin Plots of Dichotomized PM2.5 and Constituents
### PM2.5
Violin plot wrapping boxplot to visualize Dichotomized PM2.5 5yrs Pre-Sampling vs %5mC
```{r}
dnamb <- dnam %>% filter(!is.na(PM5yrSamp_dich))
(dnamb %>% ggplot(aes(x=PM5yrSamp_dich, y=pct_5mC, fill=PM5yrSamp_dich))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="PM2.5 5yrs Pre-Sampling Low vs High", y="% 5mC", title="% 5mC by Dichotomized PM2.5 5yrs Pre-Sampling")+
    theme_light()+
    theme(legend.position = "none", plot.title = element_text(hjust = 0.5))+
    ylim(0,0.25))
```

Violin plot wrapping boxplot to visualize Dichotomized PM2.5 1yr Pre-Sampling vs %5mC
```{r}
dnamb <- dnam %>% filter(!is.na(PM1yrSamp_dich))
(dnamb %>% ggplot(aes(x=PM1yrSamp_dich, y=pct_5mC, fill=PM1yrSamp_dich))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="PM2.5 1yr Pre-Sampling Low vs High", y="% 5mC", title="% 5mC by Dichotomized PM2.5 1yr Pre-Sampling")+
    theme_light()+
    theme(legend.position = "none", plot.title = element_text(hjust = 0.5))+
    ylim(0,0.25))
```

Violin plot wrapping boxplot to visualize Dichotomized PM2.5 6mo Pre-Sampling vs %5mC
```{r}
dnamb <- dnam %>% filter(!is.na(PM6moSamp_dich))
(dnamb %>% ggplot(aes(x=PM6moSamp_dich, y=pct_5mC, fill=PM6moSamp_dich))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="PM2.5 6mo Pre-Sampling Low vs High", y="% 5mC", title="% 5mC by Dichotomized PM2.5 6mo Pre-Sampling")+
    theme_light()+
    theme(legend.position = "none", plot.title = element_text(hjust = 0.5))+
    ylim(0,0.25))
```

Violin plot wrapping boxplot to visualize Dichotomized PM2.5 3mo Pre-Sampling vs %5mC
```{r}
dnamb <- dnam %>% filter(!is.na(PM3moSamp_dich))
(dnamb %>% ggplot(aes(x=PM3moSamp_dich, y=pct_5mC, fill=PM3moSamp_dich))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="PM2.5 3mo Pre-Sampling Low vs High", y="% 5mC", title="% 5mC by Dichotomized PM2.5 3mo Pre-Sampling")+
    theme_light()+
    theme(legend.position = "none", plot.title = element_text(hjust = 0.5))+
    ylim(0,0.25))
```

Violin plot wrapping boxplot to visualize Dichotomized PM2.5 1mo Pre-Sampling vs %5mC
```{r}
dnamb <- dnam %>% filter(!is.na(PM1moSamp_dich))
(dnamb %>% ggplot(aes(x=PM1moSamp_dich, y=pct_5mC, fill=PM1moSamp_dich))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="PM2.5 1mo Pre-Sampling Low vs High", y="% 5mC", title="% 5mC by Dichotomized PM2.5 1mo Pre-Sampling")+
    theme_light()+
    theme(legend.position = "none", plot.title = element_text(hjust = 0.5))+
    ylim(0,0.25))
```

### SO4
Violin plot wrapping boxplot to visualize Dichotomized SO4 5yrs Pre-Sampling vs %5mC
```{r}
dnamb <- dnam %>% filter(!is.na(SO45yrSamp_dich))
(dnamb %>% ggplot(aes(x=SO45yrSamp_dich, y=pct_5mC, fill=SO45yrSamp_dich))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="SO4 5yrs Pre-Sampling Low vs High", y="% 5mC", title="% 5mC by Dichotomized SO4 5yrs Pre-Sampling")+
    theme_light()+
    theme(legend.position = "none", plot.title = element_text(hjust = 0.5))+
    ylim(0,0.25))
```

Violin plot wrapping boxplot to visualize Dichotomized SO4 1yr Pre-Sampling vs %5mC
```{r}
dnamb <- dnam %>% filter(!is.na(SO41yrSamp_dich))
(dnamb %>% ggplot(aes(x=SO41yrSamp_dich, y=pct_5mC, fill=SO41yrSamp_dich))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="SO4 1yr Pre-Sampling Low vs High", y="% 5mC", title="% 5mC by Dichotomized SO4 1yr Pre-Sampling")+
    theme_light()+
    theme(legend.position = "none", plot.title = element_text(hjust = 0.5))+
    ylim(0,0.25))
```
pct_5mC appears slightly higher in the high SO41yrSamp_dich exposure group.

Violin plot wrapping boxplot to visualize Dichotomized SO4 6mo Pre-Sampling vs %5mC
```{r}
dnamb <- dnam %>% filter(!is.na(SO46moSamp_dich))
(dnamb %>% ggplot(aes(x=SO46moSamp_dich, y=pct_5mC, fill=SO46moSamp_dich))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="SO4 6mo Pre-Sampling Low vs High", y="% 5mC", title="% 5mC by Dichotomized SO4 6mo Pre-Sampling")+
    theme_light()+
    theme(legend.position = "none", plot.title = element_text(hjust = 0.5))+
    ylim(0,0.25))
```

Violin plot wrapping boxplot to visualize Dichotomized SO4 3mo Pre-Sampling vs %5mC
```{r}
dnamb <- dnam %>% filter(!is.na(SO43moSamp_dich))
(dnamb %>% ggplot(aes(x=SO43moSamp_dich, y=pct_5mC, fill=SO43moSamp_dich))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="SO4 3mo Pre-Sampling Low vs High", y="% 5mC", title="% 5mC by Dichotomized SO4 3mo Pre-Sampling")+
    theme_light()+
    theme(legend.position = "none", plot.title = element_text(hjust = 0.5))+
    ylim(0,0.25))
```

Violin plot wrapping boxplot to visualize Dichotomized SO4 1mo Pre-Sampling vs %5mC
```{r}
dnamb <- dnam %>% filter(!is.na(SO41moSamp_dich))
(dnamb %>% ggplot(aes(x=SO41moSamp_dich, y=pct_5mC, fill=SO41moSamp_dich))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="SO4 1mo Pre-Sampling Low vs High", y="% 5mC", title="% 5mC by Dichotomized SO4 1mo Pre-Sampling")+
    theme_light()+
    theme(legend.position = "none", plot.title = element_text(hjust = 0.5))+
    ylim(0,0.25))
```

### NO3
Violin plot wrapping boxplot to visualize Dichotomized NO3 5yrs Pre-Sampling vs %5mC
```{r}
dnamb <- dnam %>% filter(!is.na(NO35yrSamp_dich))
(dnamb %>% ggplot(aes(x=NO35yrSamp_dich, y=pct_5mC, fill=NO35yrSamp_dich))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="NO3 5yrs Pre-Sampling Low vs High", y="% 5mC", title="% 5mC by Dichotomized NO3 5yrs Pre-Sampling")+
    theme_light()+
    theme(legend.position = "none", plot.title = element_text(hjust = 0.5))+
    ylim(0,0.25))
```

Violin plot wrapping boxplot to visualize Dichotomized NO3 1yr Pre-Sampling vs %5mC
```{r}
dnamb <- dnam %>% filter(!is.na(NO31yrSamp_dich))
(dnamb %>% ggplot(aes(x=NO31yrSamp_dich, y=pct_5mC, fill=NO31yrSamp_dich))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="NO3 1yr Pre-Sampling Low vs High", y="% 5mC", title="% 5mC by Dichotomized NO3 1yr Pre-Sampling")+
    theme_light()+
    theme(legend.position = "none", plot.title = element_text(hjust = 0.5))+
    ylim(0,0.25))
```

Violin plot wrapping boxplot to visualize Dichotomized NO3 6mo Pre-Sampling vs %5mC
```{r}
dnamb <- dnam %>% filter(!is.na(NO36moSamp_dich))
(dnamb %>% ggplot(aes(x=NO36moSamp_dich, y=pct_5mC, fill=NO36moSamp_dich))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="NO3 6mo Pre-Sampling Low vs High", y="% 5mC", title="% 5mC by Dichotomized NO3 6mo Pre-Sampling")+
    theme_light()+
    theme(legend.position = "none", plot.title = element_text(hjust = 0.5))+
    ylim(0,0.25))
```

Violin plot wrapping boxplot to visualize Dichotomized NO3 3mo Pre-Sampling vs %5mC
```{r}
dnamb <- dnam %>% filter(!is.na(NO33moSamp_dich))
(dnamb %>% ggplot(aes(x=NO33moSamp_dich, y=pct_5mC, fill=NO33moSamp_dich))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="NO3 3mo Pre-Sampling Low vs High", y="% 5mC", title="% 5mC by Dichotomized NO3 3mo Pre-Sampling")+
    theme_light()+
    theme(legend.position = "none", plot.title = element_text(hjust = 0.5))+
    ylim(0,0.25))
```

Violin plot wrapping boxplot to visualize Dichotomized NO3 1mo Pre-Sampling vs %5mC
```{r}
dnamb <- dnam %>% filter(!is.na(NO31moSamp_dich))
(dnamb %>% ggplot(aes(x=NO31moSamp_dich, y=pct_5mC, fill=NO31moSamp_dich))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="NO3 1mo Pre-Sampling Low vs High", y="% 5mC", title="% 5mC by Dichotomized NO3 1mo Pre-Sampling")+
    theme_light()+
    theme(legend.position = "none", plot.title = element_text(hjust = 0.5))+
    ylim(0,0.25))
```

### NH4
Violin plot wrapping boxplot to visualize Dichotomized NH4 5yrs Pre-Sampling vs %5mC
```{r}
dnamb <- dnam %>% filter(!is.na(NH45yrSamp_dich))
(dnamb %>% ggplot(aes(x=NH45yrSamp_dich, y=pct_5mC, fill=NH45yrSamp_dich))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="NH4 5yrs Pre-Sampling Low vs High", y="% 5mC", title="% 5mC by Dichotomized NH4 5yrs Pre-Sampling")+
    theme_light()+
    theme(legend.position = "none", plot.title = element_text(hjust = 0.5))+
    ylim(0,0.25))
```
pct_5mC appears slightly higher in the high NH45yrSamp_dich exposure group.

Violin plot wrapping boxplot to visualize Dichotomized NH4 1yr Pre-Sampling vs %5mC
```{r}
dnamb <- dnam %>% filter(!is.na(NH41yrSamp_dich))
(dnamb %>% ggplot(aes(x=NH41yrSamp_dich, y=pct_5mC, fill=NH41yrSamp_dich))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="NH4 1yr Pre-Sampling Low vs High", y="% 5mC", title="% 5mC by Dichotomized NH4 1yr Pre-Sampling")+
    theme_light()+
    theme(legend.position = "none", plot.title = element_text(hjust = 0.5))+
    ylim(0,0.25))
```
pct_5mC appears slightly higher in the high NH41yrSamp_dich exposure group.

Violin plot wrapping boxplot to visualize Dichotomized NH4 6mo Pre-Sampling vs %5mC
```{r}
dnamb <- dnam %>% filter(!is.na(NH46moSamp_dich))
(dnamb %>% ggplot(aes(x=NH46moSamp_dich, y=pct_5mC, fill=NH46moSamp_dich))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="NH4 6mo Pre-Sampling Low vs High", y="% 5mC", title="% 5mC by Dichotomized NH4 6mo Pre-Sampling")+
    theme_light()+
    theme(legend.position = "none", plot.title = element_text(hjust = 0.5))+
    ylim(0,0.25))
```

Violin plot wrapping boxplot to visualize Dichotomized NH4 3mo Pre-Sampling vs %5mC
```{r}
dnamb <- dnam %>% filter(!is.na(NH43moSamp_dich))
(dnamb %>% ggplot(aes(x=NH43moSamp_dich, y=pct_5mC, fill=NH43moSamp_dich))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="NH4 3mo Pre-Sampling Low vs High", y="% 5mC", title="% 5mC by Dichotomized NH4 3mo Pre-Sampling")+
    theme_light()+
    theme(legend.position = "none", plot.title = element_text(hjust = 0.5))+
    ylim(0,0.25))
```
pct_5mC appears slightly higher in the high NH41yrSamp_dich exposure group.

Violin plot wrapping boxplot to visualize Dichotomized NH4 1mo Pre-Sampling vs %5mC
```{r}
dnamb <- dnam %>% filter(!is.na(NH41moSamp_dich))
(dnamb %>% ggplot(aes(x=NH41moSamp_dich, y=pct_5mC, fill=NH41moSamp_dich))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="NH4 1mo Pre-Sampling Low vs High", y="% 5mC", title="% 5mC by Dichotomized NH4 1mo Pre-Sampling")+
    theme_light()+
    theme(legend.position = "none", plot.title = element_text(hjust = 0.5))+
    ylim(0,0.25))
```

### BC
Violin plot wrapping boxplot to visualize Dichotomized BC 5yrs Pre-Sampling vs %5mC
```{r}
dnamb <- dnam %>% filter(!is.na(BC5yrSamp_dich))
(dnamb %>% ggplot(aes(x=BC5yrSamp_dich, y=pct_5mC, fill=BC5yrSamp_dich))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="BC 5yrs Pre-Sampling Low vs High", y="% 5mC", title="% 5mC by Dichotomized BC 5yrs Pre-Sampling")+
    theme_light()+
    theme(legend.position = "none", plot.title = element_text(hjust = 0.5))+
    ylim(0,0.25))
```

Violin plot wrapping boxplot to visualize Dichotomized BC 1yr Pre-Sampling vs %5mC
```{r}
dnamb <- dnam %>% filter(!is.na(BC1yrSamp_dich))
(dnamb %>% ggplot(aes(x=BC1yrSamp_dich, y=pct_5mC, fill=BC1yrSamp_dich))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="BC 1yr Pre-Sampling Low vs High", y="% 5mC", title="% 5mC by Dichotomized BC 1yr Pre-Sampling")+
    theme_light()+
    theme(legend.position = "none", plot.title = element_text(hjust = 0.5))+
    ylim(0,0.25))
```

Violin plot wrapping boxplot to visualize Dichotomized BC 6mo Pre-Sampling vs %5mC
```{r}
dnamb <- dnam %>% filter(!is.na(BC6moSamp_dich))
(dnamb %>% ggplot(aes(x=BC6moSamp_dich, y=pct_5mC, fill=BC6moSamp_dich))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="BC 6mo Pre-Sampling Low vs High", y="% 5mC", title="% 5mC by Dichotomized BC 6mo Pre-Sampling")+
    theme_light()+
    theme(legend.position = "none", plot.title = element_text(hjust = 0.5))+
    ylim(0,0.25))
```

Violin plot wrapping boxplot to visualize Dichotomized BC 3mo Pre-Sampling vs %5mC
```{r}
dnamb <- dnam %>% filter(!is.na(BC3moSamp_dich))
(dnamb %>% ggplot(aes(x=BC3moSamp_dich, y=pct_5mC, fill=BC3moSamp_dich))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="BC 3mo Pre-Sampling Low vs High", y="% 5mC", title="% 5mC by Dichotomized BC 3mo Pre-Sampling")+
    theme_light()+
    theme(legend.position = "none", plot.title = element_text(hjust = 0.5))+
    ylim(0,0.25))
```

Violin plot wrapping boxplot to visualize Dichotomized BC 1mo Pre-Sampling vs %5mC
```{r}
dnamb <- dnam %>% filter(!is.na(BC1moSamp_dich))
(dnamb %>% ggplot(aes(x=BC1moSamp_dich, y=pct_5mC, fill=BC1moSamp_dich))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="BC 1mo Pre-Sampling Low vs High", y="% 5mC", title="% 5mC by Dichotomized BC 1mo Pre-Sampling")+
    theme_light()+
    theme(legend.position = "none", plot.title = element_text(hjust = 0.5))+
    ylim(0,0.25))
```

### OM
Violin plot wrapping boxplot to visualize Dichotomized OM 5yrs Pre-Sampling vs %5mC
```{r}
dnamb <- dnam %>% filter(!is.na(OM5yrSamp_dich))
(dnamb %>% ggplot(aes(x=OM5yrSamp_dich, y=pct_5mC, fill=OM5yrSamp_dich))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="OM 5yrs Pre-Sampling Low vs High", y="% 5mC", title="% 5mC by Dichotomized OM 5yrs Pre-Sampling")+
    theme_light()+
    theme(legend.position = "none", plot.title = element_text(hjust = 0.5))+
    ylim(0,0.25))
```

Violin plot wrapping boxplot to visualize Dichotomized OM 1yr Pre-Sampling vs %5mC
```{r}
dnamb <- dnam %>% filter(!is.na(OM1yrSamp_dich))
(dnamb %>% ggplot(aes(x=OM1yrSamp_dich, y=pct_5mC, fill=OM1yrSamp_dich))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="OM 1yr Pre-Sampling Low vs High", y="% 5mC", title="% 5mC by Dichotomized OM 1yr Pre-Sampling")+
    theme_light()+
    theme(legend.position = "none", plot.title = element_text(hjust = 0.5))+
    ylim(0,0.25))
```

Violin plot wrapping boxplot to visualize Dichotomized OM 6mo Pre-Sampling vs %5mC
```{r}
dnamb <- dnam %>% filter(!is.na(OM6moSamp_dich))
(dnamb %>% ggplot(aes(x=OM6moSamp_dich, y=pct_5mC, fill=OM6moSamp_dich))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="OM 6mo Pre-Sampling Low vs High", y="% 5mC", title="% 5mC by Dichotomized OM 6mo Pre-Sampling")+
    theme_light()+
    theme(legend.position = "none", plot.title = element_text(hjust = 0.5))+
    ylim(0,0.25))
```

Violin plot wrapping boxplot to visualize Dichotomized OM 3mo Pre-Sampling vs %5mC
```{r}
dnamb <- dnam %>% filter(!is.na(OM3moSamp_dich))
(dnamb %>% ggplot(aes(x=OM3moSamp_dich, y=pct_5mC, fill=OM3moSamp_dich))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="OM 3mo Pre-Sampling Low vs High", y="% 5mC", title="% 5mC by Dichotomized OM 3mo Pre-Sampling")+
    theme_light()+
    theme(legend.position = "none", plot.title = element_text(hjust = 0.5))+
    ylim(0,0.25))
```

Violin plot wrapping boxplot to visualize Dichotomized OM 1mo Pre-Sampling vs %5mC
```{r}
dnamb <- dnam %>% filter(!is.na(OM1moSamp_dich))
(dnamb %>% ggplot(aes(x=OM1moSamp_dich, y=pct_5mC, fill=OM1moSamp_dich))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="OM 1mo Pre-Sampling Low vs High", y="% 5mC", title="% 5mC by Dichotomized OM 1mo Pre-Sampling")+
    theme_light()+
    theme(legend.position = "none", plot.title = element_text(hjust = 0.5))+
    ylim(0,0.25))
```

### SS
Violin plot wrapping boxplot to visualize Dichotomized SS 5yrs Pre-Sampling vs %5mC
```{r}
dnamb <- dnam %>% filter(!is.na(SS5yrSamp_dich))
(dnamb %>% ggplot(aes(x=SS5yrSamp_dich, y=pct_5mC, fill=SS5yrSamp_dich))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="SS 5yrs Pre-Sampling Low vs High", y="% 5mC", title="% 5mC by Dichotomized SS 5yrs Pre-Sampling")+
    theme_light()+
    theme(legend.position = "none", plot.title = element_text(hjust = 0.5))+
    ylim(0,0.25))
```

Violin plot wrapping boxplot to visualize Dichotomized SS 1yr Pre-Sampling vs %5mC
```{r}
dnamb <- dnam %>% filter(!is.na(SS1yrSamp_dich))
(dnamb %>% ggplot(aes(x=SS1yrSamp_dich, y=pct_5mC, fill=SS1yrSamp_dich))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="SS 1yr Pre-Sampling Low vs High", y="% 5mC", title="% 5mC by Dichotomized SS 1yr Pre-Sampling")+
    theme_light()+
    theme(legend.position = "none", plot.title = element_text(hjust = 0.5))+
    ylim(0,0.25))
```

Violin plot wrapping boxplot to visualize Dichotomized SS 6mo Pre-Sampling vs %5mC
```{r}
dnamb <- dnam %>% filter(!is.na(SS6moSamp_dich))
(dnamb %>% ggplot(aes(x=SS6moSamp_dich, y=pct_5mC, fill=SS6moSamp_dich))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="SS 6mo Pre-Sampling Low vs High", y="% 5mC", title="% 5mC by Dichotomized SS 6mo Pre-Sampling")+
    theme_light()+
    theme(legend.position = "none", plot.title = element_text(hjust = 0.5))+
    ylim(0,0.25))
```

Violin plot wrapping boxplot to visualize Dichotomized SS 3mo Pre-Sampling vs %5mC
```{r}
dnamb <- dnam %>% filter(!is.na(SS3moSamp_dich))
(dnamb %>% ggplot(aes(x=SS3moSamp_dich, y=pct_5mC, fill=SS3moSamp_dich))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="SS 3mo Pre-Sampling Low vs High", y="% 5mC", title="% 5mC by Dichotomized SS 3mo Pre-Sampling")+
    theme_light()+
    theme(legend.position = "none", plot.title = element_text(hjust = 0.5))+
    ylim(0,0.25))
```

Violin plot wrapping boxplot to visualize Dichotomized SS 1mo Pre-Sampling vs %5mC
```{r}
dnamb <- dnam %>% filter(!is.na(SS1moSamp_dich))
(dnamb %>% ggplot(aes(x=SS1moSamp_dich, y=pct_5mC, fill=SS1moSamp_dich))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="SS 1mo Pre-Sampling Low vs High", y="% 5mC", title="% 5mC by Dichotomized SS 1mo Pre-Sampling")+
    theme_light()+
    theme(legend.position = "none", plot.title = element_text(hjust = 0.5))+
    ylim(0,0.25))
```

### Soil
Violin plot wrapping boxplot to visualize Dichotomized Soil 5yrs Pre-Sampling vs %5mC
```{r}
dnamb <- dnam %>% filter(!is.na(Soil5yrSamp_dich))
(dnamb %>% ggplot(aes(x=Soil5yrSamp_dich, y=pct_5mC, fill=Soil5yrSamp_dich))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="Soil 5yrs Pre-Sampling Low vs High", y="% 5mC", title="% 5mC by Dichotomized Soil 5yrs Pre-Sampling")+
    theme_light()+
    theme(legend.position = "none", plot.title = element_text(hjust = 0.5))+
    ylim(0,0.25))
```

Violin plot wrapping boxplot to visualize Dichotomized Soil 1yr Pre-Sampling vs %5mC
```{r}
dnamb <- dnam %>% filter(!is.na(Soil1yrSamp_dich))
(dnamb %>% ggplot(aes(x=Soil1yrSamp_dich, y=pct_5mC, fill=Soil1yrSamp_dich))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="Soil 1yr Pre-Sampling Low vs High", y="% 5mC", title="% 5mC by Dichotomized Soil 1yr Pre-Sampling")+
    theme_light()+
    theme(legend.position = "none", plot.title = element_text(hjust = 0.5))+
    ylim(0,0.25))
```

Violin plot wrapping boxplot to visualize Dichotomized Soil 6mo Pre-Sampling vs %5mC
```{r}
dnamb <- dnam %>% filter(!is.na(Soil6moSamp_dich))
(dnamb %>% ggplot(aes(x=Soil6moSamp_dich, y=pct_5mC, fill=Soil6moSamp_dich))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="Soil 6mo Pre-Sampling Low vs High", y="% 5mC", title="% 5mC by Dichotomized Soil 6mo Pre-Sampling")+
    theme_light()+
    theme(legend.position = "none", plot.title = element_text(hjust = 0.5))+
    ylim(0,0.25))
```

Violin plot wrapping boxplot to visualize Dichotomized Soil 3mo Pre-Sampling vs %5mC
```{r}
dnamb <- dnam %>% filter(!is.na(Soil3moSamp_dich))
(dnamb %>% ggplot(aes(x=Soil3moSamp_dich, y=pct_5mC, fill=Soil3moSamp_dich))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="Soil 3mo Pre-Sampling Low vs High", y="% 5mC", title="% 5mC by Dichotomized Soil 3mo Pre-Sampling")+
    theme_light()+
    theme(legend.position = "none", plot.title = element_text(hjust = 0.5))+
    ylim(0,0.25))
```

Violin plot wrapping boxplot to visualize Dichotomized Soil 1mo Pre-Sampling vs %5mC
```{r}
dnamb <- dnam %>% filter(!is.na(Soil1moSamp_dich))
(dnamb %>% ggplot(aes(x=Soil1moSamp_dich, y=pct_5mC, fill=Soil1moSamp_dich))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="Soil 1mo Pre-Sampling Low vs High", y="% 5mC", title="% 5mC by Dichotomized Soil 1mo Pre-Sampling")+
    theme_light()+
    theme(legend.position = "none", plot.title = element_text(hjust = 0.5))+
    ylim(0,0.25))
```

# Violin Plots of DNAm and PM2.5/Constituents by Region/Site
## 5mC
```{r}
dnamb <- dnam %>% filter(!is.na(region))
(dnamb %>% ggplot(aes(x=region, y=pct_5mC, fill=region))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="Region of U.S.", y="% 5mC", title="% 5mC by Region")+
    theme_light()+
    theme(legend.position = "none", plot.title = element_text(hjust = 0.5))+
    ylim(0.05,0.25))
```
Fairly similar %5mC by region

```{r, height=8, width=20}
dnamb <- dnam %>% filter(!is.na(site))
(dnamb %>% ggplot(aes(x=site, y=pct_5mC, fill=site))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="PFF Site", y="% 5mC", title="% 5mC by PFF Site")+
    theme_light()+
    theme(plot.title = element_text(hjust = 0.5))+
    ylim(0.05,0.25))
```

## PM2.5
```{r}
dnamb <- dnam %>% filter(!is.na(region))
(dnamb %>% ggplot(aes(x=region, y=PM_5yrPreSamp, fill=region))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="Region of U.S.", y="PM2.5 in 5yrs Pre-Sampling", title="PM2.5 in 5yrs Pre-Sampling by Region")+
    theme_light()+
    theme(legend.position = "none", plot.title = element_text(hjust = 0.5)))
```

## SO4
```{r}
dnamb <- dnam %>% filter(!is.na(region))
(dnamb %>% ggplot(aes(x=region, y=SO4_5yrPreSamp, fill=region))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="Region of U.S.", y="SO4 in 5yrs Pre-Sampling", title="SO4 in 5yrs Pre-Sampling by Region")+
    theme_light()+
    theme(legend.position = "none", plot.title = element_text(hjust = 0.5)))
```

## NO3
```{r}
dnamb <- dnam %>% filter(!is.na(region))
(dnamb %>% ggplot(aes(x=region, y=NO3_5yrPreSamp, fill=region))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="Region of U.S.", y="NO3 in 5yrs Pre-Sampling", title="NO3 in 5yrs Pre-Sampling by Region")+
    theme_light()+
    theme(legend.position = "none", plot.title = element_text(hjust = 0.5)))
```

## NH4
```{r}
dnamb <- dnam %>% filter(!is.na(region))
(dnamb %>% ggplot(aes(x=region, y=NH4_5yrPreSamp, fill=region))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="Region of U.S.", y="NH4 in 5yrs Pre-Sampling", title="NH4 in 5yrs Pre-Sampling by Region")+
    theme_light()+
    theme(legend.position = "none", plot.title = element_text(hjust = 0.5)))
```


## BC
```{r}
dnamb <- dnam %>% filter(!is.na(region))
(dnamb %>% ggplot(aes(x=region, y=BC_5yrPreSamp, fill=region))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="Region of U.S.", y="BC in 5yrs Pre-Sampling", title="BC in 5yrs Pre-Sampling by Region")+
    theme_light()+
    theme(legend.position = "none", plot.title = element_text(hjust = 0.5)))
```


## OM
```{r}
dnamb <- dnam %>% filter(!is.na(region))
(dnamb %>% ggplot(aes(x=region, y=OM_5yrPreSamp, fill=region))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="Region of U.S.", y="OM in 5yrs Pre-Sampling", title="OM in 5yrs Pre-Sampling by Region")+
    theme_light()+
    theme(legend.position = "none", plot.title = element_text(hjust = 0.5)))
```


## SS
```{r}
dnamb <- dnam %>% filter(!is.na(region))
(dnamb %>% ggplot(aes(x=region, y=SS_5yrPreSamp, fill=region))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="Region of U.S.", y="SS in 5yrs Pre-Sampling", title="SS in 5yrs Pre-Sampling by Region")+
    theme_light()+
    theme(legend.position = "none", plot.title = element_text(hjust = 0.5)))
```


## Soil
```{r}
dnamb <- dnam %>% filter(!is.na(region))
(dnamb %>% ggplot(aes(x=region, y=Soil_5yrPreSamp, fill=region))+
    geom_boxplot(width=0.2, color="black", alpha=1.0)+
    geom_violin(width=1.0, alpha=0.5)+
    labs(x="Region of U.S.", y="Soil in 5yrs Pre-Sampling", title="Soil in 5yrs Pre-Sampling by Region")+
    theme_light()+
    theme(legend.position = "none", plot.title = element_text(hjust = 0.5)))
```

# Linear Regression Analyses
## PM2.5 Models
###Continuous PM2.5 5yr Pre-Censor
```{r}
dnam_model1 <- betareg(prop_5mC ~ PM_5yrPreSamp, dnam)
summary(dnam_model1)
confint(dnam_model1)
```

Impact of sex on model
```{r}
dnam_model1 <- betareg(prop_5mC ~ PM_5yrPreSamp + sex, dnam)
summary(dnam_model1)
confint(dnam_model1)
```

Impact of age_dx on model
```{r}
dnam_model1 <- betareg(prop_5mC ~ PM_5yrPreSamp + age_dx, dnam)
summary(dnam_model1)
confint(dnam_model1)
```

Impact of smokeHx on model
```{r}
dnam_model1 <- betareg(prop_5mC ~ PM_5yrPreSamp + smokeHx, dnam)
summary(dnam_model1)
confint(dnam_model1)
```

Impact of race on model
```{r}
dnam_model1 <- betareg(prop_5mC ~ PM_5yrPreSamp + dich_Race, dnam)
summary(dnam_model1)
confint(dnam_model1)
```

Impact of urbanicity on model
```{r}
dnam_model1 <- betareg(prop_5mC ~ PM_5yrPreSamp + metro, dnam)
summary(dnam_model1)
confint(dnam_model1)
```

Impact of site on model
```{r}
dnam_model1 <- betareg(prop_5mC ~ PM_5yrPreSamp + site, dnam)
summary(dnam_model1)
confint(dnam_model1)
```
Including site as a covariate brings pct_5mC close to significance.

Partial model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ PM_5yrPreSamp + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between PM_5yrPreSamp and prop_5mC in this model.


Complete model including site
```{r}
dnam_model3 <- betareg(prop_5mC ~ PM_5yrPreSamp + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
No significant association between PM_5yrPreSamp and prop_5mC in this model.


### Dichotomized PM2.5 in 5yrs Pre-Sampling
Base Model
```{r}
dnam_model1 <- betareg(prop_5mC ~PM5yrSamp_dich, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between high PM2.5 and prop_5mC in this model.

Partial model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ PM5yrSamp_dich + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between PM5yrSamp_dich and prop_5mC in this model.


Complete model with age_dx, sex, smokeHx, site
```{r}
dnam_model3 <- betareg(prop_5mC ~ PM5yrSamp_dich + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
No significant association between PM5yrSamp_dich and prop_5mC in this model.


### Continuous PM2.5 1yr Pre-Sampling
```{r}
dnam_model1 <- betareg(prop_5mC ~ PM_1yrPreSamp, dnam)
summary(dnam_model1)
confint(dnam_model1)
```

Impact of sex on model
```{r}
dnam_model1 <- betareg(prop_5mC ~ PM_1yrPreSamp + sex, dnam)
summary(dnam_model1)
confint(dnam_model1)
```

Impact of age_dx on model
```{r}
dnam_model1 <- betareg(prop_5mC ~ PM_1yrPreSamp + age_dx, dnam)
summary(dnam_model1)
confint(dnam_model1)
```

Impact of smokeHx on model
```{r}
dnam_model1 <- betareg(prop_5mC ~ PM_1yrPreSamp + smokeHx, dnam)
summary(dnam_model1)
confint(dnam_model1)
```

Impact of race on model
```{r}
dnam_model1 <- betareg(prop_5mC ~ PM_1yrPreSamp + dich_Race, dnam)
summary(dnam_model1)
confint(dnam_model1)
```

Impact of urbanicity on model
```{r}
dnam_model1 <- betareg(prop_5mC ~ PM_1yrPreSamp + metro, dnam)
summary(dnam_model1)
confint(dnam_model1)
```


Partial model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ PM_1yrPreSamp + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between PM_1yrPreSamp and prop_5mC in this model.


Complete model including site
```{r}
dnam_model3 <- betareg(prop_5mC ~ PM_1yrPreSamp + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
No significant association between PM_1yrPreSamp and prop_5mC in this model, but including site as a covariate brings the model close to significance.


### Dichotomized PM2.5 in 1yr Pre-Sampling
Base Model
```{r}
dnam_model1 <- betareg(prop_5mC ~PM1yrSamp_dich, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between high PM2.5 and prop_5mC in this model.

Partial model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ PM1yrSamp_dich + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between PM1yrSamp_dich and prop_5mC in this model.


Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ PM1yrSamp_dich + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
No significant association between PM1yrSamp_dich and prop_5mC in this model.




### Continuous PM2.5 6mo Pre-Sample
```{r}
dnam_model1 <- betareg(prop_5mC ~ PM_6moPreSamp, dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between PM_6moPreSamp and prop_5mC in this model.

Partial model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ PM_6moPreSamp + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between PM_6moPreSamp and prop_5mC in this model.


Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ PM_6moPreSamp + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
No significant association between PM_6moPreSamp and prop_5mC in this model.


### Dichotomized PM2.5 in 6mo Pre-Sampling
Base Model
```{r}
dnam_model1 <- betareg(prop_5mC ~PM6moSamp_dich, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between high PM2.5 and prop_5mC in this model.

Partial model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ PM6moSamp_dich + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between PM6moSamp_dich and prop_5mC in this model.


Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ PM6moSamp_dich + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
No significant association between PM6moSamp_dich and prop_5mC in this model.


### Continuous PM2.5 3mo Pre-Sample
```{r}
dnam_model1 <- betareg(prop_5mC ~ PM_3moPreSamp, dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between PM_3moPreSamp and prop_5mC in this model.

Partial model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ PM_3moPreSamp + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between PM_3moPreSamp and prop_5mC in this model.


Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ PM_3moPreSamp + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
No significant association between PM_3moPreSamp and prop_5mC in this model.

### Dichotomized PM2.5 in 3mo Pre-Sampling
Base Model
```{r}
dnam_model1 <- betareg(prop_5mC ~PM3moSamp_dich, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between high PM2.5 and prop_5mC in this model.

Partial model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ PM3moSamp_dich + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between PM3moSamp_dich and prop_5mC in this model.


Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ PM3moSamp_dich + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
No significant association between PM3moSamp_dich and prop_5mC in this model.


### Continuous PM2.5 1mo Pre-Sample
```{r}
dnam_model1 <- betareg(prop_5mC ~ PM_1moPreSamp, dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between PM_1moPreSamp and prop_5mC in this model.

Partial model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ PM_1moPreSamp + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between PM_1moPreSamp and prop_5mC in this model.


Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ PM_1moPreSamp + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
No significant association between PM_1moPreSamp and prop_5mC in this model.

### Dichotomized PM2.5 in 1mo Pre-Sampling
Base Model
```{r}
dnam_model1 <- betareg(prop_5mC ~PM1moSamp_dich, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between high PM2.5 and prop_5mC in this model.

Partial model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ PM1moSamp_dich + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between PM1moSamp_dich and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ PM1moSamp_dich + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
No significant association between PM1moSamp_dich and prop_5mC in this model.



## SO4 Models
### Continuous SO4 in 5yrs Pre-Sampling
Unadjusted model
```{r}
dnam_model1 <- betareg(prop_5mC ~ SO4_5yrPreSamp, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between SO4_5yrPreSamp and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ SO4_5yrPreSamp + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between SO4_5yrPreSamp and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ SO4_5yrPreSamp + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
No sig assoc between SO4 and prop_5mC in this model.

### Dichotomized SO4 in 5yrs Pre-Sampling
Unadjusted Model
```{r}
dnam_model1 <- betareg(prop_5mC ~SO45yrSamp_dich, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between SO45yrSamp_dich and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ SO45yrSamp_dich + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between SO45yrSamp_dich and prop_5mC in this model.


Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ SO45yrSamp_dich + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
No sig assoc between SO4 and prop_5mC in this model.

### Continuous SO4 in 1yrs Pre-Sampling
Unadjusted model
```{r}
dnam_model1 <- betareg(prop_5mC ~ SO4_1yrPreSamp, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between SO4_1yrPreSamp and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ SO4_1yrPreSamp + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between SO4_1yrPreSamp and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ SO4_1yrPreSamp + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
**Sig assoc between higher SO4 and incr prop_5mC in this model.**

### Dichotomized SO4 in 1yr Pre-Sampling
Unadjusted Model
```{r}
dnam_model1 <- betareg(prop_5mC ~SO41yrSamp_dich, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between SO41yrSamp_dich and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ SO41yrSamp_dich + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between SO41yrSamp_dich and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ SO41yrSamp_dich + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
No sig assoc between SO4 and prop_5mC in this model.


### Continuous SO4 in 6mo Pre-Sampling
Unadjusted model
```{r}
dnam_model1 <- betareg(prop_5mC ~ SO4_6moPreSamp, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between SO4_6moPreSamp and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ SO4_6moPreSamp + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between SO4_6moPreSamp and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ SO4_6moPreSamp + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```

### Dichotomized SO4 in 6mo Pre-Sampling
Unadjusted Model
```{r}
dnam_model1 <- betareg(prop_5mC ~SO46moSamp_dich, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between SO46moSamp_dich and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ SO46moSamp_dich + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between SO46moSamp_dich and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ SO46moSamp_dich + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```

### Continuous SO4 in 3mo Pre-Sampling
Unadjusted model
```{r}
dnam_model1 <- betareg(prop_5mC ~ SO4_3moPreSamp, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between SO4_3moPreSamp and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ SO4_3moPreSamp + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between SO4_3moPreSamp and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ SO4_3moPreSamp + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```

### Dichotomized SO4 in 3mo Pre-Sampling
Unadjusted Model
```{r}
dnam_model1 <- betareg(prop_5mC ~SO43moSamp_dich, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between SO43moSamp_dich and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ SO43moSamp_dich + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between SO43moSamp_dich and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ SO43moSamp_dich + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```


### Continuous SO4 in 1mo Pre-Sampling
Unadjusted model
```{r}
dnam_model1 <- betareg(prop_5mC ~ SO4_1moPreSamp, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between SO4_1moPreSamp and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ SO4_1moPreSamp + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between SO4_1moPreSamp and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ SO4_1moPreSamp + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```

### Dichotomized SO4 in 1mo Pre-Sampling
Unadjusted Model
```{r}
dnam_model1 <- betareg(prop_5mC ~SO41moSamp_dich, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between SO41moSamp_dich and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ SO41moSamp_dich + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between SO41moSamp_dich and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ SO41moSamp_dich + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```

## NO3 Models
### Continuous NO3 in 5yrs Pre-Sampling
Unadjusted model
```{r}
dnam_model1 <- betareg(prop_5mC ~ NO3_5yrPreSamp, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
*Nitrate is marginally associated with higher global DNAm in this base model.*

Adjuted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ NO3_5yrPreSamp + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
*Nitrate is marginally associated with higher global DNAm in this model.*

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ NO3_5yrPreSamp + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
*Nitrate is marginally associated with higher global DNAm in this model.*

### Dichotomized NO3 in 5yrs Pre-Sampling
Unadjusted Model
```{r}
dnam_model1 <- betareg(prop_5mC ~NO35yrSamp_dich, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
*Marginal association between high NO35yrSamp_dich and prop_5mC in this model.*

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ NO35yrSamp_dich + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
*Marginal association between high NO35yrSamp_dich and prop_5mC in this model.*

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ NO35yrSamp_dich + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
Nitrate is not associated with higher global DNAm in this model.


### Continuous NO3 in 1yrs Pre-Sampling
Unadjusted model
```{r}
dnam_model1 <- betareg(prop_5mC ~ NO3_1yrPreSamp, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
**Higher nitrate is associated with higher global DNAm in this model.**

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ NO3_1yrPreSamp + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
**Higher nitrate is associated with higher global DNAm in this model.**

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ NO3_1yrPreSamp + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
**Higher nitrate is associated with higher global DNAm in this model.**


### Dichotomized NO3 in 1yr Pre-Sampling
Unadjusted Model
```{r}
dnam_model1 <- betareg(prop_5mC ~NO31yrSamp_dich, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
**Significant association between high NO31yrSamp_dich and prop_5mC in this model.**

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ NO31yrSamp_dich + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
*Marginal association between NO31yrSamp_dich and prop_5mC in this model.*

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ NO31yrSamp_dich + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
Higher nitrate is not associated with global DNAm in this model.


### Continuous NO3 in 6mo Pre-Sampling
Unadjusted model
```{r}
dnam_model1 <- betareg(prop_5mC ~ NO3_6moPreSamp, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No assoc of nitrate with global DNAm in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ NO3_6moPreSamp + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No assoc of nitrate with global DNAm in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ NO3_6moPreSamp + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
No assoc of nitrate with global DNAm in this model.

### Dichotomized NO3 in 6mo Pre-Sampling
Unadjusted Model
```{r}
dnam_model1 <- betareg(prop_5mC ~NO36moSamp_dich, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between NO36moSamp_dich and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ NO36moSamp_dich + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between NO36moSamp_dich and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ NO36moSamp_dich + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
No assoc of nitrate with global DNAm in this model.


### Continuous NO3 in 3mo Pre-Sampling
Unadjusted model
```{r}
dnam_model1 <- betareg(prop_5mC ~ NO3_3moPreSamp, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No association between nitrate and global DNAm in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ NO3_3moPreSamp + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No association between nitrate and global DNAm in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ NO3_3moPreSamp + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
No assoc of nitrate with global DNAm in this model.


### Dichotomized NO3 in 3mo Pre-Sampling
Unadjusted Model
```{r}
dnam_model1 <- betareg(prop_5mC ~NO33moSamp_dich, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between NO33moSamp_dich and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ NO33moSamp_dich + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between NO33moSamp_dich and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ NO33moSamp_dich + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
No assoc of nitrate with global DNAm in this model.


### Continuous NO3 in 1mo Pre-Sampling
Unadjusted model
```{r}
dnam_model1 <- betareg(prop_5mC ~ NO3_1moPreSamp, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No association between nitrate and global DNAm in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ NO3_1moPreSamp + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No association between nitrate and global DNAm in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ NO3_1moPreSamp + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
No assoc of nitrate with global DNAm in this model.

### Dichotomized NO3 in 1mo Pre-Sampling
Unadjusted Model
```{r}
dnam_model1 <- betareg(prop_5mC ~NO31moSamp_dich, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between NO31moSamp_dich and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ NO31moSamp_dich + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between NO31moSamp_dich and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ NO31moSamp_dich + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
No assoc of nitrate with global DNAm in this model.


## NH4 Models
### Continuous NH4 in 5yrs Pre-Sampling
Unadjusted model
```{r}
dnam_model1 <- betareg(prop_5mC ~ NH4_5yrPreSamp, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
*Higher NH4 marginally associated with higher global DNAm in this model.*

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ NH4_5yrPreSamp + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
*Higher NH4 marginally associated with higher global DNAm in this model.*

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ NH4_5yrPreSamp + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
*Higher NH4 marginally associated with higher global DNAm in this model.*

### Dichotomized NH4 in 5yrs Pre-Sampling
Unadjusted Model
```{r}
dnam_model1 <- betareg(prop_5mC ~NH45yrSamp_dich, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
**Significant association between high NH45yrSamp_dich and increased prop_5mC in this model.**

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ NH45yrSamp_dich + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
**Significant association between high NH45yrSamp_dich and increased prop_5mC in this model.**

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ NH45yrSamp_dich + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
**Significant association between high NH45yrSamp_dich and increased prop_5mC in this model.**


### Continuous NH4 in 1yrs Pre-Sampling
Unadjusted model
```{r}
dnam_model1 <- betareg(prop_5mC ~ NH4_1yrPreSamp, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
*Higher NH4 marginally associated with higher global DNAm in this model.*

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ NH4_1yrPreSamp + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
*Higher NH4 marginally associated with higher global DNAm in this model.*

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ NH4_1yrPreSamp + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
**Higher NH4 associated with higher global DNAm in this model.**

### Dichotomized NH4 in 1yr Pre-Sampling
Unadjusted Model
```{r}
dnam_model1 <- betareg(prop_5mC ~NH41yrSamp_dich, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
**Significant association between high NH41yrSamp_dich and increased prop_5mC in this model.**

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ NH41yrSamp_dich + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
**Significant association between high NH41yrSamp_dich and increased prop_5mC in this model.**

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ NH41yrSamp_dich + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
**Significant association between high NH41yrSamp_dich and increased prop_5mC in this model.**


### Continuous NH4 in 6mo Pre-Sampling
Unadjusted model
```{r}
dnam_model1 <- betareg(prop_5mC ~ NH4_6moPreSamp, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
Higher NH4 not associated with global DNAm in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ NH4_6moPreSamp + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
Higher NH4 not associated with global DNAm in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ NH4_6moPreSamp + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
Higher NH4 not associated with global DNAm in this model.

### Dichotomized NH4 in 6mo Pre-Sampling
Unadjusted Model
```{r}
dnam_model1 <- betareg(prop_5mC ~NH46moSamp_dich, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between NH46moSamp_dich and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ NH46moSamp_dich + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between NH46moSamp_dich and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ NH46moSamp_dich + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
Higher NH4 not associated with global DNAm in this model.


### Continuous NH4 in 3mo Pre-Sampling
Unadjusted model
```{r}
dnam_model1 <- betareg(prop_5mC ~ NH4_3moPreSamp, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
Higher NH4 not associated with global DNAm in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ NH4_3moPreSamp + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
Higher NH4 not associated with global DNAm in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ NH4_3moPreSamp + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
Higher NH4 not associated with global DNAm in this model.


### Dichotomized NH4 in 3mo Pre-Sampling
Unadjusted Model
```{r}
dnam_model1 <- betareg(prop_5mC ~NH43moSamp_dich, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between NH43moSamp_dich and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ NH43moSamp_dich + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between NH43moSamp_dich and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ NH43moSamp_dich + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
Higher NH4 not associated with global DNAm in this model.


### Continuous NH4 in 1mo Pre-Sampling
Unadjusted model
```{r}
dnam_model1 <- betareg(prop_5mC ~ NH4_1moPreSamp, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
Higher NH4 not associated with global DNAm in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ NH4_1moPreSamp + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
Higher NH4 not associated with global DNAm in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ NH4_1moPreSamp + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
Higher NH4 not associated with global DNAm in this model.


### Dichotomized NH4 in 1mo Pre-Sampling
Unadjusted Model
```{r}
dnam_model1 <- betareg(prop_5mC ~NH41moSamp_dich, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between NH41moSamp_dich and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ NH41moSamp_dich + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between NH41moSamp_dich and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ NH41moSamp_dich + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
Higher NH4 not associated with global DNAm in this model.


## BC Models
### Continuous BC in 5yrs Pre-Sampling
Unadjusted model
```{r}
dnam_model1 <- betareg(prop_5mC ~ BC_5yrPreSamp, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between BC_5yrPreSamp and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ BC_5yrPreSamp + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between BC_5yrPreSamp and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ BC_5yrPreSamp + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
Higher BC not associated with global DNAm in this model.


### Dichotomized BC in 5yr Pre-Sampling
Unadjusted Model
```{r}
dnam_model1 <- betareg(prop_5mC ~BC5yrSamp_dich, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between BC5yrSamp_dich and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ BC5yrSamp_dich + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between BC5yrSamp_dich and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ BC5yrSamp_dich + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
Higher BC not associated with global DNAm in this model.


### Continuous BC in 1yrs Pre-Sampling
Unadjusted model
```{r}
dnam_model1 <- betareg(prop_5mC ~ BC_1yrPreSamp, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between BC_1yrPreSamp and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ BC_1yrPreSamp + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between BC_1yrPreSamp and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ BC_1yrPreSamp + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
Higher BC not associated with global DNAm in this model.

### Dichotomized BC in 1yr Pre-Sampling
Unadjusted Model
```{r}
dnam_model1 <- betareg(prop_5mC ~BC1yrSamp_dich, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between BC1yrSamp_dich and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ BC1yrSamp_dich + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between BC1yrSamp_dich and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ BC1yrSamp_dich + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
Higher BC not associated with global DNAm in this model.


### Continuous BC in 6mo Pre-Sampling
Unadjusted model
```{r}
dnam_model1 <- betareg(prop_5mC ~ BC_6moPreSamp, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between BC_6moPreSamp and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ BC_6moPreSamp + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between BC_6moPreSamp and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ BC_6moPreSamp + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
Higher BC not associated with global DNAm in this model.


### Dichotomized BC in 6mo Pre-Sampling
Unadjusted Model
```{r}
dnam_model1 <- betareg(prop_5mC ~BC6moSamp_dich, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between BC6moSamp_dich and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ BC6moSamp_dich + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between BC6moSamp_dich and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ BC6moSamp_dich + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
Higher BC not associated with global DNAm in this model.


### Continuous BC in 3mo Pre-Sampling
Unadjusted model
```{r}
dnam_model1 <- betareg(prop_5mC ~ BC_3moPreSamp, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between BC_3moPreSamp and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ BC_3moPreSamp + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between BC_3moPreSamp and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ BC_3moPreSamp + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
Higher BC not associated with global DNAm in this model.


### Dichotomized BC in 3mo Pre-Sampling
Unadjusted Model
```{r}
dnam_model1 <- betareg(prop_5mC ~BC3moSamp_dich, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between BC3moSamp_dich and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ BC3moSamp_dich + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between BC3moSamp_dich and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ BC3moSamp_dich + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
Higher BC not associated with global DNAm in this model.


### Continuous BC in 1mo Pre-Sampling
Unadjusted model
```{r}
dnam_model1 <- betareg(prop_5mC ~ BC_1moPreSamp, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between BC_1moPreSamp and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ BC_1moPreSamp + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between BC_1moPreSamp and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ BC_1moPreSamp + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
Higher BC not associated with global DNAm in this model.


### Dichotomized BC in 1mo Pre-Sampling
Unadjusted Model
```{r}
dnam_model1 <- betareg(prop_5mC ~BC1moSamp_dich, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between BC1moSamp_dich and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ BC1moSamp_dich + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between BC1moSamp_dich and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ BC1moSamp_dich + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
Higher BC not associated with global DNAm in this model.


## OM Models
### Continuous OM in 5yrs Pre-Sampling
Unadjusted model
```{r}
dnam_model1 <- betareg(prop_5mC ~ OM_5yrPreSamp, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between OM_5yrPreSamp and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ OM_5yrPreSamp + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between OM_5yrPreSamp and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ OM_5yrPreSamp + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
Higher OM not associated with global DNAm in this model.

### Dichotomized OM in 5yr Pre-Sampling
Unadjusted Model
```{r}
dnam_model1 <- betareg(prop_5mC ~OM5yrSamp_dich, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between OM5yrSamp_dich and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ OM5yrSamp_dich + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between OM5yrSamp_dich and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ OM5yrSamp_dich + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
Higher OM not associated with global DNAm in this model.


### Continuous OM in 1yrs Pre-Sampling
Unadjusted model
```{r}
dnam_model1 <- betareg(prop_5mC ~ OM_1yrPreSamp, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between OM_1yrPreSamp and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ OM_1yrPreSamp + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between OM_1yrPreSamp and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ OM_1yrPreSamp + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
Higher OM not associated with global DNAm in this model.

### Dichotomized OM in 1yr Pre-Sampling
Unadjusted Model
```{r}
dnam_model1 <- betareg(prop_5mC ~OM1yrSamp_dich, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between OM1yrSamp_dich and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ OM1yrSamp_dich + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between OM1yrSamp_dich and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ OM1yrSamp_dich + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
Higher OM not associated with global DNAm in this model.


### Continuous OM in 6mo Pre-Sampling
Unadjusted model
```{r}
dnam_model1 <- betareg(prop_5mC ~ OM_6moPreSamp, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between OM_6moPreSamp and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ OM_6moPreSamp + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between OM_6moPreSamp and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ OM_6moPreSamp + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
Higher OM not associated with global DNAm in this model.


### Dichotomized OM in 6mo Pre-Sampling
Unadjusted Model
```{r}
dnam_model1 <- betareg(prop_5mC ~OM6moSamp_dich, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between OM6moSamp_dich and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ OM6moSamp_dich + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between OM6moSamp_dich and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ OM6moSamp_dich + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
Higher OM not associated with global DNAm in this model.


### Continuous OM in 3mo Pre-Sampling
Unadjusted model
```{r}
dnam_model1 <- betareg(prop_5mC ~ OM_3moPreSamp, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between OM_3moPreSamp and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ OM_3moPreSamp + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between OM_3moPreSamp and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ OM_3moPreSamp + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
Higher OM not associated with global DNAm in this model.


### Dichotomized OM in 3mo Pre-Sampling
Unadjusted Model
```{r}
dnam_model1 <- betareg(prop_5mC ~OM3moSamp_dich, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between OM3moSamp_dich and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ OM3moSamp_dich + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between OM3moSamp_dich and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ OM3moSamp_dich + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
Higher OM not associated with global DNAm in this model.


### Continuous OM in 1mo Pre-Sampling
Unadjusted model
```{r}
dnam_model1 <- betareg(prop_5mC ~ OM_1moPreSamp, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between OM_1moPreSamp and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ OM_1moPreSamp + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between OM_1moPreSamp and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ OM_1moPreSamp + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
Higher OM not associated with global DNAm in this model.


### Dichotomized OM in 1mo Pre-Sampling
Unadjusted Model
```{r}
dnam_model1 <- betareg(prop_5mC ~OM1moSamp_dich, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between OM1moSamp_dich and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ OM1moSamp_dich + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between OM1moSamp_dich and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ OM1moSamp_dich + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
Higher OM not associated with global DNAm in this model.


## SS Models
### Continuous SS in 5yrs Pre-Sampling
Unadjusted model
```{r}
dnam_model1 <- betareg(prop_5mC ~ SS_5yrPreSamp, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between SS_5yrPreSamp and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ SS_5yrPreSamp + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between SS_5yrPreSamp and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ SS_5yrPreSamp + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
Higher OM not associated with global DNAm in this model.

### Dichotomized SS in 5yr Pre-Sampling
Unadjusted Model
```{r}
dnam_model1 <- betareg(prop_5mC ~SS5yrSamp_dich, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between SS5yrSamp_dich and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ SS5yrSamp_dich + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between SS5yrSamp_dich and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ SS5yrSamp_dich + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
Higher SS not associated with global DNAm in this model.


### Continuous SS in 1yrs Pre-Sampling
Unadjusted model
```{r}
dnam_model1 <- betareg(prop_5mC ~ SS_1yrPreSamp, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between SS_1yrPreSamp and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ SS_1yrPreSamp + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between SS_1yrPreSamp and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ SS_1yrPreSamp + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
Higher SS not associated with global DNAm in this model.


### Dichotomized SS in 1yr Pre-Sampling
Unadjusted Model
```{r}
dnam_model1 <- betareg(prop_5mC ~SS1yrSamp_dich, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between SS1yrSamp_dich and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ SS1yrSamp_dich + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between SS1yrSamp_dich and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ SS1yrSamp_dich + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
*Marginal assoc between higher SS and increased prop_5mC in this model.*

### Continuous SS in 6mo Pre-Sampling
Unadjusted model
```{r}
dnam_model1 <- betareg(prop_5mC ~ SS_6moPreSamp, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between SS_6moPreSamp and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ SS_6moPreSamp + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between SS_6moPreSamp and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ SS_6moPreSamp + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
**Sig assoc between higher SS and increased prop_5mC in this model.**

### Dichotomized SS in 6mo Pre-Sampling
Unadjusted Model
```{r}
dnam_model1 <- betareg(prop_5mC ~SS6moSamp_dich, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
*Marginal association between high SS6moSamp_dich and increased prop_5mC in this model.*

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ SS6moSamp_dich + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
*Marginal association between high SS6moSamp_dich and increased prop_5mC in this model.*

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ SS6moSamp_dich + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
**Sig association between high SS6moSamp_dich and increased prop_5mC in this model.**


### Continuous SS in 3mo Pre-Sampling
Unadjusted model
```{r}
dnam_model1 <- betareg(prop_5mC ~ SS_3moPreSamp, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between SS_3moPreSamp and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ SS_3moPreSamp + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between SS_3moPreSamp and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ SS_3moPreSamp + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
No significant association between SS and prop_5mC in this model.

### Dichotomized SS in 3mo Pre-Sampling
Unadjusted Model
```{r}
dnam_model1 <- betareg(prop_5mC ~SS3moSamp_dich, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between SS3moSamp_dich and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ SS3moSamp_dich + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between SS3moSamp_dich and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ SS3moSamp_dich + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
No significant association between SS and prop_5mC in this model.


### Continuous SS in 1mo Pre-Sampling
Unadjusted model
```{r}
dnam_model1 <- betareg(prop_5mC ~ SS_1moPreSamp, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between SS_1moPreSamp and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ SS_1moPreSamp + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between SS_1moPreSamp and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ SS_1moPreSamp + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
No significant association between SS and prop_5mC in this model.


### Dichotomized SS in 1mo Pre-Sampling
Unadjusted Model
```{r}
dnam_model1 <- betareg(prop_5mC ~SS1moSamp_dich, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between SS1moSamp_dich and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ SS1moSamp_dich + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between SS1moSamp_dich and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ SS1moSamp_dich + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
Model failed to run.

## Soil Models
### Continuous Soil in 5yrs Pre-Sampling
Unadjusted model
```{r}
dnam_model1 <- betareg(prop_5mC ~ Soil_5yrPreSamp, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between Soil_5yrPreSamp and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ Soil_5yrPreSamp + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between Soil_5yrPreSamp and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ Soil_5yrPreSamp + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
No significant association between Soil and prop_5mC in this model.

### Dichotomized Soil in 5yr Pre-Sampling
Unadjusted Model
```{r}
dnam_model1 <- betareg(prop_5mC ~Soil5yrSamp_dich, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between Soil5yrSamp_dich and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ Soil5yrSamp_dich + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between Soil5yrSamp_dich and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ Soil5yrSamp_dich + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
No significant association between Soil and prop_5mC in this model.


### Continuous Soil in 1yrs Pre-Sampling
Unadjusted model
```{r}
dnam_model1 <- betareg(prop_5mC ~ Soil_1yrPreSamp, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between Soil_1yrPreSamp and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ Soil_1yrPreSamp + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between Soil_1yrPreSamp and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ Soil_1yrPreSamp + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
No significant association between Soil and prop_5mC in this model.


### Dichotomized Soil in 1yr Pre-Sampling
Unadjusted Model
```{r}
dnam_model1 <- betareg(prop_5mC ~Soil1yrSamp_dich, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between Soil1yrSamp_dich and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ Soil1yrSamp_dich + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between Soil1yrSamp_dich and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ Soil1yrSamp_dich + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
No significant association between Soil and prop_5mC in this model.

### Continuous Soil in 6mo Pre-Sampling
Unadjusted model
```{r}
dnam_model1 <- betareg(prop_5mC ~ Soil_6moPreSamp, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between Soil_6moPreSamp and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ Soil_6moPreSamp + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between Soil_6moPreSamp and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ Soil_6moPreSamp + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
No significant association between Soil and prop_5mC in this model.

### Dichotomized Soil in 6mo Pre-Sampling
Unadjusted Model
```{r}
dnam_model1 <- betareg(prop_5mC ~Soil6moSamp_dich, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between Soil6moSamp_dich and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ Soil6moSamp_dich + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between Soil6moSamp_dich and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ Soil6moSamp_dich + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
No significant association between Soil and prop_5mC in this model.

### Continuous Soil in 3mo Pre-Sampling
Unadjusted model
```{r}
dnam_model1 <- betareg(prop_5mC ~ Soil_3moPreSamp, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between Soil_3moPreSamp and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ Soil_3moPreSamp + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between Soil_3moPreSamp and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ Soil_3moPreSamp + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
No significant association between Soil and prop_5mC in this model.

### Dichotomized Soil in 3mo Pre-Sampling
Unadjusted Model
```{r}
dnam_model1 <- betareg(prop_5mC ~Soil3moSamp_dich, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between Soil3moSamp_dich and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ Soil3moSamp_dich + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between Soil3moSamp_dich and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ Soil3moSamp_dich + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
*Marginal association between increased Soil and increased prop_5mC in this model.*

### Continuous Soil in 1mo Pre-Sampling
Unadjusted model
```{r}
dnam_model1 <- betareg(prop_5mC ~ Soil_1moPreSamp, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between Soil_1moPreSamp and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ Soil_1moPreSamp + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between Soil_1moPreSamp and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ Soil_1moPreSamp + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
No significant association between Soil and prop_5mC in this model.

### Dichotomized Soil in 1mo Pre-Sampling
Unadjusted Model
```{r}
dnam_model1 <- betareg(prop_5mC ~Soil1moSamp_dich, data=dnam)
summary(dnam_model1)
confint(dnam_model1)
```
No significant association between Soil1moSamp_dich and prop_5mC in this model.

Adjusted model with age_dx, sex, smokeHx
```{r}
dnam_model2 <- betareg(prop_5mC ~ Soil1moSamp_dich + sex + age_dx + smokeHx, data=dnam)
summary(dnam_model2)
confint(dnam_model2)
```
No significant association between Soil1moSamp_dich and prop_5mC in this model.

Complete model with site
```{r}
dnam_model3 <- betareg(prop_5mC ~ Soil1moSamp_dich + sex + age_dx + smokeHx + site, data=dnam)
summary(dnam_model3)
confint(dnam_model3)
```
No significant association between Soil and prop_5mC in this model.

# Impact of DNAm on Mortality
Base model
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ pct_5mC, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant association between %5mC and mortality in this model.

Partial Model
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ pct_5mC + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant association between %5mC and mortality in this model.

Complete Model
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant association between %5mC and mortality in this model.


Complete Model with site
```{r}
coxPH_model4 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model4)
```
Model failed to converge, but no significant association between %5mC and mortality in this model.

# Impact of PM2.5 on Mortality
## 5yr Pre-Sampling
```{r, fig.height=5, fig.width=7}
surv1 <- survfit(Surv(time_DeathTxCensor, deadORtx==1) ~PM5yrSamp_dich, data=dnam)
(ggsurvplot(surv1, 
            censor=TRUE,
            pval=TRUE,
            xlim=c(0,5),
            legend="right",
           data=dnam,
           legend.title="PM2.5 5yrs \nPre-Sampling",
           legend.labs=c("Low", "High"),
           risk.table=F,
           title="Time to Death or Transplant by Low vs High PM2.5 in 5yrs Pre-Sampling",
           xlab="Time from Diagnosis (years)",
           ylab="Survival Probability (Death or Lung Transplant)",
           ggtheme = theme_grey()
           ))
```

Base model with just PM2.5
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ PM_5yrPreSamp, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between PM2.5 in 5yrs pre-sampling and mortality in this model.

Base model with PM2.5 and pct_5mC
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ PM_5yrPreSamp + pct_5mC, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between PM2.5 in 5yrs pre-sampling and mortality in this model.

Partial Model with just PM2.5
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ PM_5yrPreSamp + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between PM2.5 in 5yrs pre-sampling and mortality in this model.

Partial Model with PM2.5 and pct_5mC
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ PM_5yrPreSamp + pct_5mC + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between PM2.5 in 5yrs pre-sampling and mortality in this model.

Complete Model with just PM2.5
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ PM_5yrPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between PM2.5 in 5yrs pre-sampling and mortality in this model.

Complete Model with PM2.5 and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ PM_5yrPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between PM2.5 in 5yrs pre-sampling and mortality in this model.

Complete Model + site with just PM2.5
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ PM_5yrPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
*Model failed to converge, but marginal assoc between incr PM_5yrPreSamp and increased mortality in this model.*

Complete Model + site with PM2.5 and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ PM_5yrPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
*Model failed to converge, but marginal assoc between incr PM_5yrPreSamp and increased mortality in this model with slight decrease HR with addition of pct_5mC indicating some degree of mediation.*


## 1yr Pre-Sampling
```{r, fig.height=5, fig.width=7}
surv1 <- survfit(Surv(time_DeathTxCensor, deadORtx==1) ~PM1yrSamp_dich, data=dnam)
(ggsurvplot(surv1, 
            censor=TRUE,
            pval=TRUE,
            xlim=c(0,5),
            legend="right",
           data=dnam,
           legend.title="PM2.5 1yr \nPre-Sampling",
           legend.labs=c("Low", "High"),
           risk.table=F,
           title="Time to Death or Transplant by Low vs High PM2.5 in 1yr Pre-Sampling",
           xlab="Time from Diagnosis (years)",
           ylab="Survival Probability (Death or Lung Transplant)",
           ggtheme = theme_grey()
           ))
```

Base model with just PM2.5
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ PM_1yrPreSamp, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between PM_1yrPreSamp and mortality in this model.

Base model with PM2.5 and pct_5mC
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ PM_1yrPreSamp + pct_5mC, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between PM_1yrPreSamp and mortality in this model.

Partial Model with just PM2.5
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ PM_1yrPreSamp + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between PM_1yrPreSamp and mortality in this model.

Partial Model with PM2.5 and pct_5mC
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ PM_1yrPreSamp + pct_5mC + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between PM_1yrPreSamp and mortality in this model.

Complete Model with just PM2.5
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ PM_1yrPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between PM_1yrPreSamp and mortality in this model.

Complete Model with PM2.5 and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ PM_1yrPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between PM_1yrPreSamp and mortality in this model.

Complete Model + site with just PM2.5
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ PM_1yrPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
**Model failed to converge, but significant assoc between incr PM_1yrPreSamp and incr mortality in this model.**


Complete Model + site with PM2.5 and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ PM_1yrPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
**Model failed to converge, but significant assoc between incr PM_1yrPreSamp and incr mortality in this model with HR decreasing slightly wiht addition of pct_5mC indicating some mediation.**



## 6mo Pre-Sampling
```{r, fig.height=5, fig.width=7}
surv1 <- survfit(Surv(time_DeathTxCensor, deadORtx==1) ~PM6moSamp_dich, data=dnam)
(ggsurvplot(surv1, 
            censor=TRUE,
            pval=TRUE,
            xlim=c(0,5),
            legend="right",
           data=dnam,
           legend.title="PM2.5 6mo \nPre-Sampling",
           legend.labs=c("Low", "High"),
           risk.table=F,
           title="Time to Death or Transplant by Low vs High PM2.5 in 6mo Pre-Sampling",
           xlab="Time from Diagnosis (years)",
           ylab="Survival Probability (Death or Lung Transplant)",
           ggtheme = theme_grey()
           ))
```


Base model with just PM2.5
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ PM_6moPreSamp, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between PM_6moPreSamp and mortality in this model.

Base model with PM2.5 and pct_5mC
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ PM_6moPreSamp + pct_5mC, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between PM_6moPreSamp and mortality in this model.

Partial Model with just PM2.5
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ PM_6moPreSamp + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between PM_6moPreSamp and mortality in this model.

Partial Model with PM2.5 and pct_5mC
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ PM_6moPreSamp + pct_5mC + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between PM_6moPreSamp and mortality in this model.

Complete Model with just PM2.5
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ PM_6moPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between PM_6moPreSamp and mortality in this model.

Complete Model with PM2.5 and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ PM_6moPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between PM_6moPreSamp and mortality in this model.

Complete Model + site with just PM2.5
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ PM_6moPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
**Model failed to converge, but significant assoc between incr PM_6moPreSamp and incr mortality in this model.**


Complete Model + site with PM2.5 and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ PM_6moPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
**Model failed to converge, but significant assoc between incr PM_6moPreSamp and incr mortality in this model with HR decreasing slightly with addition of pct_5mC indicating some degree of mediation.**


## 3mo Pre-Sampling
```{r, fig.height=5, fig.width=7}
surv1 <- survfit(Surv(time_DeathTxCensor, deadORtx==1) ~PM3moSamp_dich, data=dnam)
(ggsurvplot(surv1, 
            censor=TRUE,
            pval=TRUE,
            xlim=c(0,5),
            legend="right",
           data=dnam,
           legend.title="PM2.5 3mo \nPre-Sampling",
           legend.labs=c("Low", "High"),
           risk.table=F,
           title="Time to Death or Transplant by Low vs High PM2.5 in 3mo Pre-Sampling",
           xlab="Time from Diagnosis (years)",
           ylab="Survival Probability (Death or Lung Transplant)",
           ggtheme = theme_grey()
           ))
```


Base model with just PM2.5
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ PM_3moPreSamp, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between PM_3moPreSamp and mortality in this model.

Base model with PM2.5 and pct_5mC
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ PM_3moPreSamp + pct_5mC, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between PM_3moPreSamp and mortality in this model.

Partial Model with just PM2.5
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ PM_3moPreSamp + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between PM_3moPreSamp and mortality in this model.

Partial Model with PM2.5 and pct_5mC
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ PM_3moPreSamp + pct_5mC + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between PM_3moPreSamp and mortality in this model.

Complete Model with just PM2.5
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ PM_3moPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between PM_3moPreSamp and mortality in this model.

Complete Model with PM2.5 and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ PM_3moPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between PM_3moPreSamp and mortality in this model.

Complete Model + site with just PM2.5
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ PM_3moPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
**Model failed to converge, but significant assoc between incr PM_3moPreSamp and incr mortality in this model.**


Complete Model + site with PM2.5 and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ PM_3moPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
**Model failed to converge, but significant assoc between incr PM_3moPreSamp and incr mortality in this model,** but HR increases with pct_5mC indicating no mediation


## 1mo Pre-Sampling
```{r, fig.height=5, fig.width=7}
surv1 <- survfit(Surv(time_DeathTxCensor, deadORtx==1) ~PM1moSamp_dich, data=dnam)
(ggsurvplot(surv1, 
            censor=TRUE,
            pval=TRUE,
            xlim=c(0,5),
            legend="right",
           data=dnam,
           legend.title="PM2.5 1mo \nPre-Sampling",
           legend.labs=c("Low", "High"),
           risk.table=F,
           title="Time to Death or Transplant by Low vs High PM2.5 in 1mo Pre-Sampling",
           xlab="Time from Diagnosis (years)",
           ylab="Survival Probability (Death or Lung Transplant)",
           ggtheme = theme_grey()
           ))
```

Base model with just PM2.5
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ PM_1moPreSamp, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between PM_1moPreSamp and mortality in this model.

Base model with PM2.5 and pct_5mC
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ PM_1moPreSamp + pct_5mC, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between PM_1moPreSamp and mortality in this model.

Partial Model with just PM2.5
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ PM_1moPreSamp + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between PM_1moPreSamp and mortality in this model.

Partial Model with PM2.5 and pct_5mC
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ PM_1moPreSamp + pct_5mC + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between PM_1moPreSamp and mortality in this model.

Complete Model with just PM2.5
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ PM_1moPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between PM_1moPreSamp and mortality in this model.

Complete Model with PM2.5 and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ PM_1moPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between PM_1moPreSamp and mortality in this model.

Complete Model + site with just PM2.5
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ PM_1moPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
**Model failed to converge, but significant assoc between incr PM_1moPreSamp and incr mortality in this model.**


Complete Model + site with PM2.5 and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ PM_1moPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
**Model failed to converge, but significant assoc between incr PM_1moPreSamp and incr mortality in this model,** but HR increased with addition of pct_5mC indicating no mediation


# Impact of SO4 on Mortality
## 5yr Pre-Sampling
```{r, fig.height=5, fig.width=7}
surv1 <- survfit(Surv(time_DeathTxCensor, deadORtx==1) ~SO45yrSamp_dich, data=dnam)
(ggsurvplot(surv1, 
            censor=TRUE,
            pval=TRUE,
            xlim=c(0,5),
            legend="right",
           data=dnam,
           legend.title="SO4 5yrs \nPre-Sampling",
           legend.labs=c("Low", "High"),
           risk.table=F,
           title="Time to Death or Transplant by Low vs High SO4 in 5yrs Pre-Sampling",
           xlab="Time from Diagnosis (years)",
           ylab="Survival Probability (Death or Lung Transplant)",
           ggtheme = theme_grey()
           ))
```

Base model with just SO4
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SO4_5yrPreSamp, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between SO4 in 5yrs pre-sampling and mortality in this model.

Base model with SO4 and pct_5mC
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SO4_5yrPreSamp + pct_5mC, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between SO4 in 5yrs pre-sampling and mortality in this model.

Partial Model with just SO4
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SO4_5yrPreSamp + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between SO4 in 5yrs pre-sampling and mortality in this model.

Partial Model with SO4 and pct_5mC
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SO4_5yrPreSamp + pct_5mC + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between SO4 in 5yrs pre-sampling and mortality in this model.

Complete Model with just SO4
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SO4_5yrPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
**Significant assoc between increased SO4 in 5yrs pre-sampling and lower mortality in this model.**

Complete Model with SO4 and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SO4_5yrPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
**Significant assoc between increased SO4 in 5yrs pre-sampling and lower mortality in this model with HR lower with addition of pct_5mC indicating some mediation.**

Complete Model + site with just SO4_5yrPreSamp
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SO4_5yrPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
**Sig assoc between SO4_5yrPreSamp and increased mortality in this model.**

Complete Model + site with SO4_5yrPreSamp and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SO4_5yrPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
**Sig assoc between SO4_5yrPreSamp and increased mortality in this model with HR decreasing with addition of pct_5mC indicating some mediation.**


## 1yr Pre-Sampling
```{r, fig.height=5, fig.width=7}
surv1 <- survfit(Surv(time_DeathTxCensor, deadORtx==1) ~SO41yrSamp_dich, data=dnam)
(ggsurvplot(surv1, 
            censor=TRUE,
            pval=TRUE,
            xlim=c(0,5),
            legend="right",
           data=dnam,
           legend.title="SO4 1yr \nPre-Sampling",
           legend.labs=c("Low", "High"),
           risk.table=F,
           title="Time to Death or Transplant by Low vs High SO4 in 1yr Pre-Sampling",
           xlab="Time from Diagnosis (years)",
           ylab="Survival Probability (Death or Lung Transplant)",
           ggtheme = theme_grey()
           ))
```

Base model with just SO4
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SO4_1yrPreSamp, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between SO4_1yrPreSamp and mortality in this model.

Base model with SO4 and pct_5mC
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SO4_1yrPreSamp + pct_5mC, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between SO4_1yrPreSamp and mortality in this model.

Partial Model with just SO4
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SO4_1yrPreSamp + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between SO4_1yrPreSamp and mortality in this model.

Partial Model with SO4 and pct_5mC
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SO4_1yrPreSamp + pct_5mC + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between SO4_1yrPreSamp and mortality in this model.

Complete Model with just SO4
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SO4_1yrPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between SO4_1yrPreSamp and mortality in this model.

Complete Model with SO4 and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SO4_1yrPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between SO4_1yrPreSamp and mortality in this model.

Complete Model + site with just SO4_1yrPreSamp
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SO4_1yrPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
**Sig assoc between SO4_1yrPreSamp and increased mortality in this model.**


Complete Model + site with SO4_1yrPreSamp and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SO4_1yrPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
**Sig assoc between SO4_1yrPreSamp and increased mortality in this model, with HR decreasing with addition of pct_5mC indicating some mediaiton.**


## 6mo Pre-Sampling
```{r, fig.height=5, fig.width=7}
surv1 <- survfit(Surv(time_DeathTxCensor, deadORtx==1) ~SO46moSamp_dich, data=dnam)
(ggsurvplot(surv1, 
            censor=TRUE,
            pval=TRUE,
            xlim=c(0,5),
            legend="right",
           data=dnam,
           legend.title="SO4 6mo \nPre-Sampling",
           legend.labs=c("Low", "High"),
           risk.table=F,
           title="Time to Death or Transplant by Low vs High SO4 in 6mo Pre-Sampling",
           xlab="Time from Diagnosis (years)",
           ylab="Survival Probability (Death or Lung Transplant)",
           ggtheme = theme_grey()
           ))
```


Base model with just SO4
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SO4_6moPreSamp, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between SO4_6moPreSamp and mortality in this model.

Base model with SO4 and pct_5mC
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SO4_6moPreSamp + pct_5mC, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between SO4_6moPreSamp and mortality in this model.

Partial Model with just SO4
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SO4_6moPreSamp + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between SO4_6moPreSamp and mortality in this model.

Partial Model with SO4 and pct_5mC
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SO4_6moPreSamp + pct_5mC + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between SO4_6moPreSamp and mortality in this model.

Complete Model with just SO4
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SO4_6moPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between SO4_6moPreSamp and mortality in this model.

Complete Model with SO4 and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SO4_6moPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between SO4_6moPreSamp and mortality in this model.

Complete Model + site with just SO4_6moPreSamp
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SO4_6moPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
**Sig assoc between SO4_6moPreSamp and increased mortality in this model.**


Complete Model + site with SO4_6moPreSamp and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SO4_6moPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
**Sig assoc between SO4_6moPreSamp and increased mortality in this model, with HR decreasing with addition of pct_5mC indicating some mediaiton.**


## 3mo Pre-Sampling
```{r, fig.height=5, fig.width=7}
surv1 <- survfit(Surv(time_DeathTxCensor, deadORtx==1) ~SO43moSamp_dich, data=dnam)
(ggsurvplot(surv1, 
            censor=TRUE,
            pval=TRUE,
            xlim=c(0,5),
            legend="right",
           data=dnam,
           legend.title="SO4 3mo \nPre-Sampling",
           legend.labs=c("Low", "High"),
           risk.table=F,
           title="Time to Death or Transplant by Low vs High SO4 in 3mo Pre-Sampling",
           xlab="Time from Diagnosis (years)",
           ylab="Survival Probability (Death or Lung Transplant)",
           ggtheme = theme_grey()
           ))
```


Base model with just SO4
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SO4_3moPreSamp, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between SO4_3moPreSamp and mortality in this model.

Base model with SO4 and pct_5mC
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SO4_3moPreSamp + pct_5mC, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between SO4_3moPreSamp and mortality in this model.

Partial Model with just SO4
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SO4_3moPreSamp + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between SO4_3moPreSamp and mortality in this model.

Partial Model with SO4 and pct_5mC
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SO4_3moPreSamp + pct_5mC + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between SO4_3moPreSamp and mortality in this model.

Complete Model with just SO4
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SO4_3moPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between SO4_3moPreSamp and mortality in this model.

Complete Model with SO4 and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SO4_3moPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between SO4_3moPreSamp and mortality in this model.

Complete Model + site with just SO4_3moPreSamp
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SO4_3moPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
**Sig assoc between SO4_3moPreSamp and increased mortality in this model.**


Complete Model + site with SO4_3moPreSamp and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SO4_3moPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
**Sig assoc between SO4_3moPreSamp and increased mortality in this model, with HR decreasing with addition of pct_5mC indicating some mediaiton.**


## 1mo Pre-Sampling
```{r, fig.height=5, fig.width=7}
surv1 <- survfit(Surv(time_DeathTxCensor, deadORtx==1) ~SO41moSamp_dich, data=dnam)
(ggsurvplot(surv1, 
            censor=TRUE,
            pval=TRUE,
            xlim=c(0,5),
            legend="right",
           data=dnam,
           legend.title="SO4 1mo \nPre-Sampling",
           legend.labs=c("Low", "High"),
           risk.table=F,
           title="Time to Death or Transplant by Low vs High SO4 in 1mo Pre-Sampling",
           xlab="Time from Diagnosis (years)",
           ylab="Survival Probability (Death or Lung Transplant)",
           ggtheme = theme_grey()
           ))
```

Base model with just SO4
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SO4_1moPreSamp, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between SO4_1moPreSamp and mortality in this model.

Base model with SO4 and pct_5mC
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SO4_1moPreSamp + pct_5mC, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between SO4_1moPreSamp and mortality in this model.

Partial Model with just SO4
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SO4_1moPreSamp + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between SO4_1moPreSamp and mortality in this model.

Partial Model with SO4 and pct_5mC
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SO4_1moPreSamp + pct_5mC + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between SO4_1moPreSamp and mortality in this model.

Complete Model with just SO4
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SO4_1moPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between SO4_1moPreSamp and mortality in this model.

Complete Model with SO4 and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SO4_1moPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between SO4_1moPreSamp and mortality in this model.

Complete Model + site with just SO4_1moPreSamp
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SO4_1moPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
**Sig assoc between SO4_1moPreSamp and increased mortality in this model.**


Complete Model + site with SO4_1moPreSamp and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SO4_1moPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
**Sig assoc between SO4_1moPreSamp and increased mortality in this model, with HR decreasing with addition of pct_5mC indicating some mediaiton.**

# Impact of NO3 on Mortality
## 5yr Pre-Sampling
```{r, fig.height=5, fig.width=7}
surv1 <- survfit(Surv(time_DeathTxCensor, deadORtx==1) ~NO35yrSamp_dich, data=dnam)
(ggsurvplot(surv1, 
            censor=TRUE,
            pval=TRUE,
            xlim=c(0,5),
            legend="right",
           data=dnam,
           legend.title="NO3 5yrs \nPre-Sampling",
           legend.labs=c("Low", "High"),
           risk.table=F,
           title="Time to Death or Transplant by Low vs High NO3 in 5yrs Pre-Sampling",
           xlab="Time from Diagnosis (years)",
           ylab="Survival Probability (Death or Lung Transplant)",
           ggtheme = theme_grey()
           ))
```

Base model with just NO3
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NO3_5yrPreSamp, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between NO3 in 5yrs pre-sampling and mortality in this model.

Base model with NO3 and pct_5mC
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NO3_5yrPreSamp + pct_5mC, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between NO3 in 5yrs pre-sampling and mortality in this model.

Partial Model with just NO3
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NO3_5yrPreSamp + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between NO3 in 5yrs pre-sampling and mortality in this model.

Partial Model with NO3 and pct_5mC
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NO3_5yrPreSamp + pct_5mC + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between NO3 in 5yrs pre-sampling and mortality in this model.

Complete Model with just NO3
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NO3_5yrPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between NO3 in 5yrs pre-sampling and mortality in this model.

Complete Model with NO3 and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NO3_5yrPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between NO3 in 5yrs pre-sampling and mortality in this model.

Complete Model + site with just NO3
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NO3_5yrPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between NO3 in 5yrs pre-sampling and mortality in this model.


Complete Model + site with NO3 and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NO3_5yrPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between NO3 in 5yrs pre-sampling and mortality in this model.


## 1yr Pre-Sampling
```{r, fig.height=5, fig.width=7}
surv1 <- survfit(Surv(time_DeathTxCensor, deadORtx==1) ~NO31yrSamp_dich, data=dnam)
(ggsurvplot(surv1, 
            censor=TRUE,
            pval=TRUE,
            xlim=c(0,5),
            legend="right",
           data=dnam,
           legend.title="NO3 1yr \nPre-Sampling",
           legend.labs=c("Low", "High"),
           risk.table=F,
           title="Time to Death or Transplant by Low vs High NO3 in 1yr Pre-Sampling",
           xlab="Time from Diagnosis (years)",
           ylab="Survival Probability (Death or Lung Transplant)",
           ggtheme = theme_grey()
           ))
```

Base model with just NO3
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NO3_1yrPreSamp, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between NO3_1yrPreSamp and mortality in this model.

Base model with NO3 and pct_5mC
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NO3_1yrPreSamp + pct_5mC, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between NO3_1yrPreSamp and mortality in this model.

Partial Model with just NO3
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NO3_1yrPreSamp + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between NO3_1yrPreSamp and mortality in this model.

Partial Model with NO3 and pct_5mC
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NO3_1yrPreSamp + pct_5mC + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between NO3_1yrPreSamp and mortality in this model.

Complete Model with just NO3
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NO3_1yrPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between NO3_1yrPreSamp and mortality in this model.

Complete Model with NO3 and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NO3_1yrPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between NO3_1yrPreSamp and mortality in this model.

Complete Model + site with just NO3
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NO3_1yrPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between NO3_1yrPreSamp and mortality in this model.


Complete Model + site with NO3 and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NO3_1yrPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between NO3_1yrPreSamp and mortality in this model.



## 6mo Pre-Sampling
```{r, fig.height=5, fig.width=7}
surv1 <- survfit(Surv(time_DeathTxCensor, deadORtx==1) ~NO36moSamp_dich, data=dnam)
(ggsurvplot(surv1, 
            censor=TRUE,
            pval=TRUE,
            xlim=c(0,5),
            legend="right",
           data=dnam,
           legend.title="NO3 6mo \nPre-Sampling",
           legend.labs=c("Low", "High"),
           risk.table=F,
           title="Time to Death or Transplant by Low vs High NO3 in 6mo Pre-Sampling",
           xlab="Time from Diagnosis (years)",
           ylab="Survival Probability (Death or Lung Transplant)",
           ggtheme = theme_grey()
           ))
```


Base model with just NO3
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NO3_6moPreSamp, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between NO3_6moPreSamp and mortality in this model.

Base model with NO3 and pct_5mC
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NO3_6moPreSamp + pct_5mC, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between NO3_6moPreSamp and mortality in this model.

Partial Model with just NO3
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NO3_6moPreSamp + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between NO3_6moPreSamp and mortality in this model.

Partial Model with NO3 and pct_5mC
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NO3_6moPreSamp + pct_5mC + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between NO3_6moPreSamp and mortality in this model.

Complete Model with just NO3
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NO3_6moPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between NO3_6moPreSamp and mortality in this model.

Complete Model with NO3 and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NO3_6moPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between NO3_6moPreSamp and mortality in this model.

Complete Model + site with just NO3
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NO3_6moPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between NO3_6moPreSamp and mortality in this model.


Complete Model + site with NO3 and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NO3_6moPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between NO3_6moPreSamp and mortality in this model.



## 3mo Pre-Sampling
```{r, fig.height=5, fig.width=7}
surv1 <- survfit(Surv(time_DeathTxCensor, deadORtx==1) ~NO33moSamp_dich, data=dnam)
(ggsurvplot(surv1, 
            censor=TRUE,
            pval=TRUE,
            xlim=c(0,5),
            legend="right",
           data=dnam,
           legend.title="NO3 3mo \nPre-Sampling",
           legend.labs=c("Low", "High"),
           risk.table=F,
           title="Time to Death or Transplant by Low vs High NO3 in 3mo Pre-Sampling",
           xlab="Time from Diagnosis (years)",
           ylab="Survival Probability (Death or Lung Transplant)",
           ggtheme = theme_grey()
           ))
```


Base model with just NO3
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NO3_3moPreSamp, data=dnam, id=ID)
summary(coxPH_model1)
```
**Significant assoc between NO3_3moPreSamp and increased mortality in this model.**

Base model with NO3 and pct_5mC
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NO3_3moPreSamp + pct_5mC, data=dnam, id=ID)
summary(coxPH_model1)
```
**Significant assoc between NO3_3moPreSamp and increased mortality in this model.**
No major mediation by pct_5mC apparent here.

Partial Model with just NO3
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NO3_3moPreSamp + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
*Marginal assoc between NO3_3moPreSamp and increased mortality in this model.*

Partial Model with NO3 and pct_5mC
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NO3_3moPreSamp + pct_5mC + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
*Marginal assoc between NO3_3moPreSamp and increased mortality in this model.*
HR actually increases very slightly with addition of pct_5mC indicating no mediation

Complete Model with just NO3
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NO3_3moPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
*Marginal assoc between NO3_3moPreSamp and increased mortality in this model.*

Complete Model with NO3 and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NO3_3moPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
*Marginal assoc between NO3_3moPreSamp and increased mortality in this model.*
Minimal difference in HR after pct_5mC added suggesting minimal mediation

Complete Model + site with just NO3_3moPreSamp
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NO3_3moPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
**Sig assoc between NO3_3moPreSamp and increased mortality in this model.**


Complete Model + site with NO3_3moPreSamp and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NO3_3moPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
**Sig assoc between NO3_3moPreSamp and increased mortality in this model,** but no substantial change to HR when pct_5mC added indicating no mediation


## 1mo Pre-Sampling
```{r, fig.height=5, fig.width=7}
surv1 <- survfit(Surv(time_DeathTxCensor, deadORtx==1) ~NO31moSamp_dich, data=dnam)
(ggsurvplot(surv1, 
            censor=TRUE,
            pval=TRUE,
            xlim=c(0,5),
            legend="right",
           data=dnam,
           legend.title="NO3 1mo \nPre-Sampling",
           legend.labs=c("Low", "High"),
           risk.table=F,
           title="Time to Death or Transplant by Low vs High NO3 in 1mo Pre-Sampling",
           xlab="Time from Diagnosis (years)",
           ylab="Survival Probability (Death or Lung Transplant)",
           ggtheme = theme_grey()
           ))
```

Base model with just NO3
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NO3_1moPreSamp, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between NO3_1moPreSamp and mortality in this model.

Base model with NO3 and pct_5mC
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NO3_1moPreSamp + pct_5mC, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between NO3_1moPreSamp and mortality in this model.

Partial Model with just NO3
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NO3_1moPreSamp + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between NO3_1moPreSamp and mortality in this model.

Partial Model with NO3 and pct_5mC
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NO3_1moPreSamp + pct_5mC + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between NO3_1moPreSamp and mortality in this model.

Complete Model with just NO3
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NO3_1moPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between NO3_1moPreSamp and mortality in this model.

Complete Model with NO3 and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NO3_1moPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between NO3_1moPreSamp and mortality in this model.

Complete Model + site with just NO3_1moPreSamp
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NO3_1moPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between NO3_1moPreSamp and mortality in this model.


Complete Model + site with NO3_1moPreSamp and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NO3_1moPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between NO3_1moPreSamp and mortality in this model.


# Impact of NH4 on Mortality
## 5yr Pre-Sampling
```{r, fig.height=5, fig.width=7}
surv1 <- survfit(Surv(time_DeathTxCensor, deadORtx==1) ~NH45yrSamp_dich, data=dnam)
(ggsurvplot(surv1, 
            censor=TRUE,
            pval=TRUE,
            xlim=c(0,5),
            legend="right",
           data=dnam,
           legend.title="NH4 5yrs \nPre-Sampling",
           legend.labs=c("Low", "High"),
           risk.table=F,
           title="Time to Death or Transplant by Low vs High NH4 in 5yrs Pre-Sampling",
           xlab="Time from Diagnosis (years)",
           ylab="Survival Probability (Death or Lung Transplant)",
           ggtheme = theme_grey()
           ))
```

Base model with just NH4
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NH4_5yrPreSamp, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between NH4 in 5yrs pre-sampling and mortality in this model.

Base model with NH4 and pct_5mC
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NH4_5yrPreSamp + pct_5mC, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between NH4 in 5yrs pre-sampling and mortality in this model.

Partial Model with just NH4
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NH4_5yrPreSamp + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between NH4 in 5yrs pre-sampling and mortality in this model.

Partial Model with NH4 and pct_5mC
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NH4_5yrPreSamp + pct_5mC + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between NH4 in 5yrs pre-sampling and mortality in this model.

Complete Model with just NH4
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NH4_5yrPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
**Significant assoc between higher NH4_5yrPreSamp and lower mortality in this model.**

Complete Model with NH4 and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NH4_5yrPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
**Significant assoc between higher NH4_5yrPreSamp and lower mortality in this model.**

Complete Model + site with just NH4_5yrPreSamp
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NH4_5yrPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
No sig assoc between NH4_5yrPreSamp and mort in this model.

Complete Model + site with NH4_5yrPreSamp and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NH4_5yrPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
No sig assoc between NH4_5yrPreSamp and mort in this model.



## 1yr Pre-Sampling
```{r, fig.height=5, fig.width=7}
surv1 <- survfit(Surv(time_DeathTxCensor, deadORtx==1) ~NH41yrSamp_dich, data=dnam)
(ggsurvplot(surv1, 
            censor=TRUE,
            pval=TRUE,
            xlim=c(0,5),
            legend="right",
           data=dnam,
           legend.title="NH4 1yr \nPre-Sampling",
           legend.labs=c("Low", "High"),
           risk.table=F,
           title="Time to Death or Transplant by Low vs High NH4 in 1yr Pre-Sampling",
           xlab="Time from Diagnosis (years)",
           ylab="Survival Probability (Death or Lung Transplant)",
           ggtheme = theme_grey()
           ))
```

Base model with just NH4
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NH4_1yrPreSamp, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between NH4_1yrPreSamp and mortality in this model.

Base model with NH4 and pct_5mC
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NH4_1yrPreSamp + pct_5mC, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between NH4_1yrPreSamp and mortality in this model.

Partial Model with just NH4
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NH4_1yrPreSamp + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between NH4_1yrPreSamp and mortality in this model.

Partial Model with NH4 and pct_5mC
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NH4_1yrPreSamp + pct_5mC + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between NH4_1yrPreSamp and mortality in this model.

Complete Model with just NH4
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NH4_1yrPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between NH4_1yrPreSamp and mortality in this model.

Complete Model with NH4 and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NH4_1yrPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between NH4_1yrPreSamp and mortality in this model.

Complete Model + site with just NH4_1yrPreSamp
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NH4_1yrPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between NH4_1yrPreSamp and mortality in this model.


Complete Model + site with NH4_1yrPreSamp and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NH4_1yrPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between NH4_1yrPreSamp and mortality in this model.



## 6mo Pre-Sampling
```{r, fig.height=5, fig.width=7}
surv1 <- survfit(Surv(time_DeathTxCensor, deadORtx==1) ~NH46moSamp_dich, data=dnam)
(ggsurvplot(surv1, 
            censor=TRUE,
            pval=TRUE,
            xlim=c(0,5),
            legend="right",
           data=dnam,
           legend.title="NH4 6mo \nPre-Sampling",
           legend.labs=c("Low", "High"),
           risk.table=F,
           title="Time to Death or Transplant by Low vs High NH4 in 6mo Pre-Sampling",
           xlab="Time from Diagnosis (years)",
           ylab="Survival Probability (Death or Lung Transplant)",
           ggtheme = theme_grey()
           ))
```


Base model with just NH4
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NH4_6moPreSamp, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between NH4_6moPreSamp and mortality in this model.

Base model with NH4 and pct_5mC
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NH4_6moPreSamp + pct_5mC, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between NH4_6moPreSamp and mortality in this model.

Partial Model with just NH4
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NH4_6moPreSamp + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between NH4_6moPreSamp and mortality in this model.

Partial Model with NH4 and pct_5mC
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NH4_6moPreSamp + pct_5mC + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between NH4_6moPreSamp and mortality in this model.

Complete Model with just NH4
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NH4_6moPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between NH4_6moPreSamp and mortality in this model.

Complete Model with NH4 and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NH4_6moPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between NH4_6moPreSamp and mortality in this model.

Complete Model + site with just NH4_6moPreSamp
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NH4_6moPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between NH4_6moPreSamp and mortality in this model.


Complete Model + site with NH4_6moPreSamp and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NH4_6moPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between NH4_6moPreSamp and mortality in this model.



## 3mo Pre-Sampling
```{r, fig.height=5, fig.width=7}
surv1 <- survfit(Surv(time_DeathTxCensor, deadORtx==1) ~NH43moSamp_dich, data=dnam)
(ggsurvplot(surv1, 
            censor=TRUE,
            pval=TRUE,
            xlim=c(0,5),
            legend="right",
           data=dnam,
           legend.title="NH4 3mo \nPre-Sampling",
           legend.labs=c("Low", "High"),
           risk.table=F,
           title="Time to Death or Transplant by Low vs High NH4 in 3mo Pre-Sampling",
           xlab="Time from Diagnosis (years)",
           ylab="Survival Probability (Death or Lung Transplant)",
           ggtheme = theme_grey()
           ))
```


Base model with just NH4
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NH4_3moPreSamp, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between NH4_3moPreSamp and mortality in this model.

Base model with NH4 and pct_5mC
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NH4_3moPreSamp + pct_5mC, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between NH4_3moPreSamp and mortality in this model.

Partial Model with just NH4
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NH4_3moPreSamp + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between NH4_3moPreSamp and mortality in this model.

Partial Model with NH4 and pct_5mC
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NH4_3moPreSamp + pct_5mC + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between NH4_3moPreSamp and mortality in this model.

Complete Model with just NH4
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NH4_3moPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between NH4_3moPreSamp and mortality in this model.

Complete Model with NH4 and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NH4_3moPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between NH4_3moPreSamp and mortality in this model.

Complete Model + site with just NH4_3moPreSamp
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NH4_3moPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
**Significant assoc between increased NH4_3moPreSamp and increased mortality in this model.**


Complete Model + site with NH4_3moPreSamp and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NH4_3moPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
**Significant assoc between increased NH4_3moPreSamp and increased mortality in this model,** but HR increases when pct_5mC added to model indicating it is not mediating



## 1mo Pre-Sampling
```{r, fig.height=5, fig.width=7}
surv1 <- survfit(Surv(time_DeathTxCensor, deadORtx==1) ~NH41moSamp_dich, data=dnam)
(ggsurvplot(surv1, 
            censor=TRUE,
            pval=TRUE,
            xlim=c(0,5),
            legend="right",
           data=dnam,
           legend.title="NH4 1mo \nPre-Sampling",
           legend.labs=c("Low", "High"),
           risk.table=F,
           title="Time to Death or Transplant by Low vs High NH4 in 1mo Pre-Sampling",
           xlab="Time from Diagnosis (years)",
           ylab="Survival Probability (Death or Lung Transplant)",
           ggtheme = theme_grey()
           ))
```

Base model with just NH4
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NH4_1moPreSamp, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between NH4_1moPreSamp and mortality in this model.

Base model with NH4 and pct_5mC
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NH4_1moPreSamp + pct_5mC, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between NH4_1moPreSamp and mortality in this model.

Partial Model with just NH4
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NH4_1moPreSamp + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between NH4_1moPreSamp and mortality in this model.

Partial Model with NH4 and pct_5mC
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NH4_1moPreSamp + pct_5mC + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between NH4_1moPreSamp and mortality in this model.

Complete Model with just NH4
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NH4_1moPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between NH4_1moPreSamp and mortality in this model.

Complete Model with NH4 and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NH4_1moPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between NH4_1moPreSamp and mortality in this model.

Complete Model + site with just NH4_1moPreSamp
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NH4_1moPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between NH4_1moPreSamp and mortality in this model.


Complete Model + site with NH4_1moPreSamp and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ NH4_1moPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between NH4_1moPreSamp and mortality in this model.


# Impact of BC on Mortality
## 5yr Pre-Sampling
```{r, fig.height=5, fig.width=7}
surv1 <- survfit(Surv(time_DeathTxCensor, deadORtx==1) ~BC5yrSamp_dich, data=dnam)
(ggsurvplot(surv1, 
            censor=TRUE,
            pval=TRUE,
            xlim=c(0,5),
            legend="right",
           data=dnam,
           legend.title="BC 5yrs \nPre-Sampling",
           legend.labs=c("Low", "High"),
           risk.table=F,
           title="Time to Death or Transplant by Low vs High BC in 5yrs Pre-Sampling",
           xlab="Time from Diagnosis (years)",
           ylab="Survival Probability (Death or Lung Transplant)",
           ggtheme = theme_grey()
           ))
```

Base model with just BC
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ BC_5yrPreSamp, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between BC in 5yrs pre-sampling and mortality in this model.

Base model with BC and pct_5mC
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ BC_5yrPreSamp + pct_5mC, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between BC in 5yrs pre-sampling and mortality in this model.

Partial Model with just BC
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ BC_5yrPreSamp + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between BC in 5yrs pre-sampling and mortality in this model.

Partial Model with BC and pct_5mC
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ BC_5yrPreSamp + pct_5mC + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between BC in 5yrs pre-sampling and mortality in this model.

Complete Model with just BC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ BC_5yrPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between BC in 5yrs pre-sampling and mortality in this model.

Complete Model with BC and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ BC_5yrPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between BC in 5yrs pre-sampling and mortality in this model.

Complete Model + site with just BC_5yrPreSamp
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ BC_5yrPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between BC in 5yrs pre-sampling and mortality in this model.


Complete Model + site with BC_5yrPreSamp and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ BC_5yrPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between BC in 5yrs pre-sampling and mortality in this model.



## 1yr Pre-Sampling
```{r, fig.height=5, fig.width=7}
surv1 <- survfit(Surv(time_DeathTxCensor, deadORtx==1) ~BC1yrSamp_dich, data=dnam)
(ggsurvplot(surv1, 
            censor=TRUE,
            pval=TRUE,
            xlim=c(0,5),
            legend="right",
           data=dnam,
           legend.title="BC 1yr \nPre-Sampling",
           legend.labs=c("Low", "High"),
           risk.table=F,
           title="Time to Death or Transplant by Low vs High BC in 1yr Pre-Sampling",
           xlab="Time from Diagnosis (years)",
           ylab="Survival Probability (Death or Lung Transplant)",
           ggtheme = theme_grey()
           ))
```

Base model with just BC
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ BC_1yrPreSamp, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between BC_1yrPreSamp and mortality in this model.

Base model with BC and pct_5mC
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ BC_1yrPreSamp + pct_5mC, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between BC_1yrPreSamp and mortality in this model.

Partial Model with just BC
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ BC_1yrPreSamp + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between BC_1yrPreSamp and mortality in this model.

Partial Model with BC and pct_5mC
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ BC_1yrPreSamp + pct_5mC + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between BC_1yrPreSamp and mortality in this model.

Complete Model with just BC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ BC_1yrPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between BC_1yrPreSamp and mortality in this model.

Complete Model with BC and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ BC_1yrPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between BC_1yrPreSamp and mortality in this model.

Complete Model + site with just BC_1yrPreSamp
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ BC_1yrPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
**Significant assoc between increased BC_1yrPreSamp and increased mortality in this model.**

Complete Model + site with BC_1yrPreSamp and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ BC_1yrPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
**Significant assoc between increased BC_1yrPreSamp and increased mortality in this model, with HR decreasing when pct_5mC added to model indicating some mediation.**



## 6mo Pre-Sampling
```{r, fig.height=5, fig.width=7}
surv1 <- survfit(Surv(time_DeathTxCensor, deadORtx==1) ~BC6moSamp_dich, data=dnam)
(ggsurvplot(surv1, 
            censor=TRUE,
            pval=TRUE,
            xlim=c(0,5),
            legend="right",
           data=dnam,
           legend.title="BC 6mo \nPre-Sampling",
           legend.labs=c("Low", "High"),
           risk.table=F,
           title="Time to Death or Transplant by Low vs High BC in 6mo Pre-Sampling",
           xlab="Time from Diagnosis (years)",
           ylab="Survival Probability (Death or Lung Transplant)",
           ggtheme = theme_grey()
           ))
```


Base model with just BC
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ BC_6moPreSamp, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between BC_6moPreSamp and mortality in this model.

Base model with BC and pct_5mC
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ BC_6moPreSamp + pct_5mC, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between BC_6moPreSamp and mortality in this model.

Partial Model with just BC
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ BC_6moPreSamp + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between BC_6moPreSamp and mortality in this model.

Partial Model with BC and pct_5mC
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ BC_6moPreSamp + pct_5mC + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between BC_6moPreSamp and mortality in this model.

Complete Model with just BC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ BC_6moPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between BC_6moPreSamp and mortality in this model.

Complete Model with BC and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ BC_6moPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between BC_6moPreSamp and mortality in this model.

Complete Model + site with just BC_6moPreSamp
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ BC_6moPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between BC_6moPreSamp and mortality in this model.


Complete Model + site with BC_6moPreSamp and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ BC_6moPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between BC_6moPreSamp and mortality in this model.



## 3mo Pre-Sampling
```{r, fig.height=5, fig.width=7}
surv1 <- survfit(Surv(time_DeathTxCensor, deadORtx==1) ~BC3moSamp_dich, data=dnam)
(ggsurvplot(surv1, 
            censor=TRUE,
            pval=TRUE,
            xlim=c(0,5),
            legend="right",
           data=dnam,
           legend.title="BC 3mo \nPre-Sampling",
           legend.labs=c("Low", "High"),
           risk.table=F,
           title="Time to Death or Transplant by Low vs High BC in 3mo Pre-Sampling",
           xlab="Time from Diagnosis (years)",
           ylab="Survival Probability (Death or Lung Transplant)",
           ggtheme = theme_grey()
           ))
```


Base model with just BC
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ BC_3moPreSamp, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between BC_3moPreSamp and mortality in this model.

Base model with BC and pct_5mC
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ BC_3moPreSamp + pct_5mC, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between BC_3moPreSamp and mortality in this model.

Partial Model with just BC
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ BC_3moPreSamp + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between BC_3moPreSamp and mortality in this model.

Partial Model with BC and pct_5mC
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ BC_3moPreSamp + pct_5mC + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between BC_3moPreSamp and mortality in this model.

Complete Model with just BC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ BC_3moPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between BC_3moPreSamp and mortality in this model.

Complete Model with BC and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ BC_3moPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between BC_3moPreSamp and mortality in this model.

Complete Model + site with just BC_3moPreSamp
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ BC_3moPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
**Significant assoc between increased BC_3moPreSamp and increased mortality in this model.**


Complete Model + site with BC_3moPreSamp and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ BC_3moPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
**Significant assoc between increased BC_3moPreSamp and increased mortality in this model, with HR decreased when pct_5mC added to model indicating some mediation.**



## 1mo Pre-Sampling
```{r, fig.height=5, fig.width=7}
surv1 <- survfit(Surv(time_DeathTxCensor, deadORtx==1) ~BC1moSamp_dich, data=dnam)
(ggsurvplot(surv1, 
            censor=TRUE,
            pval=TRUE,
            xlim=c(0,5),
            legend="right",
           data=dnam,
           legend.title="BC 1mo \nPre-Sampling",
           legend.labs=c("Low", "High"),
           risk.table=F,
           title="Time to Death or Transplant by Low vs High BC in 1mo Pre-Sampling",
           xlab="Time from Diagnosis (years)",
           ylab="Survival Probability (Death or Lung Transplant)",
           ggtheme = theme_grey()
           ))
```

Base model with just BC
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ BC_1moPreSamp, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between BC_1moPreSamp and mortality in this model.

Base model with BC and pct_5mC
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ BC_1moPreSamp + pct_5mC, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between BC_1moPreSamp and mortality in this model.

Partial Model with just BC
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ BC_1moPreSamp + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between BC_1moPreSamp and mortality in this model.

Partial Model with BC and pct_5mC
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ BC_1moPreSamp + pct_5mC + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between BC_1moPreSamp and mortality in this model.

Complete Model with just BC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ BC_1moPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between BC_1moPreSamp and mortality in this model.

Complete Model with BC and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ BC_1moPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between BC_1moPreSamp and mortality in this model.

Complete Model + site with just BC_1moPreSamp
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ BC_1moPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
**Significant assoc between increased BC_1moPreSamp and increased mortality in this model.**


Complete Model + site with BC_1moPreSamp and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ BC_1moPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
**Significant assoc between increased BC_1moPreSamp and increased mortality in this model, with HR decreased slightly when pct_5mC added to model indicating some mediation.**


# Impact of OM on Mortality
## 5yr Pre-Sampling
```{r, fig.height=5, fig.width=7}
surv1 <- survfit(Surv(time_DeathTxCensor, deadORtx==1) ~OM5yrSamp_dich, data=dnam)
(ggsurvplot(surv1, 
            censor=TRUE,
            pval=TRUE,
            xlim=c(0,5),
            legend="right",
           data=dnam,
           legend.title="OM 5yrs \nPre-Sampling",
           legend.labs=c("Low", "High"),
           risk.table=F,
           title="Time to Death or Transplant by Low vs High OM in 5yrs Pre-Sampling",
           xlab="Time from Diagnosis (years)",
           ylab="Survival Probability (Death or Lung Transplant)",
           ggtheme = theme_grey()
           ))
```

Base model with just OM
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ OM_5yrPreSamp, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between OM in 5yrs pre-sampling and mortality in this model.

Base model with OM and pct_5mC
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ OM_5yrPreSamp + pct_5mC, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between OM in 5yrs pre-sampling and mortality in this model.

Partial Model with just OM
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ OM_5yrPreSamp + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between OM in 5yrs pre-sampling and mortality in this model.

Partial Model with OM and pct_5mC
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ OM_5yrPreSamp + pct_5mC + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between OM in 5yrs pre-sampling and mortality in this model.

Complete Model with just OM
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ OM_5yrPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between OM in 5yrs pre-sampling and mortality in this model.

Complete Model with OM and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ OM_5yrPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between OM in 5yrs pre-sampling and mortality in this model.

Complete Model + site with just OM_5yrPreSamp
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ OM_5yrPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between OM in 5yrs pre-sampling and mortality in this model.


Complete Model + site with OM_5yrPreSamp and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ OM_5yrPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between OM in 5yrs pre-sampling and mortality in this model.



## 1yr Pre-Sampling
```{r, fig.height=5, fig.width=7}
surv1 <- survfit(Surv(time_DeathTxCensor, deadORtx==1) ~OM1yrSamp_dich, data=dnam)
(ggsurvplot(surv1, 
            censor=TRUE,
            pval=TRUE,
            xlim=c(0,5),
            legend="right",
           data=dnam,
           legend.title="OM 1yr \nPre-Sampling",
           legend.labs=c("Low", "High"),
           risk.table=F,
           title="Time to Death or Transplant by Low vs High OM in 1yr Pre-Sampling",
           xlab="Time from Diagnosis (years)",
           ylab="Survival Probability (Death or Lung Transplant)",
           ggtheme = theme_grey()
           ))
```

Base model with just OM
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ OM_1yrPreSamp, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between OM_1yrPreSamp and mortality in this model.

Base model with OM and pct_5mC
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ OM_1yrPreSamp + pct_5mC, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between OM_1yrPreSamp and mortality in this model.

Partial Model with just OM
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ OM_1yrPreSamp + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between OM_1yrPreSamp and mortality in this model.

Partial Model with OM and pct_5mC
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ OM_1yrPreSamp + pct_5mC + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between OM_1yrPreSamp and mortality in this model.

Complete Model with just OM
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ OM_1yrPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between OM_1yrPreSamp and mortality in this model.

Complete Model with OM and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ OM_1yrPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between OM_1yrPreSamp and mortality in this model.

Complete Model + site with just OM_1yrPreSamp
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ OM_1yrPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
**Significant assoc between increased OM_1yrPreSamp and increased mortality in this model.**


Complete Model + site with OM_1yrPreSamp and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ OM_1yrPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
**Significant assoc between increased OM_1yrPreSamp and increased mortality in this model.** No difference in HR when pct_5mC added indicating no mediation.



## 6mo Pre-Sampling
```{r, fig.height=5, fig.width=7}
surv1 <- survfit(Surv(time_DeathTxCensor, deadORtx==1) ~OM6moSamp_dich, data=dnam)
(ggsurvplot(surv1, 
            censor=TRUE,
            pval=TRUE,
            xlim=c(0,5),
            legend="right",
           data=dnam,
           legend.title="OM 6mo \nPre-Sampling",
           legend.labs=c("Low", "High"),
           risk.table=F,
           title="Time to Death or Transplant by Low vs High OM in 6mo Pre-Sampling",
           xlab="Time from Diagnosis (years)",
           ylab="Survival Probability (Death or Lung Transplant)",
           ggtheme = theme_grey()
           ))
```


Base model with just OM
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ OM_6moPreSamp, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between OM_6moPreSamp and mortality in this model.

Base model with OM and pct_5mC
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ OM_6moPreSamp + pct_5mC, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between OM_6moPreSamp and mortality in this model.

Partial Model with just OM
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ OM_6moPreSamp + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between OM_6moPreSamp and mortality in this model.

Partial Model with OM and pct_5mC
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ OM_6moPreSamp + pct_5mC + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between OM_6moPreSamp and mortality in this model.

Complete Model with just OM
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ OM_6moPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between OM_6moPreSamp and mortality in this model.

Complete Model with OM and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ OM_6moPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between OM_6moPreSamp and mortality in this model.

Complete Model + site with just OM_6moPreSamp
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ OM_6moPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between OM_6moPreSamp and mortality in this model.


Complete Model + site with OM_6moPreSamp and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ OM_6moPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between OM_6moPreSamp and mortality in this model.



## 3mo Pre-Sampling
```{r, fig.height=5, fig.width=7}
surv1 <- survfit(Surv(time_DeathTxCensor, deadORtx==1) ~OM3moSamp_dich, data=dnam)
(ggsurvplot(surv1, 
            censor=TRUE,
            pval=TRUE,
            xlim=c(0,5),
            legend="right",
           data=dnam,
           legend.title="OM 3mo \nPre-Sampling",
           legend.labs=c("Low", "High"),
           risk.table=F,
           title="Time to Death or Transplant by Low vs High OM in 3mo Pre-Sampling",
           xlab="Time from Diagnosis (years)",
           ylab="Survival Probability (Death or Lung Transplant)",
           ggtheme = theme_grey()
           ))
```


Base model with just OM
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ OM_3moPreSamp, data=dnam, id=ID)
summary(coxPH_model1)
```
*Marginal assoc between higher OM_3moPreSamp and mortality in this model.*

Base model with OM and pct_5mC
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ OM_3moPreSamp + pct_5mC, data=dnam, id=ID)
summary(coxPH_model1)
```
*Marginal assoc between higher OM_3moPreSamp and mortality in this model.*
No evidence of pct_5mC mediation

Partial Model with just OM
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ OM_3moPreSamp + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
*Marginal assoc between higher OM_3moPreSamp and mortality in this model.*

Partial Model with OM and pct_5mC
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ OM_3moPreSamp + pct_5mC + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
*Marginal assoc between higher OM_3moPreSamp and mortality in this model.*

Complete Model with just OM
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ OM_3moPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between OM_3moPreSamp and mortality in this model.

Complete Model with OM and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ OM_3moPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between OM_3moPreSamp and mortality in this model.

Complete Model + site with just OM_3moPreSamp
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ OM_3moPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
**Significant assoc between increased OM_3moPreSamp and increased mortality in this model.**


Complete Model + site with OM_3moPreSamp and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ OM_3moPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
**Significant assoc between increased OM_3moPreSamp and increased mortality in this model,** but HR increases slightly with addition of pct_5mC to model indicating no mediation.



## 1mo Pre-Sampling
```{r, fig.height=5, fig.width=7}
surv1 <- survfit(Surv(time_DeathTxCensor, deadORtx==1) ~OM1moSamp_dich, data=dnam)
(ggsurvplot(surv1, 
            censor=TRUE,
            pval=TRUE,
            xlim=c(0,5),
            legend="right",
           data=dnam,
           legend.title="OM 1mo \nPre-Sampling",
           legend.labs=c("Low", "High"),
           risk.table=F,
           title="Time to Death or Transplant by Low vs High OM in 1mo Pre-Sampling",
           xlab="Time from Diagnosis (years)",
           ylab="Survival Probability (Death or Lung Transplant)",
           ggtheme = theme_grey()
           ))
```

Base model with just OM
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ OM_1moPreSamp, data=dnam, id=ID)
summary(coxPH_model1)
```
*Marginal assoc between higher OM_1moPreSamp and mortality in this model.*

Base model with OM and pct_5mC
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ OM_1moPreSamp + pct_5mC, data=dnam, id=ID)
summary(coxPH_model1)
```
*Marginal assoc between higher OM_1moPreSamp and mortality in this model.*
No evidence of mediation by pct_5mC

Partial Model with just OM
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ OM_1moPreSamp + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
*Marginal assoc between higher OM_1moPreSamp and mortality in this model.*

Partial Model with OM and pct_5mC
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ OM_1moPreSamp + pct_5mC + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
*Marginal assoc between higher OM_1moPreSamp and mortality in this model.*

Complete Model with just OM
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ OM_1moPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between OM_1moPreSamp and mortality in this model.

Complete Model with OM and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ OM_1moPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between OM_1moPreSamp and mortality in this model.

Complete Model + site with just OM_1moPreSamp
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ OM_1moPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
**Significant assoc between increased OM_1moPreSamp and increased mortality in this model.**


Complete Model + site with OM_1moPreSamp and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ OM_1moPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
**Significant assoc between increased OM_1moPreSamp and increased mortality in this model,** but HR increases slightly with addition of pct_5mC indicating no mediaiton.


# Impact of SS on Mortality
## 5yr Pre-Sampling
```{r, fig.height=5, fig.width=7}
surv1 <- survfit(Surv(time_DeathTxCensor, deadORtx==1) ~SS5yrSamp_dich, data=dnam)
(ggsurvplot(surv1, 
            censor=TRUE,
            pval=TRUE,
            xlim=c(0,5),
            legend="right",
           data=dnam,
           legend.title="SS 5yrs \nPre-Sampling",
           legend.labs=c("Low", "High"),
           risk.table=F,
           title="Time to Death or Transplant by Low vs High SS in 5yrs Pre-Sampling",
           xlab="Time from Diagnosis (years)",
           ylab="Survival Probability (Death or Lung Transplant)",
           ggtheme = theme_grey()
           ))
```

Base model with just SS
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SS_5yrPreSamp, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between SS in 5yrs pre-sampling and mortality in this model.

Base model with SS and pct_5mC
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SS_5yrPreSamp + pct_5mC, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between SS in 5yrs pre-sampling and mortality in this model.

Partial Model with just SS
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SS_5yrPreSamp + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between SS in 5yrs pre-sampling and mortality in this model.

Partial Model with SS and pct_5mC
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SS_5yrPreSamp + pct_5mC + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between SS in 5yrs pre-sampling and mortality in this model.

Complete Model with just SS
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SS_5yrPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between SS in 5yrs pre-sampling and mortality in this model.

Complete Model with SS and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SS_5yrPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between SS in 5yrs pre-sampling and mortality in this model.

Complete Model + site with just SS_5yrPreSamp
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SS_5yrPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between SS in 5yrs pre-sampling and mortality in this model.


Complete Model + site with SS_5yrPreSamp and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SS_5yrPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between SS in 5yrs pre-sampling and mortality in this model.



## 1yr Pre-Sampling
```{r, fig.height=5, fig.width=7}
surv1 <- survfit(Surv(time_DeathTxCensor, deadORtx==1) ~SS1yrSamp_dich, data=dnam)
(ggsurvplot(surv1, 
            censor=TRUE,
            pval=TRUE,
            xlim=c(0,5),
            legend="right",
           data=dnam,
           legend.title="SS 1yr \nPre-Sampling",
           legend.labs=c("Low", "High"),
           risk.table=F,
           title="Time to Death or Transplant by Low vs High SS in 1yr Pre-Sampling",
           xlab="Time from Diagnosis (years)",
           ylab="Survival Probability (Death or Lung Transplant)",
           ggtheme = theme_grey()
           ))
```

Base model with just SS
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SS_1yrPreSamp, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between SS_1yrPreSamp and mortality in this model.

Base model with SS and pct_5mC
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SS_1yrPreSamp + pct_5mC, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between SS_1yrPreSamp and mortality in this model.

Partial Model with just SS
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SS_1yrPreSamp + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between SS_1yrPreSamp and mortality in this model.

Partial Model with SS and pct_5mC
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SS_1yrPreSamp + pct_5mC + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between SS_1yrPreSamp and mortality in this model.

Complete Model with just SS
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SS_1yrPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between SS_1yrPreSamp and mortality in this model.

Complete Model with SS and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SS_1yrPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between SS_1yrPreSamp and mortality in this model.

Complete Model + site with just SS_1yrPreSamp
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SS_1yrPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between SS_1yrPreSamp and mortality in this model.


Complete Model + site with SS_1yrPreSamp and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SS_1yrPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between SS_1yrPreSamp and mortality in this model.



## 6mo Pre-Sampling
```{r, fig.height=5, fig.width=7}
surv1 <- survfit(Surv(time_DeathTxCensor, deadORtx==1) ~SS6moSamp_dich, data=dnam)
(ggsurvplot(surv1, 
            censor=TRUE,
            pval=TRUE,
            xlim=c(0,5),
            legend="right",
           data=dnam,
           legend.title="SS 6mo \nPre-Sampling",
           legend.labs=c("Low", "High"),
           risk.table=F,
           title="Time to Death or Transplant by Low vs High SS in 6mo Pre-Sampling",
           xlab="Time from Diagnosis (years)",
           ylab="Survival Probability (Death or Lung Transplant)",
           ggtheme = theme_grey()
           ))
```


Base model with just SS
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SS_6moPreSamp, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between SS_6moPreSamp and mortality in this model.

Base model with SS and pct_5mC
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SS_6moPreSamp + pct_5mC, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between SS_6moPreSamp and mortality in this model.

Partial Model with just SS
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SS_6moPreSamp + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between SS_6moPreSamp and mortality in this model.

Partial Model with SS and pct_5mC
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SS_6moPreSamp + pct_5mC + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between SS_6moPreSamp and mortality in this model.

Complete Model with just SS
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SS_6moPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between SS_6moPreSamp and mortality in this model.

Complete Model with SS and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SS_6moPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between SS_6moPreSamp and mortality in this model.

Complete Model + site with just SS_6moPreSamp
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SS_6moPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between SS_6moPreSamp and mortality in this model.


Complete Model + site with SS_6moPreSamp and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SS_6moPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between SS_6moPreSamp and mortality in this model.



## 3mo Pre-Sampling
```{r, fig.height=5, fig.width=7}
surv1 <- survfit(Surv(time_DeathTxCensor, deadORtx==1) ~SS3moSamp_dich, data=dnam)
(ggsurvplot(surv1, 
            censor=TRUE,
            pval=TRUE,
            xlim=c(0,5),
            legend="right",
           data=dnam,
           legend.title="SS 3mo \nPre-Sampling",
           legend.labs=c("Low", "High"),
           risk.table=F,
           title="Time to Death or Transplant by Low vs High SS in 3mo Pre-Sampling",
           xlab="Time from Diagnosis (years)",
           ylab="Survival Probability (Death or Lung Transplant)",
           ggtheme = theme_grey()
           ))
```


Base model with just SS
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SS_3moPreSamp, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between SS_3moPreSamp and mortality in this model.

Base model with SS and pct_5mC
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SS_3moPreSamp + pct_5mC, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between SS_3moPreSamp and mortality in this model.

Partial Model with just SS
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SS_3moPreSamp + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between SS_3moPreSamp and mortality in this model.

Partial Model with SS and pct_5mC
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SS_3moPreSamp + pct_5mC + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between SS_3moPreSamp and mortality in this model.

Complete Model with just SS
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SS_3moPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between SS_3moPreSamp and mortality in this model.

Complete Model with SS and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SS_3moPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between SS_3moPreSamp and mortality in this model.

Complete Model + site with just SS_3moPreSamp
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SS_3moPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between SS_3moPreSamp and mortality in this model.


Complete Model + site with SS_3moPreSamp and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SS_3moPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between SS_3moPreSamp and mortality in this model.



## 1mo Pre-Sampling
```{r, fig.height=5, fig.width=7}
surv1 <- survfit(Surv(time_DeathTxCensor, deadORtx==1) ~SS1moSamp_dich, data=dnam)
(ggsurvplot(surv1, 
            censor=TRUE,
            pval=TRUE,
            xlim=c(0,5),
            legend="right",
           data=dnam,
           legend.title="SS 1mo \nPre-Sampling",
           legend.labs=c("Low", "High"),
           risk.table=F,
           title="Time to Death or Transplant by Low vs High SS in 1mo Pre-Sampling",
           xlab="Time from Diagnosis (years)",
           ylab="Survival Probability (Death or Lung Transplant)",
           ggtheme = theme_grey()
           ))
```

Base model with just SS
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SS_1moPreSamp, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between SS_1moPreSamp and mortality in this model.

Base model with SS and pct_5mC
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SS_1moPreSamp + pct_5mC, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between SS_1moPreSamp and mortality in this model.

Partial Model with just SS
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SS_1moPreSamp + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between SS_1moPreSamp and mortality in this model.

Partial Model with SS and pct_5mC
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SS_1moPreSamp + pct_5mC + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between SS_1moPreSamp and mortality in this model.

Complete Model with just SS
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SS_1moPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between SS_1moPreSamp and mortality in this model.

Complete Model with SS and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SS_1moPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between SS_1moPreSamp and mortality in this model.

Complete Model + site with just SS_1moPreSamp
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SS_1moPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between SS_1moPreSamp and mortality in this model.


Complete Model + site with SS_1moPreSamp and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ SS_1moPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between SS_1moPreSamp and mortality in this model.


# Impact of Soil on Mortality
## 5yr Pre-Sampling
```{r, fig.height=5, fig.width=7}
surv1 <- survfit(Surv(time_DeathTxCensor, deadORtx==1) ~Soil5yrSamp_dich, data=dnam)
(ggsurvplot(surv1, 
            censor=TRUE,
            pval=TRUE,
            xlim=c(0,5),
            legend="right",
           data=dnam,
           legend.title="Soil 5yrs \nPre-Sampling",
           legend.labs=c("Low", "High"),
           risk.table=F,
           title="Time to Death or Transplant by Low vs High Soil in 5yrs Pre-Sampling",
           xlab="Time from Diagnosis (years)",
           ylab="Survival Probability (Death or Lung Transplant)",
           ggtheme = theme_grey()
           ))
```

Base model with just Soil
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ Soil_5yrPreSamp, data=dnam, id=ID)
summary(coxPH_model1)
```
**Significant assoc between increased Soil in 5yrs pre-sampling and increased mortality in this model.**

Base model with Soil and pct_5mC
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ Soil_5yrPreSamp + pct_5mC, data=dnam, id=ID)
summary(coxPH_model1)
```
**Significant assoc between increased Soil in 5yrs pre-sampling and increased mortality in this model.**
**HR reduced when pct_5mC added to model, indicating some partial mediation.**

Partial Model with just Soil
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ Soil_5yrPreSamp + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
*Marginal assoc between increased Soil in 5yrs pre-sampling and increased mortality in this model.*

Partial Model with Soil and pct_5mC
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ Soil_5yrPreSamp + pct_5mC + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
*Marginal assoc between increased Soil in 5yrs pre-sampling and increased mortality in this model.*
**HR decreased when pct_5mC added to model, indicating some mediation by pct_5mC**

Complete Model with just Soil
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ Soil_5yrPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
**Significant assoc between increased Soil in 5yrs pre-sampling and increased mortality in this model.**

Complete Model with Soil and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ Soil_5yrPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
**Significant assoc between increased Soil in 5yrs pre-sampling and increased mortality in this model.**
HR actually increases when pct_5mC added, indicating this is not mediating

Complete Model + site with just Soil_5yrPreSamp
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ Soil_5yrPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between Soil_5yrPreSamp and mortality in this model.


Complete Model + site with Soil_5yrPreSamp and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ Soil_5yrPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between Soil_5yrPreSamp and mortality in this model.


## 1yr Pre-Sampling
```{r, fig.height=5, fig.width=7}
surv1 <- survfit(Surv(time_DeathTxCensor, deadORtx==1) ~Soil1yrSamp_dich, data=dnam)
(ggsurvplot(surv1, 
            censor=TRUE,
            pval=TRUE,
            xlim=c(0,5),
            legend="right",
           data=dnam,
           legend.title="Soil 1yr \nPre-Sampling",
           legend.labs=c("Low", "High"),
           risk.table=F,
           title="Time to Death or Transplant by Low vs High Soil in 1yr Pre-Sampling",
           xlab="Time from Diagnosis (years)",
           ylab="Survival Probability (Death or Lung Transplant)",
           ggtheme = theme_grey()
           ))
```

Base model with just Soil
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ Soil_1yrPreSamp, data=dnam, id=ID)
summary(coxPH_model1)
```
*Marginal assoc between increased Soil_1yrPreSamp and increased mortality in this model.*

Base model with Soil and pct_5mC
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ Soil_1yrPreSamp + pct_5mC, data=dnam, id=ID)
summary(coxPH_model1)
```
*Marginal assoc between increased Soil_1yrPreSamp and increased mortality in this model.*
*Slight decrease HR when pct_5mC added indicating some mediation effect of pct_5mC*

Partial Model with just Soil
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ Soil_1yrPreSamp + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
*Marginal assoc between increased Soil_1yrPreSamp and increased mortality in this model.*

Partial Model with Soil and pct_5mC
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ Soil_1yrPreSamp + pct_5mC + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
*Marginal assoc between increased Soil_1yrPreSamp and increased mortality in this model.*

Complete Model with just Soil
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ Soil_1yrPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
**Significant assoc between increased Soil_1yrPreSamp and increased mortality in this model.**

Complete Model with Soil and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ Soil_1yrPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
**Significant assoc between increased Soil_1yrPreSamp and increased mortality in this model.**
HR actually increases when pct_5mC added to model, indicating not mediating

Complete Model + site with just Soil_1yrPreSamp
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ Soil_1yrPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between Soil_1yrPreSamp and mortality in this model.


Complete Model + site with Soil_1yrPreSamp and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ Soil_1yrPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between Soil_1yrPreSamp and mortality in this model.


## 6mo Pre-Sampling
```{r, fig.height=5, fig.width=7}
surv1 <- survfit(Surv(time_DeathTxCensor, deadORtx==1) ~Soil6moSamp_dich, data=dnam)
(ggsurvplot(surv1, 
            censor=TRUE,
            pval=TRUE,
            xlim=c(0,5),
            legend="right",
           data=dnam,
           legend.title="Soil 6mo \nPre-Sampling",
           legend.labs=c("Low", "High"),
           risk.table=F,
           title="Time to Death or Transplant by Low vs High Soil in 6mo Pre-Sampling",
           xlab="Time from Diagnosis (years)",
           ylab="Survival Probability (Death or Lung Transplant)",
           ggtheme = theme_grey()
           ))
```


Base model with just Soil
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ Soil_6moPreSamp, data=dnam, id=ID)
summary(coxPH_model1)
```
**Significant assoc between increased Soil_6moPreSamp and increased mortality in this model.**

Base model with Soil and pct_5mC
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ Soil_6moPreSamp + pct_5mC, data=dnam, id=ID)
summary(coxPH_model1)
```
**Significant assoc between increased Soil_6moPreSamp and increased mortality in this model.**
**HR decerases when pct_5mC added to model indicating partial mediation.**

Partial Model with just Soil
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ Soil_6moPreSamp + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
**Significant assoc between increased Soil_6moPreSamp and increased mortality in this model.**

Partial Model with Soil and pct_5mC
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ Soil_6moPreSamp + pct_5mC + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
**Significant assoc between increased Soil_6moPreSamp and increased mortality in this model.**
*HR decreases slightly when pct_5mC added to model indicating some mediation.*

Complete Model with just Soil
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ Soil_6moPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
**Significant assoc between increased Soil_6moPreSamp and increased mortality in this model.**

Complete Model with Soil and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ Soil_6moPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
**Significant assoc between increased Soil_6moPreSamp and increased mortality in this model.**
HR actually increased after adding pct_5mC indicating it was not mediating in this model.

Complete Model + site with just Soil_6moPreSamp
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ Soil_6moPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
*Marginal assoc between increased Soil_6moPreSamp and increased mortality in this model.*


Complete Model + site with Soil_6moPreSamp and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ Soil_6moPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
*Marginal assoc between increased Soil_6moPreSamp and increased mortality in this model,* but HR increases slightly with addition of pct_5mC indicating no mediation



## 3mo Pre-Sampling
```{r, fig.height=5, fig.width=7}
surv1 <- survfit(Surv(time_DeathTxCensor, deadORtx==1) ~Soil3moSamp_dich, data=dnam)
(ggsurvplot(surv1, 
            censor=TRUE,
            pval=TRUE,
            xlim=c(0,5),
            legend="right",
           data=dnam,
           legend.title="Soil 3mo \nPre-Sampling",
           legend.labs=c("Low", "High"),
           risk.table=F,
           title="Time to Death or Transplant by Low vs High Soil in 3mo Pre-Sampling",
           xlab="Time from Diagnosis (years)",
           ylab="Survival Probability (Death or Lung Transplant)",
           ggtheme = theme_grey()
           ))
```


Base model with just Soil
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ Soil_3moPreSamp, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between Soil_3moPreSamp and mortality in this model.

Base model with Soil and pct_5mC
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ Soil_3moPreSamp + pct_5mC, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between Soil_3moPreSamp and mortality in this model.

Partial Model with just Soil
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ Soil_3moPreSamp + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between Soil_3moPreSamp and mortality in this model.

Partial Model with Soil and pct_5mC
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ Soil_3moPreSamp + pct_5mC + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between Soil_3moPreSamp and mortality in this model.

Complete Model with just Soil
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ Soil_3moPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
**Significant assoc between Soil_3moPreSamp and mortality in this model.**

Complete Model with Soil and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ Soil_3moPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
**Significant assoc between Soil_3moPreSamp and mortality in this model.**
No evidence of pct_5mC mediating.

Complete Model + site with just Soil_3moPreSamp
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ Soil_3moPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between Soil_3moPreSamp and mortality in this model.


Complete Model + site with Soil_3moPreSamp and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ Soil_3moPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between Soil_3moPreSamp and mortality in this model.


## 1mo Pre-Sampling
```{r, fig.height=5, fig.width=7}
surv1 <- survfit(Surv(time_DeathTxCensor, deadORtx==1) ~Soil1moSamp_dich, data=dnam)
(ggsurvplot(surv1, 
            censor=TRUE,
            pval=TRUE,
            xlim=c(0,5),
            legend="right",
           data=dnam,
           legend.title="Soil 1mo \nPre-Sampling",
           legend.labs=c("Low", "High"),
           risk.table=F,
           title="Time to Death or Transplant by Low vs High Soil in 1mo Pre-Sampling",
           xlab="Time from Diagnosis (years)",
           ylab="Survival Probability (Death or Lung Transplant)",
           ggtheme = theme_grey()
           ))
```

Base model with just Soil
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ Soil_1moPreSamp, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between Soil_1moPreSamp and mortality in this model.

Base model with Soil and pct_5mC
```{r}
coxPH_model1 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ Soil_1moPreSamp + pct_5mC, data=dnam, id=ID)
summary(coxPH_model1)
```
No significant assoc between Soil_1moPreSamp and mortality in this model.

Partial Model with just Soil
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ Soil_1moPreSamp + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between Soil_1moPreSamp and mortality in this model.

Partial Model with Soil and pct_5mC
```{r}
coxPH_model2 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ Soil_1moPreSamp + pct_5mC + age_dx + sex + smokeHx, data=dnam, id=ID)
summary(coxPH_model2)
```
No significant assoc between Soil_1moPreSamp and mortality in this model.

Complete Model with just Soil
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ Soil_1moPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between Soil_1moPreSamp and mortality in this model.

Complete Model with Soil and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ Soil_1moPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between Soil_1moPreSamp and mortality in this model.

Complete Model + site with just Soil
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ Soil_1moPreSamp + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between Soil_1moPreSamp and mortality in this model.


Complete Model + site with Soil and pct_5mC
```{r}
coxPH_model3 <- coxph(Surv(time_DeathTxCensor, deadORtx==1) ~ Soil_1moPreSamp + pct_5mC + age_dx + sex + smokeHx + dich_Race + fvc_pct + dlco_pct + site, data=dnam, id=ID)
summary(coxPH_model3)
```
No significant assoc between Soil_1moPreSamp and mortality in this model.



# Impact of DNAm on Baseline FVC
Base Model
```{r}
FVC_model1 <- lm(fvc_pct ~ pct_5mC, data=dnam)
summary(FVC_model1)
confint(FVC_model1)
```
No significant association between %5mC and baseline FVC.

Partial Model
```{r}
FVC_model2 <- lm(fvc_pct ~ pct_5mC + sex + age_dx, data=dnam)
summary(FVC_model2)
confint(FVC_model2)
```
No significant association between %5mC and baseline FVC.

Complete Model
```{r}
FVC_model3 <- lm(fvc_pct ~ pct_5mC + sex + age_dx + dich_Race + smokeHx, data=dnam)
summary(FVC_model3)
confint(FVC_model3)
```
No significant association between %5mC and baseline FVC.

Complete model with site
```{r}
FVC_model4 <- lm(fvc_pct ~ pct_5mC + sex + age_dx + dich_Race + smokeHx + site, data=dnam)
summary(FVC_model4)
confint(FVC_model4)
```
No significant association between %5mC and baseline FVC.


# Impact of DNAm on Baseline DLCO
Base Model
```{r}
DLCO_model1 <- lm(dlco_pct ~ pct_5mC, data=dnam)
summary(DLCO_model1)
confint(DLCO_model1)
```
No significant association between %5mC and baseline DLCO

Partial Model
```{r}
DLCO_model2 <- lm(dlco_pct ~ pct_5mC + sex + age_dx, data=dnam)
summary(DLCO_model2)
confint(DLCO_model2)
```
No significant association between %5mC and baseline DLCO

Complete Model
```{r}
DLCO_model3 <- lm(dlco_pct ~ pct_5mC + sex + age_dx + dich_Race + smokeHx, data=dnam)
summary(DLCO_model3)
confint(DLCO_model3)
```
No significant association between %5mC and baseline DLCO.


Complete model with site
```{r}
DLCO_model4 <- lm(dlco_pct ~ pct_5mC + sex + age_dx + dich_Race + smokeHx + site, data=dnam)
summary(DLCO_model4)
confint(DLCO_model4)
```
No significant association between %5mC and baseline DLCO.





